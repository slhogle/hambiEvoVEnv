<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shane Hogle">
<meta name="dcterms.date" content="2024-11-03">

<title>hambiYSKpleiotropy - Predator and STR Community species composition workflow iii) prediction of evolution environment from measurement environment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../R/strep_predator/communities/amplicon_sp_counts/01_format_rbec_tab.html">2A. Community composition workflow (Predator and STR)</a></li><li class="breadcrumb-item"><a href="../../../../R/strep_predator/communities/machine_learning_pipelines/01_machine_learn_home_env.html">iii) Machine learning the home environment</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../../">hambiYSKpleiotropy</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">1. Community densities workflow (STR)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/communities/cell_density/01_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Process and plot densities</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">2. Community composition workflow (STR)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/communities/amplicon_sp_counts/01_format_rbec_tab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Amplicon data wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/communities/amplicon_sp_counts/02_composition_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ii) Community composition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/communities/machine_learning_pipelines/01_machine_learn_home_env.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">iii) Machine learning the home environment</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">3. Clones workflow (STR)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/monocultures/clone_phenotyping/01_growth_curve_qc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Inspect/Smooth curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/monocultures/clone_phenotyping/02_growthrate_auc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ii) Summarize curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/monocultures/clone_phenotyping/03_growth_summary_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">iii) Analysis and plot</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">1A. Community densities workflow (Predator and STR)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_predator/communities/cell_density/01_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Process and plot densities</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">2A. Community composition workflow (Predator and STR)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_predator/communities/amplicon_sp_counts/01_format_rbec_tab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Amplicon data wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_predator/communities/amplicon_sp_counts/02_composition_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ii) Community composition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_predator/communities/machine_learning_pipelines/01_machine_learn_home_env.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">iii) Machine learning the home environment</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">3A. Clones workflow (Predator and STR)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_predator/monocultures/clone_phenotyping/01_growth_curve_qc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">i) Inspect/Smooth curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_predator/monocultures/clone_phenotyping/02_growthrate_auc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ii) Summarize curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_predator/monocultures/clone_phenotyping/03_growth_summary_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">iii) Analysis and plot</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup"><span class="header-section-number">1</span> Setup</a></li>
  <li><a href="#read" id="toc-read" class="nav-link" data-scroll-target="#read"><span class="header-section-number">2</span> Read</a></li>
  <li><a href="#data-formatting" id="toc-data-formatting" class="nav-link" data-scroll-target="#data-formatting"><span class="header-section-number">3</span> Data formatting</a></li>
  <li><a href="#data-normalization" id="toc-data-normalization" class="nav-link" data-scroll-target="#data-normalization"><span class="header-section-number">4</span> Data normalization</a></li>
  <li><a href="#machine-learning-the-home-environment" id="toc-machine-learning-the-home-environment" class="nav-link" data-scroll-target="#machine-learning-the-home-environment"><span class="header-section-number">5</span> Machine learning the home environment</a>
  <ul class="collapse">
  <li><a href="#classes-ancesteral-b-bp-bs-and-bps" id="toc-classes-ancesteral-b-bp-bs-and-bps" class="nav-link" data-scroll-target="#classes-ancesteral-b-bp-bs-and-bps"><span class="header-section-number">5.1</span> 5 classes (ancesteral, B, BP, BS, and BPS)</a>
  <ul class="collapse">
  <li><a href="#sec-split" id="toc-sec-split" class="nav-link" data-scroll-target="#sec-split"><span class="header-section-number">5.1.1</span> Spliting</a></li>
  <li><a href="#sec-recipe" id="toc-sec-recipe" class="nav-link" data-scroll-target="#sec-recipe"><span class="header-section-number">5.1.2</span> Recipe</a></li>
  <li><a href="#sec-specs" id="toc-sec-specs" class="nav-link" data-scroll-target="#sec-specs"><span class="header-section-number">5.1.3</span> Model specifications</a></li>
  <li><a href="#sec-wf" id="toc-sec-wf" class="nav-link" data-scroll-target="#sec-wf"><span class="header-section-number">5.1.4</span> Create workflow set</a></li>
  <li><a href="#sec-tune" id="toc-sec-tune" class="nav-link" data-scroll-target="#sec-tune"><span class="header-section-number">5.1.5</span> Tune</a></li>
  <li><a href="#best-tuning-parameters-and-best-performing-models" id="toc-best-tuning-parameters-and-best-performing-models" class="nav-link" data-scroll-target="#best-tuning-parameters-and-best-performing-models"><span class="header-section-number">5.1.6</span> Best tuning parameters and best performing models</a></li>
  </ul></li>
  <li><a href="#classes-ancestral-clones-vs-coevolved-history" id="toc-classes-ancestral-clones-vs-coevolved-history" class="nav-link" data-scroll-target="#classes-ancestral-clones-vs-coevolved-history"><span class="header-section-number">5.2</span> 2 classes (ancestral clones vs coevolved history)</a>
  <ul class="collapse">
  <li><a href="#spliting" id="toc-spliting" class="nav-link" data-scroll-target="#spliting"><span class="header-section-number">5.2.1</span> Spliting</a></li>
  <li><a href="#recipe" id="toc-recipe" class="nav-link" data-scroll-target="#recipe"><span class="header-section-number">5.2.2</span> Recipe</a></li>
  <li><a href="#model-specifications" id="toc-model-specifications" class="nav-link" data-scroll-target="#model-specifications"><span class="header-section-number">5.2.3</span> Model specifications</a></li>
  <li><a href="#create-workflow-set" id="toc-create-workflow-set" class="nav-link" data-scroll-target="#create-workflow-set"><span class="header-section-number">5.2.4</span> Create workflow set</a></li>
  <li><a href="#tune" id="toc-tune" class="nav-link" data-scroll-target="#tune"><span class="header-section-number">5.2.5</span> Tune</a></li>
  <li><a href="#best-tuning-parameters-and-best-performing-models-1" id="toc-best-tuning-parameters-and-best-performing-models-1" class="nav-link" data-scroll-target="#best-tuning-parameters-and-best-performing-models-1"><span class="header-section-number">5.2.6</span> Best tuning parameters and best performing models</a></li>
  </ul></li>
  <li><a href="#classes-streptomycin-history-vs-no-streptomycin-history" id="toc-classes-streptomycin-history-vs-no-streptomycin-history" class="nav-link" data-scroll-target="#classes-streptomycin-history-vs-no-streptomycin-history"><span class="header-section-number">5.3</span> 2 classes (streptomycin history vs no streptomycin history)</a>
  <ul class="collapse">
  <li><a href="#spliting-1" id="toc-spliting-1" class="nav-link" data-scroll-target="#spliting-1"><span class="header-section-number">5.3.1</span> Spliting</a></li>
  <li><a href="#recipe-1" id="toc-recipe-1" class="nav-link" data-scroll-target="#recipe-1"><span class="header-section-number">5.3.2</span> Recipe</a></li>
  <li><a href="#model-specifications-1" id="toc-model-specifications-1" class="nav-link" data-scroll-target="#model-specifications-1"><span class="header-section-number">5.3.3</span> Model specifications</a></li>
  <li><a href="#create-workflow-set-1" id="toc-create-workflow-set-1" class="nav-link" data-scroll-target="#create-workflow-set-1"><span class="header-section-number">5.3.4</span> Create workflow set</a></li>
  <li><a href="#tune-1" id="toc-tune-1" class="nav-link" data-scroll-target="#tune-1"><span class="header-section-number">5.3.5</span> Tune</a></li>
  <li><a href="#best-tuning-parameters-and-best-performing-models-2" id="toc-best-tuning-parameters-and-best-performing-models-2" class="nav-link" data-scroll-target="#best-tuning-parameters-and-best-performing-models-2"><span class="header-section-number">5.3.6</span> Best tuning parameters and best performing models</a></li>
  </ul></li>
  <li><a href="#classes-predation-history-vs-no-predation-history" id="toc-classes-predation-history-vs-no-predation-history" class="nav-link" data-scroll-target="#classes-predation-history-vs-no-predation-history"><span class="header-section-number">5.4</span> 2 classes (predation history vs no predation history)</a>
  <ul class="collapse">
  <li><a href="#spliting-2" id="toc-spliting-2" class="nav-link" data-scroll-target="#spliting-2"><span class="header-section-number">5.4.1</span> Spliting</a></li>
  <li><a href="#recipe-2" id="toc-recipe-2" class="nav-link" data-scroll-target="#recipe-2"><span class="header-section-number">5.4.2</span> Recipe</a></li>
  <li><a href="#model-specifications-2" id="toc-model-specifications-2" class="nav-link" data-scroll-target="#model-specifications-2"><span class="header-section-number">5.4.3</span> Model specifications</a></li>
  <li><a href="#create-workflow-set-2" id="toc-create-workflow-set-2" class="nav-link" data-scroll-target="#create-workflow-set-2"><span class="header-section-number">5.4.4</span> Create workflow set</a></li>
  <li><a href="#tune-2" id="toc-tune-2" class="nav-link" data-scroll-target="#tune-2"><span class="header-section-number">5.4.5</span> Tune</a></li>
  <li><a href="#best-tuning-parameters-and-best-performing-models-3" id="toc-best-tuning-parameters-and-best-performing-models-3" class="nav-link" data-scroll-target="#best-tuning-parameters-and-best-performing-models-3"><span class="header-section-number">5.4.6</span> Best tuning parameters and best performing models</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../R/strep_predator/communities/amplicon_sp_counts/01_format_rbec_tab.html">2A. Community composition workflow (Predator and STR)</a></li><li class="breadcrumb-item"><a href="../../../../R/strep_predator/communities/machine_learning_pipelines/01_machine_learn_home_env.html">iii) Machine learning the home environment</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Predator and STR Community species composition workflow iii) prediction of evolution environment from measurement environment</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shane Hogle </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 3, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setup</h1>
<p>Loads required libraries and sets global variables</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(fs)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils_generic.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="read" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Read</h1>
<p>Read and format 16S amplicon data</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>sptable <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_sp, <span class="st">"species_counts_md.tsv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">transfer =</span> day<span class="sc">/</span><span class="dv">7</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a>counts_f <span class="ot">&lt;-</span> sptable <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">f=</span>count_correct<span class="sc">/</span><span class="fu">sum</span>(count_correct)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-8"><a href="#cb2-8"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">measure_env_short =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(measure_env <span class="sc">==</span> <span class="st">"bact"</span> <span class="sc">~</span> <span class="st">"Meas: B"</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>                                       measure_env <span class="sc">==</span> <span class="st">"bact_pred"</span> <span class="sc">~</span> <span class="st">"Meas: BP"</span>,</span>
<span id="cb2-10"><a href="#cb2-10"></a>                                       measure_env <span class="sc">==</span> <span class="st">"bact_strep"</span> <span class="sc">~</span> <span class="st">"Meas: BS"</span>,</span>
<span id="cb2-11"><a href="#cb2-11"></a>                                       measure_env <span class="sc">==</span> <span class="st">"bact_pred_strep"</span> <span class="sc">~</span> <span class="st">"Meas: BPS"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">home_env_short =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(evolution_env <span class="sc">==</span> <span class="st">"anc"</span> <span class="sc">~</span> <span class="st">"Home: Anc"</span>,</span>
<span id="cb2-13"><a href="#cb2-13"></a>                                    evolution_env <span class="sc">==</span> <span class="st">"bact"</span> <span class="sc">~</span> <span class="st">"Home: B"</span>,</span>
<span id="cb2-14"><a href="#cb2-14"></a>                                    evolution_env <span class="sc">==</span> <span class="st">"bact_pred"</span> <span class="sc">~</span> <span class="st">"Home: BP"</span>,</span>
<span id="cb2-15"><a href="#cb2-15"></a>                                    evolution_env <span class="sc">==</span> <span class="st">"bact_strep"</span> <span class="sc">~</span> <span class="st">"Home: BS"</span>,</span>
<span id="cb2-16"><a href="#cb2-16"></a>                                    evolution_env <span class="sc">==</span> <span class="st">"bact_pred_strep"</span> <span class="sc">~</span> <span class="st">"Home: BPS"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-17"><a href="#cb2-17"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">measure_env_short =</span> <span class="fu">factor</span>(measure_env_short, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Meas: B"</span>, <span class="st">"Meas: BP"</span>, <span class="st">"Meas: BS"</span>, <span class="st">"Meas: BPS"</span>)),</span>
<span id="cb2-18"><a href="#cb2-18"></a>         <span class="at">home_env_short =</span> <span class="fu">factor</span>(home_env_short, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Home: Anc"</span>, <span class="st">"Home: B"</span>, <span class="st">"Home: BP"</span>, <span class="st">"Home: BS"</span>, <span class="st">"Home: BPS"</span>)),</span>
<span id="cb2-19"><a href="#cb2-19"></a>         <span class="at">day =</span> <span class="fu">factor</span>(day),</span>
<span id="cb2-20"><a href="#cb2-20"></a>         <span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb2-21"><a href="#cb2-21"></a>         <span class="at">strainID =</span> <span class="fu">factor</span>(strainID, <span class="at">levels =</span> <span class="fu">names</span>(hambi_colors)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Read population density data</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>celldens <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"density4ML.tsv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-formatting" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data formatting</h1>
<p>Separate the samples to only include those from the experiment. These are the samples that will be used in the machine learning pipeline</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># these are communities of a (supposedly) known composition. Can be used with metacal</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>pos_ctrl_samples <span class="ot">&lt;-</span> counts_f <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(sample, <span class="st">"pos_ctrl"</span>))</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># these are samples taken directly from YSK and represent the composition of the communities used to start the experiment</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>t0_samples <span class="ot">&lt;-</span> counts_f <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(sample, <span class="st">"pos_ctrl"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(day <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># only samples from the experiment</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>counts_f_experiment <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(counts_f, pos_ctrl_samples, </span>
<span id="cb4-12"><a href="#cb4-12"></a>                                 <span class="at">by =</span> <span class="fu">join_by</span>(sample, strainID, genus, species, count, count_correct, replicate, </span>
<span id="cb4-13"><a href="#cb4-13"></a>                                              day, measure_env, evolution_env, transfer, f, </span>
<span id="cb4-14"><a href="#cb4-14"></a>                                              measure_env_short, home_env_short)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-15"><a href="#cb4-15"></a>  dplyr<span class="sc">::</span><span class="fu">anti_join</span>(., t0_samples,</span>
<span id="cb4-16"><a href="#cb4-16"></a>                   <span class="at">by =</span> <span class="fu">join_by</span>(sample, strainID, genus, species, count, count_correct, replicate, </span>
<span id="cb4-17"><a href="#cb4-17"></a>                                              day, measure_env, evolution_env, transfer, f, </span>
<span id="cb4-18"><a href="#cb4-18"></a>                                              measure_env_short, home_env_short)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-19"><a href="#cb4-19"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">measure_env_short =</span> <span class="fu">factor</span>(measure_env_short, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Meas: B"</span>, <span class="st">"Meas: BP"</span>, <span class="st">"Meas: BS"</span>, <span class="st">"Meas: BPS"</span>)),</span>
<span id="cb4-20"><a href="#cb4-20"></a>         <span class="at">home_env_short =</span> <span class="fu">factor</span>(home_env_short, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Home: Anc"</span>, <span class="st">"Home: B"</span>, <span class="st">"Home: BP"</span>, <span class="st">"Home: BS"</span>, <span class="st">"Home: BPS"</span>)),</span>
<span id="cb4-21"><a href="#cb4-21"></a>         <span class="at">day =</span> <span class="fu">factor</span>(day),</span>
<span id="cb4-22"><a href="#cb4-22"></a>         <span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb4-23"><a href="#cb4-23"></a>         <span class="at">strainID =</span> <span class="fu">factor</span>(strainID, <span class="at">levels =</span> <span class="fu">names</span>(hambi_colors)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-normalization" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Data normalization</h1>
<p>Here we’ll use the same filtering criteria as in <a href="../../../../R/strep_predator/communities/amplicon_sp_counts/02_composition_analysis.html">the t-SNE analysis from section 3 of the last analysis.</a></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>counts_f_experiment <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">n_samples =</span> <span class="fu">n</span>(),</span>
<span id="cb5-4"><a href="#cb5-4"></a>            <span class="at">n_gt0 =</span> <span class="fu">sum</span>(count <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb5-5"><a href="#cb5-5"></a>            <span class="at">p_gt0 =</span> n_gt0 <span class="sc">/</span> n_samples) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(n_gt0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["strainID"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n_samples"],"name":[2],"type":["int"],"align":["right"]},{"label":["n_gt0"],"name":[3],"type":["int"],"align":["right"]},{"label":["p_gt0"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"HAMBI_2792","2":"355","3":"3","4":"0.008450704"},{"1":"HAMBI_0262","2":"355","3":"11","4":"0.030985915"},{"1":"HAMBI_0097","2":"355","3":"13","4":"0.036619718"},{"1":"HAMBI_1988","2":"355","3":"18","4":"0.050704225"},{"1":"HAMBI_1299","2":"355","3":"96","4":"0.270422535"},{"1":"HAMBI_1279","2":"355","3":"100","4":"0.281690141"},{"1":"HAMBI_3237","2":"355","3":"121","4":"0.340845070"},{"1":"HAMBI_2159","2":"355","3":"151","4":"0.425352113"},{"1":"HAMBI_2443","2":"355","3":"282","4":"0.794366197"},{"1":"HAMBI_2494","2":"355","3":"305","4":"0.859154930"},{"1":"HAMBI_2164","2":"355","3":"312","4":"0.878873239"},{"1":"HAMBI_0006","2":"355","3":"318","4":"0.895774648"},{"1":"HAMBI_1972","2":"355","3":"335","4":"0.943661972"},{"1":"HAMBI_1292","2":"355","3":"354","4":"0.997183099"},{"1":"HAMBI_3031","2":"355","3":"354","4":"0.997183099"},{"1":"HAMBI_2160","2":"355","3":"354","4":"0.997183099"},{"1":"HAMBI_1287","2":"355","3":"355","4":"1.000000000"},{"1":"HAMBI_1977","2":"355","3":"355","4":"1.000000000"},{"1":"HAMBI_0403","2":"355","3":"355","4":"1.000000000"},{"1":"HAMBI_2659","2":"355","3":"355","4":"1.000000000"},{"1":"HAMBI_1896","2":"355","3":"355","4":"1.000000000"},{"1":"HAMBI_0105","2":"355","3":"355","4":"1.000000000"},{"1":"HAMBI_1842","2":"355","3":"355","4":"1.000000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Briefly, we will use the <a href="https://en.wikipedia.org/wiki/Compositional_data#Center_log_ratio_transform">centered log-ratio transformation</a> for the species abundances. The centered log-ratio can be interpreted as the log-fold change of species i relative to the average microbe in a sample. The formula for the transformation is:</p>
<p><span class="math display">\[
\text{clr}(\mathbf x)= \left(log
\frac{x_i}{g(\mathbf x)} \right)_{i=1,...,D} \qquad \text{with} \quad
g(\mathbf x) = \left(\prod_{i=1}^Dx_i\right)^{1/D} =
\exp\left(\frac{1}{D}\sum_{i=1}^D \log x_i\right)\text{,}
\]</span></p>
<p>We will use the implementation of centered log-ratio transform in the <code>compositions</code> package</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">set.seed</span>(<span class="dv">12353</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>lowstrainsv <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="st">"HAMBI_0097"</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="st">"HAMBI_2792"</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a>mymat <span class="ot">&lt;-</span> counts_f_experiment <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>(strainID <span class="sc">%in%</span> lowstrainsv)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, strainID, count) <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">count =</span> count <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="co"># important to arrange by sample as this makes some later joins easier</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"strainID"</span>, <span class="at">values_from =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-15"><a href="#cb6-15"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">"sample"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb6-17"><a href="#cb6-17"></a></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co"># calculate clr transform</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>balclr <span class="ot">&lt;-</span> compositions<span class="sc">::</span><span class="fu">clr</span>(mymat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="machine-learning-the-home-environment" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Machine learning the home environment</h1>
<p>The goal is to see if we can reliably predict which home environment a community came from (either ancestral clonal, or co-evolved in YSK) using only the species abundances, knowledge of the experiment structure (e.g., replicate and experimental transfer), and the measurement environment. The motivation behind this is that if we can learn the evolutionary home environment there must be some kind of “ecological signal” embedded in the community data that is a function of the evolutionary home environment. We are using machine learning approaches because they are flexible, powerful, and we are most interested in prediction. We care less about which features/variables are driving the signal…</p>
<p>Load the <code>tidymodels</code> ecosystem. We are using <a href="https://www.tidymodels.org/"><code>tidymodels</code></a> because it allows us to work with familiar <code>tidyverse</code> syntax while making sure we adhere to best practices in training and assessing the performance of machine learning models.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">library</span>(discrim)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">library</span>(themis)</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="fu">tidymodels_prefer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>First doing some basic data preparations. We will create some additional classification structures that we will investigate further below</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>balclr_md <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(balclr) <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"sample"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">distinct</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(counts_f_experiment, sample, replicate, </span>
<span id="cb8-4"><a href="#cb8-4"></a>                                          transfer, measure_env, evolution_env)), <span class="at">by =</span> <span class="fu">join_by</span>(sample)) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(celldens, <span class="at">by =</span> <span class="fu">join_by</span>(replicate, transfer, measure_env, evolution_env)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="co">#dplyr::filter(measure_env != evolution_env) %&gt;% </span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb8-8"><a href="#cb8-8"></a>         <span class="at">transfer =</span> <span class="fu">factor</span>(transfer),</span>
<span id="cb8-9"><a href="#cb8-9"></a>         <span class="at">measure_env =</span> <span class="fu">factor</span>(measure_env),</span>
<span id="cb8-10"><a href="#cb8-10"></a>         <span class="co">#home_env_5c = factor(if_else(evolution_env == "anc", NA_character_, evolution_env)),</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>         <span class="at">home_env_5c =</span> <span class="fu">factor</span>(evolution_env),</span>
<span id="cb8-12"><a href="#cb8-12"></a>         <span class="at">home_env_ae =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(evolution_env <span class="sc">==</span> <span class="st">"anc"</span>, <span class="st">"anc"</span>, <span class="st">"evo"</span>)),</span>
<span id="cb8-13"><a href="#cb8-13"></a>         <span class="at">home_env_sns =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(evolution_env <span class="sc">==</span> <span class="st">"bact_strep"</span> <span class="sc">|</span> evolution_env <span class="sc">==</span> <span class="st">"bact_pred_strep"</span> <span class="sc">~</span> <span class="st">"strep"</span>, </span>
<span id="cb8-14"><a href="#cb8-14"></a>                                         evolution_env <span class="sc">==</span> <span class="st">"anc"</span> <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb8-15"><a href="#cb8-15"></a>                                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"nostrep"</span>)),</span>
<span id="cb8-16"><a href="#cb8-16"></a>         <span class="at">home_env_pnp =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(evolution_env <span class="sc">==</span> <span class="st">"bact_pred"</span> <span class="sc">|</span> evolution_env <span class="sc">==</span> <span class="st">"bact_pred_strep"</span> <span class="sc">~</span> <span class="st">"pred"</span>, </span>
<span id="cb8-17"><a href="#cb8-17"></a>                                         evolution_env <span class="sc">==</span> <span class="st">"anc"</span> <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb8-18"><a href="#cb8-18"></a>                                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"nopred"</span>))) <span class="sc">%&gt;%</span>  </span>
<span id="cb8-19"><a href="#cb8-19"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>sample, <span class="sc">-</span>evolution_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="classes-ancesteral-b-bp-bs-and-bps" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="classes-ancesteral-b-bp-bs-and-bps"><span class="header-section-number">5.1</span> 5 classes (ancesteral, B, BP, BS, and BPS)</h2>
<p>First were going to try and predict all 5 different home evolution environments</p>
<section id="sec-split" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="sec-split"><span class="header-section-number">5.1.1</span> Spliting</h3>
<p>Split the data using the default 3:1 ratio of training-to-test. Here we also set the strata argument. This argument makes sure that both sides of the split have roughly the same distribution for each value of strata. If a numeric variable is passed to strata then it is binned and distributions are matched within bins. In this case there will be roughly the same distribution of the 5 classes within each side of the test/train split.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>balclr_5c <span class="ot">&lt;-</span> balclr_md <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>home_env_ae, <span class="sc">-</span>home_env_sns, <span class="sc">-</span>home_env_pnp) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">table</span>(balclr_5c<span class="sc">$</span>home_env_5c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
            anc            bact       bact_pred bact_pred_strep      bact_strep 
             72              70              71              70              72 </code></pre>
</div>
</div>
<p>The data is balanced</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">set.seed</span>(<span class="dv">1501</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>balclr_5c_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(balclr_5c, <span class="at">strata =</span> home_env_5c)</span>
<span id="cb11-3"><a href="#cb11-3"></a>balclr_5c_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(balclr_5c_split)</span>
<span id="cb11-4"><a href="#cb11-4"></a>balclr_5c_test  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(balclr_5c_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Resample the training set using five repeats of 10-fold cross-validation</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">set.seed</span>(<span class="dv">1502</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>balclr_5c_folds <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(balclr_5c_train, <span class="at">strata =</span> home_env_5c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sec-recipe" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="sec-recipe"><span class="header-section-number">5.1.2</span> Recipe</h3>
<p>First we need to preprocess the data so that it is in optimal format for Ml. Some useful steps include:</p>
<ul>
<li><code>step_novel():</code> converts all nominal variables to factors and takes care of other issues related to categorical variables.</li>
<li><code>step_normalize():</code> normalizes (center and scales) the numeric variables to have a standard deviation of one and a mean of zero. (i.e., z-standardization).</li>
<li><code>step_dummy():</code> converts our factor column ocean_proximity into numeric binary (0 and 1) variables.
<ul>
<li>Note that this step may cause problems if your categorical variable has too many levels - especially if some of the levels are very infrequent. In this case you should either drop the variable or pool infrequently occurring values into an “other” category with step_other. This steps has to be performed before step_dummy.</li>
</ul></li>
<li><code>step_zv():</code> removes any numeric variables that have zero variance.</li>
<li><code>step_corr():</code> will remove predictor variables that have large correlations with other predictor variables.</li>
</ul>
<p><strong>Edit: data is already in centered log-ratio transform and further normalization doesn’t really help.</strong></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>balclr_5c_rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(home_env_5c <span class="sc">~</span> ., <span class="at">data =</span> balclr_5c_train) <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="co">#step_novel(all_nominal(), -all_outcomes()) %&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(od600, ciliate_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(od600, ciliate_per_ml)<span class="co"># %&gt;% </span></span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="co">#step_corr(all_predictors(), threshold = 0.7, method = "spearman")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>You can take a peek at the what the preprocessing recipe does using <code>prep</code> and <code>bake</code></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>balclr_5c_rec <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="co"># perform the recipe on training data</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  recipes<span class="sc">::</span><span class="fu">prep</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="co"># extract only the preprocessed dataframe </span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["HAMBI_0006"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["HAMBI_0105"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["HAMBI_0262"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["HAMBI_0403"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["HAMBI_1279"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["HAMBI_1287"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["HAMBI_1292"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["HAMBI_1299"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["HAMBI_1842"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["HAMBI_1896"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["HAMBI_1972"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["HAMBI_1977"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["HAMBI_1988"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["HAMBI_2159"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["HAMBI_2160"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["HAMBI_2164"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["HAMBI_2443"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["HAMBI_2494"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["HAMBI_2659"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["HAMBI_3031"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["HAMBI_3237"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["od600"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["ciliate_per_ml"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["home_env_5c"],"name":[24],"type":["fct"],"align":["left"]},{"label":["replicate_B"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["replicate_C"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["replicate_D"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["replicate_E"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["replicate_F"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["transfer_X8"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["transfer_X12"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["measure_env_bact_pred"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["measure_env_bact_pred_strep"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["measure_env_bact_strep"],"name":[34],"type":["dbl"],"align":["right"]}],"data":[{"1":"4.39862208","2":"2.1276058","3":"-3.397847","4":"0.098660398","5":"-3.3978472","6":"3.171634257","7":"-0.564633820","8":"-3.3978472","9":"0.591136883","10":"4.381201","11":"5.955033895","12":"3.346212023","13":"-3.397847","14":"-1.3184056","15":"0.6094860215","16":"-1.788409251","17":"-0.507475406","18":"-2.299234875","19":"-1.4519370","20":"0.239738996","21":"-3.39784716","22":"0.64357404","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.33349853","2":"1.8042839","3":"-3.725145","4":"-0.547091350","5":"-3.7251452","6":"2.789567511","7":"-0.011573113","8":"-3.7251452","9":"1.111136727","10":"4.367094","11":"5.748405252","12":"2.436062142","13":"-3.725145","14":"-3.0319980","15":"1.3052927413","16":"-1.327249907","17":"-0.392940670","18":"-1.327249907","19":"-1.1601958","20":"0.226098538","21":"-1.42256009","22":"0.08297357","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.08960482","2":"1.9983288","3":"-3.611143","4":"0.150057145","5":"-2.9179958","6":"3.018220283","7":"-0.114635409","8":"-3.6111430","9":"0.888666700","10":"4.292084","11":"5.797638340","12":"3.335833022","13":"-3.611143","14":"-1.5317014","15":"0.6515369068","16":"-1.819383501","17":"-0.055794909","18":"-2.512530682","19":"-1.1262363","20":"0.300880035","21":"-3.61114297","22":"0.64357404","23":"-0.618508245","24":"anc","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.43577738","2":"1.9380910","3":"-3.801702","4":"-0.666207689","5":"-3.8017019","6":"2.896566150","7":"0.130123728","8":"-3.8017019","9":"1.139940518","10":"4.069609","11":"5.710519259","12":"2.428779543","13":"-3.801702","14":"-2.4154075","15":"0.9078282967","16":"-1.604477327","17":"-0.666207689","18":"-1.604477327","19":"-0.9113301","20":"-0.112822450","21":"-0.46949739","22":"0.02068463","23":"-0.618508245","24":"anc","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.26182855","2":"2.1222989","3":"-3.673759","4":"0.132903652","5":"-2.5751465","6":"2.784579446","7":"-0.118410776","8":"-2.5751465","9":"0.682949989","10":"4.354370","11":"6.017586922","12":"3.569039085","13":"-3.673759","14":"-1.4765343","15":"0.9009521408","16":"-1.727848689","17":"-0.341554328","18":"-3.673758838","19":"-1.1088095","20":"-0.208022935","21":"-3.67375884","22":"0.23869592","23":"-0.618508245","24":"anc","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.40314334","2":"2.1352288","3":"-3.614164","4":"-0.523121718","5":"-3.6141642","6":"2.651137041","7":"0.235983430","8":"-3.6141642","9":"0.703323942","10":"4.355539","11":"5.920069655","12":"2.514886039","13":"-3.614164","14":"-2.2278698","15":"1.1649593217","16":"-2.004726259","17":"-0.723792414","18":"-1.668254022","19":"-1.6682540","20":"-0.030645233","21":"-0.78095083","22":"-0.16618219","23":"-0.618508245","24":"anc","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"3.96672287","2":"2.1224318","3":"-3.715299","4":"0.504209069","5":"-2.3290043","6":"3.344318992","7":"-0.419461771","8":"-2.3290043","9":"0.292034549","10":"4.330290","11":"5.949931727","12":"3.258244383","13":"-3.022151","14":"-3.0221515","15":"0.6414101900","16":"-2.105860724","17":"-0.218791075","18":"-2.616686348","19":"-0.4194618","20":"-0.496422812","21":"-3.71529864","22":"0.48785169","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.57437344","2":"2.1382115","3":"-3.478560","4":"0.076788470","5":"-3.4785596","6":"2.845799371","7":"0.017947970","8":"-3.4785596","9":"1.156169396","10":"4.440069","11":"5.918177356","12":"2.556921841","13":"-3.478560","14":"-2.3799473","15":"1.2836143429","16":"-1.532649443","17":"-0.588187834","18":"-1.686800123","19":"-1.5326494","20":"0.104959347","21":"-3.47855959","22":"-0.07274878","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.24928123","2":"1.9597218","3":"-3.581542","4":"-0.085034201","5":"-1.9721038","6":"2.315612105","7":"0.107337692","8":"-1.6356316","9":"1.701661966","10":"3.985804","11":"5.391429351","12":"1.860875948","13":"-3.581542","14":"-3.5815418","15":"0.2470996342","16":"-1.635631613","17":"-0.585809489","18":"-2.888394582","19":"-0.4460475","20":"-0.323445224","21":"-1.50210022","22":"0.36327380","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.40459593","2":"2.1953664","3":"-3.579185","4":"0.547949242","5":"-2.4805729","6":"3.253846590","7":"0.481257868","8":"-3.5791851","9":"0.134386924","10":"4.409018","11":"5.982093751","12":"2.941435985","13":"-2.886038","14":"-2.8860380","15":"0.8152640118","16":"-2.480572854","17":"-0.634746164","18":"-2.192890782","19":"-1.3819606","20":"-0.177987761","21":"-2.88603796","22":"0.64357404","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.55159927","2":"1.9996548","3":"-3.545523","4":"-0.144325278","5":"-3.5455227","6":"2.859705798","7":"0.215677456","8":"-3.5455227","9":"0.597612067","10":"4.185530","11":"5.790568918","12":"1.888199344","13":"-3.545523","14":"-1.9360847","15":"0.9431137100","16":"-1.466081118","17":"-0.772933938","18":"-1.753763191","19":"0.8489265","20":"-0.079786757","21":"-3.54552266","22":"-0.07274878","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.35238360","2":"1.7576760","3":"-3.494597","4":"-0.316543556","5":"-2.3959851","6":"2.100113993","7":"-0.060610182","8":"-2.3959851","9":"1.454162504","10":"3.736690","11":"5.363629053","12":"1.258992805","13":"-3.494597","14":"-2.3959851","15":"0.2189746801","16":"-1.702837917","17":"-0.786547185","18":"-2.395985098","19":"0.7395091","20":"-0.127301557","21":"-1.41515584","22":"0.48785169","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.40115264","2":"1.9438676","3":"-3.616814","4":"-0.182826861","5":"-2.9236669","6":"2.972112412","7":"0.233333536","8":"-2.9236669","9":"1.489131409","10":"3.986086","11":"5.778261615","12":"2.220916382","13":"-3.616814","14":"-2.9236669","15":"0.7776350894","16":"-1.537372524","17":"-0.358717527","18":"-2.007376153","19":"-0.2846096","20":"0.189848425","21":"-3.61681407","22":"-0.16618219","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.39296096","2":"2.0250028","3":"-3.543342","4":"1.120097361","5":"-3.5433417","6":"2.415082960","7":"-0.324465908","8":"-3.5433417","9":"1.467293561","10":"4.086634","11":"5.549115599","12":"1.580622247","13":"-3.543342","14":"-2.1570474","15":"0.0401772058","16":"-1.751582263","17":"-0.365287902","18":"-1.933903820","19":"0.5510028","20":"-0.077605830","21":"-2.44472944","22":"0.08297357","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.21915741","2":"1.1692838","3":"-4.192008","4":"2.705696565","5":"-4.1920084","6":"3.303533566","7":"0.984141355","8":"-4.1920084","9":"0.423112139","10":"2.231239","11":"5.162345754","12":"-0.148957110","13":"-4.192008","14":"-3.0933961","15":"0.8449442245","16":"-0.859803868","17":"-0.973132553","18":"-0.300188080","19":"2.3547770","20":"-1.013954548","21":"-0.24076466","22":"-0.29076008","23":"0.446496640","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.26420631","2":"1.1390692","3":"-3.042981","4":"1.599003189","5":"-1.3847529","6":"1.865990670","7":"0.103324162","8":"-1.7212251","9":"-0.368832321","10":"2.547073","11":"4.958960148","12":"-1.061979501","13":"-2.637516","14":"-1.8643260","15":"0.1140194508","16":"-2.126690238","17":"-1.028077950","18":"-1.721225130","19":"2.3972699","20":"-0.791689172","21":"-0.23962059","22":"-1.31852760","23":"-0.136712626","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.19885810","2":"1.0608683","3":"-4.098187","4":"4.192858083","5":"-2.3064276","6":"5.038291475","7":"1.299975653","8":"-2.3064276","9":"0.076200222","10":"1.900750","11":"2.823471136","12":"0.885419573","13":"-4.098187","14":"-2.7118927","15":"0.8785466942","16":"-1.533237691","17":"-0.730891218","18":"-1.613280398","19":"2.9370816","20":"-1.795601955","21":"-4.09818705","22":"-0.16618219","23":"1.055043159","24":"anc","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.30112496","2":"1.3043063","3":"-2.929800","4":"2.343199372","5":"-3.6229474","6":"1.700062612","7":"0.930929525","8":"-3.6229474","9":"0.040614279","10":"1.624077","11":"6.022999270","12":"0.248253644","13":"-3.622947","14":"-3.6229474","15":"0.5201873593","16":"-1.320362274","17":"-0.678508388","18":"-1.225052094","19":"2.9050106","20":"-1.138040717","21":"-0.15721146","22":"0.33212933","23":"0.243604710","24":"anc","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.84833495","2":"1.3706286","3":"-3.646651","4":"2.395981549","5":"-2.0372134","6":"2.609098757","7":"0.830685530","8":"-2.0372134","9":"-0.350814418","10":"2.137174","11":"5.257978813","12":"-0.555608831","13":"-3.646651","14":"-3.6466513","15":"0.3045924342","16":"-1.449426707","17":"-0.938601083","18":"-1.700741135","19":"3.2108628","20":"-0.874062562","21":"-1.08170193","22":"-0.60220478","23":"-0.111375373","24":"anc","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.09840650","2":"1.1279920","3":"-3.908961","4":"4.018724479","5":"-2.5226662","6":"4.866588868","7":"1.196984907","8":"-2.8103483","9":"0.168576877","10":"2.447147","11":"2.738727807","12":"0.878531176","13":"-3.908961","14":"-2.5226662","15":"0.6657504116","16":"-1.424053917","17":"-0.773466351","18":"-1.711735990","19":"2.7084424","20":"-1.424053917","21":"-3.90896057","22":"0.14526251","23":"0.547910288","24":"anc","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.15058829","2":"1.5264501","3":"-3.978881","4":"2.673981558","5":"-3.9788815","6":"3.072107975","7":"0.351851868","8":"-3.9788815","9":"0.046470219","10":"2.753329","11":"5.274230992","12":"0.325183621","13":"-3.978881","14":"-3.9788815","15":"1.0773643335","16":"-1.088509714","17":"-0.887839018","18":"-0.482373910","19":"2.1436113","20":"-0.646676962","21":"-0.39536253","22":"-0.10389325","23":"-0.086038120","24":"anc","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.77220025","2":"1.8785142","3":"-4.515077","4":"2.931508590","5":"-1.8070263","6":"2.142934537","7":"-0.280970004","8":"-2.4356350","9":"-0.108357262","10":"2.556497","11":"4.861794734","12":"-0.753876393","13":"-4.515077","14":"-2.5691664","15":"0.3447358954","16":"-1.219239643","17":"-0.404202645","18":"-2.117181236","19":"3.0625573","20":"-0.404202645","21":"-0.42073195","22":"-0.50877137","23":"-0.162114515","24":"anc","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.65023651","2":"1.5966265","3":"-3.666064","4":"3.129642039","5":"-1.8743043","6":"4.737512729","7":"0.461070649","8":"-1.8743043","9":"-0.002502090","10":"3.685094","11":"3.835018388","12":"1.006765099","13":"-3.666064","14":"-3.6660637","15":"0.6777416860","16":"-2.567451447","17":"-0.721624757","18":"-3.666063736","19":"2.1658187","20":"-0.575021282","21":"-3.66606374","22":"0.17640698","23":"-0.517094598","24":"anc","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"3.82272530","2":"1.7541877","3":"-3.634884","4":"2.331262745","5":"-3.6348840","6":"3.685642968","7":"0.149305640","8":"-3.6348840","9":"-0.138376433","10":"2.755357","11":"5.807440734","12":"0.078688073","13":"-3.634884","14":"-3.6348840","15":"0.7089214277","16":"-1.555442452","17":"0.002702166","18":"-0.862295272","19":"2.3714692","20":"-0.200896790","21":"-2.53627171","22":"0.02068463","23":"0.040777416","24":"anc","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"4.07839388","2":"1.2003870","3":"-4.179510","4":"3.776616033","5":"-1.6145610","6":"4.652055561","7":"1.035425440","8":"-1.3462970","9":"0.202516317","10":"2.132224","11":"2.083887945","12":"0.286397801","13":"-4.179510","14":"-2.7932160","15":"0.6880241326","16":"-1.540452988","17":"-0.395320684","18":"-1.614560960","19":"2.6284246","20":"-1.614560960","21":"-3.48636314","22":"1.48447474","23":"0.700063076","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"3.92592541","2":"1.6962608","3":"-3.809071","4":"2.471325058","5":"-3.8090708","6":"3.819446846","7":"0.585378374","8":"-3.8090708","9":"0.467595338","10":"2.435096","11":"5.539203777","12":"-0.024881147","13":"-3.809071","14":"-3.8090708","15":"0.9700527121","16":"-0.864631802","17":"-0.718028328","18":"-0.282710256","19":"2.3667965","20":"-1.324164131","21":"-2.01731131","22":"-1.25623866","23":"0.345018357","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.78547562","2":"1.6136525","3":"-3.786770","4":"2.739724734","5":"-1.9149679","6":"2.322477457","7":"-0.049100508","8":"-1.8408600","9":"0.030942200","10":"2.513098","11":"4.709607926","12":"-0.924569245","13":"-2.870479","14":"-3.0936229","15":"-0.0731980592","16":"-1.646703962","17":"-0.953556782","18":"-1.707328584","19":"2.8028439","20":"-0.673254817","21":"-0.98340975","22":"-0.75792713","23":"-0.162114515","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.01892602","2":"1.1372566","3":"-3.554091","4":"3.559050874","5":"-1.2515061","6":"5.235873416","7":"0.840357920","8":"-1.1561960","9":"-0.609652256","10":"1.979298","11":"3.239374898","12":"0.337729063","13":"-3.554091","14":"-2.4554789","15":"0.5890434915","16":"-1.762331766","17":"-0.846041034","18":"-2.860944054","19":"2.4298450","20":"-1.762331766","21":"-3.55409123","22":"5.31524461","23":"3.463891983","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"3.78682839","2":"1.4594393","3":"-3.929632","4":"0.559003960","5":"-3.9296324","6":"3.916566405","7":"0.849491083","8":"-3.9296324","9":"0.665487440","10":"3.433013","11":"4.917152257","12":"1.263324441","13":"-3.929632","14":"-3.9296324","15":"0.9756423683","16":"-0.933900137","17":"0.059351636","18":"0.002193223","19":"2.2231003","20":"0.401100930","21":"-3.92963241","22":"-1.75455019","23":"0.623986682","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.89357652","2":"1.6825586","3":"-2.961832","4":"1.139156827","5":"-1.8632200","6":"2.212055010","7":"-0.116922894","8":"-2.2686851","9":"-0.060410684","10":"2.054122","11":"4.939471027","12":"-1.105534287","13":"-3.184976","14":"-2.4918286","15":"0.2650117168","16":"-1.352394365","17":"-0.493732746","18":"-1.932212861","19":"2.8481104","20":"-0.582286144","21":"-0.62002647","22":"0.86158533","23":"-0.314202667","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"-1.93511109","2":"2.0492326","3":"-3.321405","4":"2.492725081","5":"-3.3214055","6":"6.263459606","7":"0.316180709","8":"-3.3214055","9":"1.457718042","10":"4.831081","11":"-0.613355250","12":"1.802558529","13":"-3.321405","14":"-3.3214055","15":"1.9464527083","16":"-0.756456093","17":"-0.325673177","18":"-1.375495302","19":"3.3353211","20":"0.439794665","21":"-3.32140545","22":"0.05182910","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.01628514","2":"1.5788347","3":"-3.016285","4":"3.038154207","5":"-3.0162851","6":"6.232506420","7":"0.119209077","8":"-3.0162851","9":"2.915960049","10":"4.137549","11":"-1.629990778","12":"4.099296987","13":"-3.016285","14":"-3.0162851","15":"1.0612523051","16":"-0.531378489","17":"0.767904495","18":"-3.016285139","19":"1.0945887","20":"1.246394738","21":"-3.01628514","22":"-0.04160431","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.59899523","2":"1.8081765","3":"-2.500383","4":"2.557983759","5":"-3.5989952","6":"5.909002301","7":"0.272205785","8":"-3.5989952","9":"3.559518771","10":"4.165301","11":"-1.034045869","12":"4.684498900","13":"-3.598995","14":"-3.5989952","15":"0.8318215726","16":"0.590659516","17":"0.889641143","18":"-1.034045869","19":"-0.1024877","20":"0.996124624","21":"-3.59899523","22":"0.08297357","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-2.27551362","2":"1.9537503","3":"-3.374126","4":"2.838480189","5":"-3.3741259","6":"6.429265029","7":"-0.006830077","8":"-3.3741259","9":"1.560348027","10":"4.925657","11":"-0.735068577","12":"2.019501640","13":"-3.374126","14":"-0.2830835","15":"2.3847758673","16":"-0.735068577","17":"-3.374125907","18":"-1.764687994","19":"3.5937833","20":"0.339446160","21":"-3.37412591","22":"0.05182910","23":"-0.618508245","24":"anc","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.42430401","2":"2.1440405","3":"-3.424304","4":"2.554581758","5":"-3.4243040","6":"6.235135511","7":"0.945143846","8":"-3.4243040","9":"3.594992647","10":"4.414434","11":"-0.205428182","12":"5.142631277","13":"-3.424304","14":"-0.9393974","15":"1.1606634722","16":"0.009683198","17":"-3.424304006","18":"-1.478393857","19":"-0.7162538","20":"1.108295487","21":"-3.42430401","22":"0.14526251","23":"-0.618508245","24":"anc","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-0.79412921","2":"1.4676339","3":"-3.096714","4":"2.323820697","5":"-3.0967143","6":"6.579558924","7":"1.062168781","8":"-3.0967143","9":"1.179951816","10":"5.069502","11":"-1.150804154","12":"3.367874001","13":"-3.096714","14":"-3.0967143","15":"2.1711438563","16":"-1.304954834","17":"-3.096714303","18":"-3.096714303","19":"3.3035431","20":"1.498405547","21":"-3.09671430","22":"0.20755145","23":"-0.618508245","24":"anc","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-0.11247265","2":"2.1108631","3":"-3.156995","4":"2.826941189","5":"-3.1569951","6":"6.440714304","7":"0.453922821","8":"-3.1569951","9":"1.978803345","10":"4.936773","11":"-3.156995092","12":"3.733614028","13":"-3.156995","14":"-3.1569951","15":"1.9846684646","16":"-0.517937762","17":"-3.156995092","18":"-1.365235623","19":"2.9978630","20":"-0.212556113","21":"-3.15699509","22":"0.08297357","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.31219623","2":"1.5781529","3":"-2.619049","4":"1.769208135","5":"-1.9259019","6":"5.900341725","7":"0.494466260","8":"-1.9259019","9":"2.315424883","10":"4.137883","11":"-0.316463957","12":"4.771132379","13":"-2.213584","14":"-3.3121962","15":"1.0698304044","16":"-0.673138901","17":"-2.619049050","18":"-3.312196230","19":"2.0814313","20":"1.424002218","21":"-3.31219623","22":"-0.16618219","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.46929698","2":"2.3297957","3":"-3.469297","4":"2.283275657","5":"-3.4692970","6":"6.329940550","7":"0.442726024","8":"-3.4692970","9":"2.945799978","10":"4.068666","11":"-2.776149801","12":"5.164612010","13":"-3.469297","14":"-1.5233868","15":"1.1358732046","16":"0.673837745","17":"-3.469296981","18":"-1.859859069","19":"3.3297589","20":"1.740189171","21":"-3.46929698","22":"0.17640698","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-0.59478916","2":"1.5864351","3":"-3.233846","4":"2.422145320","5":"-3.2338465","6":"6.204107427","7":"0.321501571","8":"-3.2338465","9":"0.940540779","10":"4.802727","11":"-2.135234202","12":"1.770099815","13":"-3.233846","14":"-0.4612578","15":"2.0288436982","16":"-0.594789161","17":"-3.233846491","18":"-2.540699310","19":"3.9105607","20":"1.742887252","21":"-3.23384649","22":"0.17640698","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-0.65094319","2":"1.5388464","3":"-3.358993","4":"3.522417916","5":"-1.9726990","6":"6.342683932","7":"0.917672732","8":"-3.3589934","9":"2.540903966","10":"4.191142","11":"0.074993817","12":"3.860648653","13":"-3.358993","14":"-1.7495555","15":"1.0477258599","16":"-1.972699026","17":"-3.358993387","18":"-3.358993387","19":"1.5313557","20":"0.931466054","21":"-3.35899339","22":"-0.22847113","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.05713393","2":"1.9242096","3":"-3.696191","4":"2.852027839","5":"-3.6961913","6":"6.157790869","7":"0.634542076","8":"-3.6961913","9":"3.294065236","10":"4.332264","11":"-0.438094726","12":"4.641157300","13":"-3.696191","14":"-1.6167497","15":"0.9287815492","16":"0.836408229","17":"-3.696191264","18":"-1.904431795","19":"0.3981533","20":"1.194157864","21":"-3.69619126","22":"0.05182910","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-1.55693388","2":"1.8442635","3":"-3.502844","4":"3.390812330","5":"-3.5028440","6":"6.195217097","7":"0.467447888","8":"-3.5028440","9":"3.579704544","10":"4.389982","11":"-3.502844025","12":"4.701554393","13":"-3.502844","14":"-0.4583216","15":"1.2245437936","16":"0.052504036","17":"-3.502844025","18":"-1.200258932","19":"0.5402072","20":"1.349186239","21":"-3.50284403","22":"0.02068463","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-1.38292743","2":"2.6168012","3":"-3.867834","4":"2.121127335","5":"-3.8678341","6":"5.316264979","7":"0.927956464","8":"-3.8678341","9":"2.913223544","10":"3.680195","11":"-0.106633966","12":"2.612210480","13":"-3.867834","14":"-3.8678341","15":"2.3038665157","16":"-3.867834082","17":"0.488874745","18":"0.919657661","19":"4.2145682","20":"0.449654032","21":"-3.86783408","22":"-1.53653890","23":"1.435360495","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-3.72029009","2":"2.4281782","3":"-3.720290","4":"3.680330484","5":"-3.7202901","6":"5.415757674","7":"2.240715247","8":"-3.7202901","9":"2.914343265","10":"3.579507","11":"-3.720290093","12":"3.418576907","13":"-3.720290","14":"-3.7202901","15":"2.2355472764","16":"-2.621677804","17":"0.570169348","18":"1.427204384","19":"3.1570060","20":"1.316662509","21":"-3.72029009","22":"-1.34967207","23":"1.587513284","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"1.11252003","2":"1.2923131","3":"-3.770282","4":"2.101835901","5":"-2.6716696","6":"5.876763827","7":"0.200010025","8":"-2.6716696","9":"2.188142804","10":"4.250974","11":"2.067448558","12":"4.570174124","13":"-3.770282","14":"-3.7702819","15":"0.8146855900","16":"-3.770281889","17":"-0.512185351","18":"-3.770281889","19":"2.1486120","20":"1.853735618","21":"-3.77028189","22":"-0.07274878","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-1.21859662","2":"3.7742341","3":"-4.051810","4":"3.930947740","5":"-4.0518100","6":"4.804566075","7":"0.553360224","8":"-4.0518100","9":"2.528829175","10":"3.495164","11":"-0.267620328","12":"0.760374393","13":"-4.051810","14":"-1.3437598","15":"0.7017802291","16":"0.122577308","17":"-4.051809962","18":"0.224856157","19":"4.7012456","20":"1.542901418","21":"-4.05180996","22":"-1.19394972","23":"1.460697748","24":"anc","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.64191239","2":"2.4398534","3":"-4.126819","4":"3.033250166","5":"-4.1268190","6":"4.192410897","7":"-0.083767773","8":"-4.1268190","9":"2.871690601","10":"2.698641","11":"-0.759523211","12":"0.883816253","13":"-4.126819","14":"-1.2364473","15":"1.7368121344","16":"-0.489232882","17":"0.032064042","18":"1.298130976","19":"4.9976366","20":"0.660672702","21":"-4.12681904","22":"-0.94479396","23":"1.739666073","24":"anc","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-2.37939154","2":"2.1241150","3":"-3.478004","4":"4.851412954","5":"-3.4780038","6":"5.639343675","7":"0.529329355","8":"-3.4780038","9":"2.010933896","10":"3.105405","11":"-0.769953629","12":"1.075873062","13":"-3.478004","14":"-1.3985623","15":"1.1171160201","16":"-1.532093681","17":"-0.838946500","18":"-0.386961377","19":"3.2660554","20":"0.976343466","21":"-3.47800383","22":"-0.66449372","23":"0.877553118","24":"anc","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-0.46698434","2":"1.5914038","3":"-3.868182","4":"4.069550054","5":"-3.8681817","6":"5.624853307","7":"0.449306393","8":"-3.8681817","9":"0.902502904","10":"3.515808","11":"0.785778629","12":"1.848845981","13":"-3.868182","14":"-2.2587438","15":"1.1154249009","16":"-0.402445818","17":"-1.034968377","18":"-0.341821196","19":"3.1758512","20":"0.766547267","21":"-3.86818172","22":"-0.91364949","23":"-0.314202667","24":"anc","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-3.82577103","2":"3.1607954","3":"-3.825771","4":"3.162642153","5":"-3.8257710","6":"4.625923180","7":"0.779399157","8":"-3.8257710","9":"3.331964455","10":"3.228679","11":"-0.734728576","12":"2.071382839","13":"-3.825771","14":"-3.8257710","15":"2.2923261691","16":"0.491717085","17":"-3.825771029","18":"1.633814485","19":"5.1569156","20":"1.405337588","21":"-3.82577103","22":"-1.25623866","23":"1.105717665","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.56610949","2":"2.4104520","3":"-3.357869","4":"3.018857987","5":"-3.3578690","6":"6.192935669","7":"1.404304974","8":"-3.3578690","9":"2.975410667","10":"2.836536","11":"-3.357868961","12":"2.407322142","13":"-3.357869","14":"-3.3578690","15":"1.6119443386","16":"0.492278641","17":"-3.357868961","18":"1.060971647","19":"3.2487812","20":"0.769265424","21":"-3.35786896","22":"-1.53653890","23":"0.421094752","24":"anc","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.35852398","2":"2.3993483","3":"-3.304434","4":"1.813559681","5":"-3.3044341","6":"6.435828360","7":"0.646809587","8":"-3.3044341","9":"1.499586914","10":"5.151096","11":"-0.259911693","12":"3.110662828","13":"-3.304434","14":"-1.9181398","15":"0.6845499154","16":"-2.205821843","17":"-3.304434131","18":"-0.906538858","19":"3.2678484","20":"1.466250493","21":"-3.30443413","22":"0.05182910","23":"-0.593170992","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"0.68749916","2":"1.1463650","3":"-3.681949","4":"1.984477992","5":"-3.6819487","6":"6.116900302","7":"0.594717423","8":"-3.6819487","9":"2.744539761","10":"4.628958","11":"2.041636406","12":"4.632883483","13":"-3.681949","14":"-2.2956543","15":"0.7488681027","16":"-1.890189227","17":"-2.988801516","18":"-2.583336407","19":"1.0093992","20":"1.831480050","21":"-3.68194870","22":"0.14526251","23":"-0.618508245","24":"anc","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"3.26519858","2":"2.2385237","3":"-3.784924","4":"1.867565238","5":"-2.1754860","6":"3.305152893","7":"-0.047254324","8":"-1.8390138","9":"-0.789191669","10":"3.436912","11":"5.690392665","12":"2.470826099","13":"-3.091777","14":"-2.1754860","15":"0.3894633275","16":"-1.839013793","17":"-1.012335220","18":"-3.091776762","19":"1.3508745","20":"-0.383726561","21":"-3.78492394","22":"0.86158533","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"3.74562175","2":"2.2797922","3":"-4.350891","4":"1.978829740","5":"-1.2153969","6":"1.643070262","7":"-1.055054299","8":"-1.2153969","9":"-0.290448155","10":"3.338480","11":"5.574651378","12":"2.024133654","13":"-4.350891","14":"-2.4049810","15":"0.4932959210","16":"-2.741453253","17":"-1.306368728","18":"-2.964596804","19":"2.0964147","20":"-0.361907119","21":"-0.91690396","22":"-0.72678266","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"3.96668674","2":"2.0167886","3":"-4.332350","4":"1.298861342","5":"-0.8358429","6":"2.013285921","7":"-0.189215714","8":"-0.7214325","9":"0.587630486","10":"3.610367","11":"5.273135307","12":"1.445301883","13":"-4.332350","14":"-4.3323504","15":"0.4959632971","16":"-2.722912528","17":"-1.559761718","18":"-2.386440291","19":"1.6182921","20":"0.086490168","21":"-1.00014593","22":"0.73700745","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"3.89602260","2":"2.2502170","3":"-3.610569","4":"2.602036915","5":"-3.6105692","6":"3.484495197","7":"-0.144833278","8":"-3.6105692","9":"-0.352472642","10":"3.699981","11":"5.609127287","12":"1.646926192","13":"-3.610569","14":"-2.2242748","15":"0.3967640049","16":"-1.664659031","17":"-0.837980458","18":"-2.224274819","19":"2.3908457","20":"-0.475074964","21":"-3.61056918","22":"1.92049733","23":"-0.618508245","24":"bact","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.48261143","2":"2.5770402","3":"-4.123691","4":"2.849852083","5":"-4.1236909","6":"2.337777240","7":"-0.386021318","8":"-4.1236909","9":"0.207042404","10":"3.843936","11":"5.559960091","12":"0.688493419","13":"-4.123691","14":"-2.3319315","15":"1.1074176807","16":"-1.926466359","17":"-0.512773023","18":"-2.514253024","19":"2.6238956","20":"-0.386021318","21":"-1.72579566","22":"0.30098486","23":"-0.618508245","24":"bact","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.33574215","2":"2.5252452","3":"-4.093494","4":"2.871586582","5":"-2.0140522","6":"1.997816118","7":"-0.429932118","8":"-1.8962692","9":"0.677190861","10":"3.551904","11":"5.422785997","12":"-0.123201850","13":"-4.093494","14":"-4.0934938","15":"0.3253468440","16":"-2.147583615","17":"-1.260280420","18":"-2.301734295","19":"2.4590141","20":"-0.509974825","21":"-1.20312201","22":"0.51899616","23":"-0.618508245","24":"bact","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"3.93776007","2":"2.2169796","3":"-4.228740","4":"2.491479911","5":"-0.3575392","6":"1.594305651","7":"-0.491070626","8":"-0.2774965","9":"0.366379606","10":"3.367652","11":"5.132946880","12":"1.304649245","13":"-4.228740","14":"-2.1492987","15":"-0.0543529743","16":"-2.842445883","17":"-1.589682915","18":"-3.130127956","19":"1.0544635","20":"-0.085605518","21":"-2.03151567","22":"0.48785169","23":"-0.618508245","24":"bact","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"3.91145795","2":"2.1604767","3":"-3.598425","4":"2.163626273","5":"-3.5984251","6":"3.413690185","7":"-0.825836387","8":"-3.5984251","9":"0.544709617","10":"4.261760","11":"5.714742572","12":"2.248013666","13":"-2.905278","14":"-1.9889872","15":"0.9233634677","16":"-3.598425109","17":"-0.825836387","18":"-1.988987197","19":"1.4514309","20":"-0.266220599","21":"-3.59842511","22":"2.10736415","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.07274471","2":"2.3195900","3":"-4.338421","4":"2.578293944","5":"-0.6007515","6":"2.005459358","7":"-0.783073015","8":"-0.4882735","9":"0.761445352","10":"3.393071","11":"5.116902614","12":"-0.624849009","13":"-4.338421","14":"-3.6452739","15":"0.1502152936","16":"-2.728983164","17":"-1.006216566","18":"-2.546661607","19":"2.1308292","20":"-0.133728457","21":"-1.29389864","22":"0.83044086","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"3.98170933","2":"2.0716353","3":"-3.963846","4":"1.229110756","5":"-2.8652338","6":"3.395621543","7":"0.006445819","8":"-2.8652338","9":"1.392740180","10":"4.284421","11":"5.426312704","12":"2.207854503","13":"-3.963846","14":"-2.3544082","15":"1.0333661789","16":"-2.577551734","17":"-1.130632751","18":"-2.354408182","19":"1.1894455","20":"-0.179656461","21":"-3.96384609","22":"1.98278627","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.55034124","2":"2.1204432","3":"-3.790353","4":"2.104049427","5":"-3.7903534","6":"2.307720875","7":"-0.324617505","8":"-3.7903534","9":"1.246599195","10":"4.041264","11":"5.624396118","12":"0.443753097","13":"-3.790353","14":"-2.4040590","15":"0.9971383354","16":"-1.710911866","17":"-0.794621134","18":"-2.691741119","19":"2.0675797","20":"-0.571477583","21":"-1.84444326","22":"0.58128510","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.15245579","2":"2.2429133","3":"-3.834729","4":"2.580368001","5":"-2.2252910","6":"2.210276356","7":"-0.073528842","8":"-2.2252910","9":"1.063110842","10":"3.474483","11":"5.243906923","12":"-0.433531576","13":"-3.834729","14":"-2.7361167","15":"0.3396583118","16":"-1.755287416","17":"-1.436833685","18":"-2.736116669","19":"1.9367122","20":"-0.197142798","21":"-1.75528742","22":"0.83044086","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.26599884","2":"2.0529486","3":"-3.948466","4":"1.671934542","5":"-2.1567069","6":"3.416080690","7":"-0.422105799","8":"-2.1567069","9":"1.107779482","10":"4.008361","11":"5.395267931","12":"0.676506489","13":"-3.948466","14":"-2.3390284","15":"0.8637180316","16":"-3.255319143","17":"-0.812972108","18":"-2.562171963","19":"2.2336186","20":"-0.141803834","21":"-3.94846632","22":"1.54676368","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.35988597","2":"2.4931754","3":"-3.938156","4":"2.414473705","5":"-3.9381557","6":"2.384409549","7":"-0.536958310","8":"-3.9381557","9":"0.824018244","10":"3.409144","11":"5.501866809","12":"-0.046335393","13":"-3.938156","14":"-2.5518613","15":"0.4926611076","16":"-1.992245542","17":"-0.249276237","18":"-2.146396222","19":"2.7313424","20":"-0.441648130","21":"-0.89363325","22":"0.73700745","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.41697792","2":"0.7463897","3":"-3.635637","4":"4.108499727","5":"-3.6356369","6":"5.080571071","7":"1.027802194","8":"-3.6356369","9":"-0.303432390","10":"1.988381","11":"2.074790117","12":"1.476350888","13":"-3.635637","14":"-3.6356369","15":"0.9594829497","16":"-0.927586699","17":"-0.745265142","18":"-1.438412323","19":"2.7082435","20":"-1.556195359","21":"-1.43841232","22":"-0.44648243","23":"3.362478336","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.53315183","2":"1.0972847","3":"-3.690207","4":"2.853704779","5":"-3.6902071","6":"2.540274381","7":"0.558288175","8":"-3.6902071","9":"0.070993049","10":"1.760831","11":"5.986379886","12":"-0.471331242","13":"-3.690207","14":"-3.6902071","15":"0.9049127833","16":"-1.051149737","17":"-1.125257709","18":"-0.694474793","19":"2.7475446","20":"-1.125257709","21":"-0.13485901","22":"-1.00708290","23":"0.877553118","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.89323863","2":"1.7881145","3":"-3.495089","4":"3.079986608","5":"-3.4950892","6":"2.468490111","7":"0.456154486","8":"-3.4950892","9":"-0.499356959","10":"2.852300","11":"5.377958567","12":"-1.415647690","13":"-3.495089","14":"-3.4950892","15":"0.7815768868","16":"-2.108794871","17":"-0.661875888","18":"-1.549179083","19":"3.4206342","20":"-0.550650253","21":"0.14249693","22":"-1.47424995","23":"-0.567769103","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.17795651","2":"0.7257040","3":"-3.522791","4":"3.517745104","5":"-2.1364969","6":"5.738052068","7":"1.041556905","8":"-2.1364969","9":"-0.689577942","10":"1.389864","11":"3.445117916","12":"0.725703956","13":"-3.522791","14":"-3.5227913","15":"0.8592353486","16":"-3.522791286","17":"-0.303915461","18":"-0.957841929","19":"3.4375564","20":"-1.220206193","21":"-3.52279129","22":"-0.60220478","23":"2.627116281","24":"bact","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.33052208","2":"1.4170279","3":"-3.473321","4":"2.956398256","5":"-3.4733212","6":"2.352678885","7":"0.264348396","8":"-3.4733212","9":"-0.477588949","10":"2.378881","11":"5.922253128","12":"-0.177484356","13":"-3.473321","14":"-3.4733212","15":"0.3108684116","16":"-1.863883310","17":"-0.834263893","18":"-1.276096645","19":"3.4111654","20":"-0.765271021","21":"-0.58294946","22":"-1.16280525","23":"-0.441018203","24":"bact","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"3.69470203","2":"0.7159447","3":"-3.899176","4":"2.819837341","5":"-2.2897379","6":"5.789322352","7":"0.773653021","8":"-2.2897379","9":"-0.261589653","10":"1.821136","11":"2.932777752","12":"2.238551241","13":"-3.899176","14":"-3.8991758","15":"1.1312621082","16":"-1.819734272","17":"-0.854653376","18":"-0.566971303","19":"3.2632217","20":"-1.501280540","21":"-3.89917581","22":"0.55014063","23":"3.590707519","24":"bact","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.30580438","2":"2.0644300","3":"-3.703891","4":"2.822603882","5":"-3.7038910","6":"2.488471512","7":"-0.040329332","8":"-3.7038910","9":"0.470496292","10":"2.548013","11":"5.335542442","12":"-0.336595148","13":"-3.703891","14":"-3.7038910","15":"0.5587888994","16":"-1.401305885","17":"-1.138941620","18":"-1.138941620","19":"2.9956094","20":"-0.568396762","21":"-0.44579444","22":"-0.29076008","23":"-0.364941809","24":"bact","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"3.65202566","2":"0.9095327","3":"-3.447176","4":"3.468547365","5":"-3.4471761","6":"6.113116687","7":"0.843283358","8":"-3.4471761","9":"-0.189079545","10":"1.711879","11":"2.814315601","12":"0.381465313","13":"-3.447176","14":"-2.7540289","15":"1.3568449612","16":"-0.613962739","17":"-1.655416614","18":"-1.049280811","19":"3.3912291","20":"-1.144590991","21":"-3.44717608","22":"2.85483144","23":"3.032835505","24":"bact","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"3.91619407","2":"1.7715521","3":"-3.915423","4":"1.804888567","5":"-3.9154232","6":"5.344659255","7":"0.454024643","8":"-3.9154232","9":"0.606365368","10":"2.857657","11":"4.857496883","12":"0.211711176","13":"-3.915423","14":"-2.3059853","15":"1.6452584217","16":"-1.835981668","17":"-0.657326671","18":"-0.514225828","19":"2.4458793","20":"-1.025051451","21":"-3.91542321","22":"0.30098486","23":"0.421094752","24":"bact","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.93043934","2":"1.5547500","3":"-3.627034","4":"3.052565619","5":"-3.6270336","6":"2.190077593","7":"-0.071685505","8":"-3.6270336","9":"-0.100673042","10":"2.283763","11":"5.593059097","12":"-0.259737737","13":"-3.627034","14":"-3.6270336","15":"0.6496325524","16":"-1.547592025","17":"-1.062084209","18":"-0.736661809","19":"3.1391581","20":"-0.408157742","21":"-0.07168551","22":"-0.35304902","23":"-0.491757345","24":"bact","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"3.68354104","2":"1.0939151","3":"-3.668259","4":"3.285425381","5":"-1.2703636","6":"5.704880433","7":"0.536433790","8":"-1.2703636","9":"-0.410162291","10":"1.734419","11":"3.554307189","12":"0.797649289","13":"-3.668259","14":"-3.6682588","15":"0.7860884668","16":"-2.058820917","17":"-0.960208628","18":"-1.471034252","19":"2.5261466","20":"-1.588817288","21":"-3.66825883","22":"2.91712039","23":"2.906084605","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.14191016","2":"0.6457912","3":"-3.710918","4":"1.905853443","5":"-3.7109177","6":"4.829796732","7":"0.719899144","8":"-3.7109177","9":"0.314434036","10":"1.992865","11":"5.609263183","12":"-0.343621825","13":"-3.710918","14":"-1.7650075","15":"1.1012667005","16":"-0.938328933","17":"-1.226011005","18":"0.139229947","19":"2.5732165","20":"-1.145968297","21":"-3.71091765","22":"0.23869592","23":"0.370420246","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.77830463","2":"1.7407189","3":"-3.768669","4":"2.978917043","5":"-3.7686695","6":"2.750477804","7":"0.562063857","8":"-3.7686695","9":"-0.131083324","10":"2.483234","11":"5.354914024","12":"-0.213321422","13":"-3.768669","14":"-3.0755223","15":"0.4057177863","16":"-1.689227942","17":"-0.996080761","18":"-1.283762834","19":"2.8078001","20":"-0.772937210","21":"0.37446524","22":"-1.00708290","23":"-0.415680951","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.24805334","2":"0.8675821","3":"-3.643277","4":"4.022476015","5":"-1.8515179","6":"5.507737489","7":"0.931433562","8":"-1.8515179","9":"-0.552234963","10":"1.745794","11":"3.280351211","12":"-0.242080035","13":"-3.643277","14":"-3.6432774","15":"0.8565322536","16":"-0.647545143","17":"-1.158370767","18":"-0.935227216","19":"2.6086265","20":"-2.256983056","21":"-3.64327742","22":"-1.10051631","23":"2.297473450","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.20312115","2":"1.2404099","3":"-3.679571","4":"2.564595844","5":"-3.6795711","6":"5.047558859","7":"0.510083685","8":"-3.6795711","9":"0.431302808","10":"2.348707","11":"5.378550102","12":"-0.312275227","13":"-3.679571","14":"-3.6795711","15":"1.4852149173","16":"-1.482346479","17":"-0.460695232","18":"-0.213835154","19":"2.7140197","20":"-1.376985964","21":"-3.67957106","22":"-0.25961561","23":"0.573247540","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"-0.52072989","2":"2.7373666","3":"-3.159787","4":"2.973610823","5":"-3.1597872","6":"6.084954578","7":"0.207508610","8":"-3.1597872","9":"2.715143511","10":"3.360834","11":"0.601412895","12":"4.423460304","13":"-3.159787","14":"-3.1597872","15":"0.9990958630","16":"-3.159787220","17":"-3.159787220","18":"-3.159787220","19":"3.6977268","20":"1.157700893","21":"-3.15978722","22":"-0.01045984","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"0.84174046","2":"3.1024784","3":"-3.269133","4":"3.242611927","5":"-3.2691334","6":"6.530936191","7":"0.196602500","8":"-3.2691334","9":"1.998724757","10":"4.101097","11":"-0.378761644","12":"1.559180335","13":"-3.269133","14":"-3.2691334","15":"0.9935464747","16":"-1.882839041","17":"-2.170521114","18":"-3.269133402","19":"4.1896293","20":"0.559507994","21":"-3.26913340","22":"-0.07274878","23":"-0.618508245","24":"bact","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"0.90348801","2":"2.9594416","3":"-3.345007","4":"3.471728651","5":"-3.3450072","6":"5.985513303","7":"0.056190153","8":"-3.3450072","9":"2.044064501","10":"3.130425","11":"0.625284684","12":"3.817390268","13":"-3.345007","14":"-3.3450072","15":"0.2385117093","16":"-0.860100579","17":"-3.345007229","18":"-3.345007229","19":"3.6387827","20":"0.749337333","21":"-3.34500723","22":"-0.19732666","23":"-0.618508245","24":"bact","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.35933795","2":"2.3642472","3":"-3.359338","4":"3.307618847","5":"-3.3593379","6":"5.997955839","7":"0.074649259","8":"-3.3593379","9":"2.828926177","10":"3.818444","11":"4.705612946","12":"1.822445605","13":"-3.359338","14":"-1.9730436","15":"0.7677964394","16":"-0.314815508","17":"-3.359337946","18":"-3.359337946","19":"3.9438321","20":"-0.468966188","21":"-3.35933795","22":"-0.07274878","23":"-0.618508245","24":"bact","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"0.50873272","2":"2.4476498","3":"-3.204839","4":"2.582058032","5":"-3.2048393","6":"3.610800641","7":"-0.719932699","8":"-3.2048393","9":"2.292328876","10":"3.677598","11":"5.760878440","12":"3.945077487","13":"-3.204839","14":"-1.2589292","15":"-0.2091070753","16":"-2.106227060","17":"-3.204839349","18":"-3.204839349","19":"1.8889109","20":"0.014036476","21":"-3.20483935","22":"0.30098486","23":"-0.618508245","24":"bact","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-1.59017842","2":"2.9007026","3":"-3.199616","4":"3.887121599","5":"-3.1996163","6":"6.429039556","7":"0.411301577","8":"-3.1996163","9":"2.477137467","10":"4.288677","11":"-0.634666978","12":"1.311243171","13":"-3.199616","14":"-3.1996163","15":"1.4155041812","16":"-0.203884062","17":"-3.199616336","18":"-3.199616336","19":"4.4409875","20":"0.463945311","21":"-3.19961634","22":"-0.16618219","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-2.98836501","2":"2.8317179","3":"-2.988365","4":"3.799479971","5":"-2.9883650","6":"6.532030284","7":"0.508142550","8":"-2.9883650","9":"3.056640303","10":"4.470974","11":"-1.042454862","12":"1.739022807","13":"-2.988365","14":"-2.9883650","15":"0.9434606213","16":"-0.908923470","17":"-2.988365011","18":"-2.988365011","19":"4.0823591","20":"0.882836000","21":"-2.98836501","22":"-0.22847113","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.15168548","2":"2.5670995","3":"-3.790743","4":"2.907525243","5":"-3.7907428","6":"5.593214677","7":"-0.153156651","8":"-3.7907428","9":"2.947409684","10":"3.240998","11":"4.782452571","12":"3.971427796","13":"-3.790743","14":"-1.8448327","15":"0.2165903744","16":"-2.692130522","17":"-0.179824898","18":"-2.404448450","19":"1.6857207","20":"-0.532646273","21":"-3.79074281","22":"-0.07274878","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-0.92711836","2":"2.4906083","3":"-3.699707","4":"3.021718614","5":"-3.6997071","6":"4.127135012","7":"-0.755268107","8":"-3.6997071","9":"2.630013819","10":"3.732777","11":"5.716996837","12":"3.938491158","13":"-3.699707","14":"-1.5024825","15":"-0.2657198818","16":"-2.313412725","17":"-0.233971183","18":"-2.090269174","19":"1.2275466","20":"-0.298509705","21":"-3.69970709","22":"0.23869592","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"1.03628757","2":"2.6819051","3":"-3.699911","4":"3.574568684","5":"-3.6999109","6":"6.001827623","7":"-0.404074009","8":"-3.6999109","9":"2.429139335","10":"3.948352","11":"-0.173550350","12":"1.481872675","13":"-3.699911","14":"-3.6999109","15":"0.3944336874","16":"-0.866697531","17":"-0.564416659","18":"-1.908151406","19":"3.7460906","20":"0.821877702","21":"-3.69991087","22":"-0.22847113","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"1.09751689","2":"2.2789154","3":"-3.620982","4":"4.662764771","5":"-3.6209820","6":"5.531411436","7":"0.330261742","8":"-3.6209820","9":"2.178110678","10":"3.004410","11":"-0.253686146","12":"2.082800498","13":"-3.620982","14":"-2.9278348","15":"0.5837106429","16":"-1.136075327","17":"-0.912931775","18":"-3.620981976","19":"3.7460951","20":"1.460422389","21":"-3.62098198","22":"0.05182910","23":"-0.618508245","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"0.08707169","2":"2.8828275","3":"-3.784129","4":"4.491756354","5":"-3.7841293","6":"4.927478680","7":"1.936182461","8":"-3.7841293","9":"2.364338980","10":"3.147342","11":"0.107690982","12":"1.430806442","13":"-3.784129","14":"-3.7841293","15":"1.7956005100","16":"0.519935777","17":"-3.784129316","18":"-3.784129316","19":"4.7242249","20":"1.857777755","21":"-3.78412932","22":"-0.88250502","23":"4.326004938","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.51553265","2":"2.2648619","3":"-3.307292","4":"3.972716130","5":"-2.6141449","6":"6.141198632","7":"2.015717856","8":"-3.3072921","9":"2.160768018","10":"3.641605","11":"-0.474078779","12":"1.181344246","13":"-3.307292","14":"-3.3072921","15":"1.5679051999","16":"0.060003707","17":"-3.307292123","18":"-3.307292123","19":"3.4508024","20":"0.604730882","21":"-2.61414494","22":"-1.34967207","23":"1.587513284","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-3.05466378","2":"2.4259751","3":"-3.054664","4":"4.205155826","5":"-3.0546638","6":"6.397052907","7":"1.857991101","8":"-3.0546638","9":"2.297194349","10":"4.446418","11":"-3.054663785","12":"2.558464322","13":"-3.054664","14":"-3.0546638","15":"1.9626160521","16":"-0.975222243","17":"-3.054663785","18":"-3.054663785","19":"3.7161256","20":"1.654866417","21":"-3.05466378","22":"-1.16280525","23":"-0.263528162","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-1.24862716","2":"2.0875377","3":"-3.445852","4":"3.967515594","5":"-3.4458517","6":"6.132874730","7":"0.019884161","8":"-3.4458517","9":"1.597573375","10":"4.023232","11":"-0.501412763","12":"2.788558984","13":"-3.445852","14":"-3.4458517","15":"1.4444973863","16":"-3.445851742","17":"-2.347239453","18":"0.109496320","19":"4.3991727","20":"1.647898459","21":"-3.44585174","22":"0.02068463","23":"-0.339604556","24":"bact","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-2.01232013","2":"2.1115832","3":"-3.621758","4":"3.987608496","5":"-2.5231458","6":"5.455507976","7":"0.952952937","8":"-3.6217580","9":"2.480800553","10":"2.588842","11":"-0.849169320","12":"3.052803350","13":"-3.621758","14":"-3.6217580","15":"1.5022059375","16":"-1.056808684","17":"-3.621758042","18":"1.771869504","19":"3.1104527","20":"1.157365451","21":"-3.62175804","22":"-1.34967207","23":"1.587513284","24":"bact","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-3.53932210","2":"2.4216832","3":"-3.539322","4":"3.391172666","5":"-3.5393221","6":"6.130150521","7":"0.372700905","8":"-3.5393221","9":"2.130558823","10":"3.133976","11":"-0.243485234","12":"3.874648190","13":"-3.539322","14":"-3.5393221","15":"1.9329485732","16":"-0.172026270","17":"-2.846174920","18":"1.095406888","19":"2.5080501","20":"1.045645378","21":"-3.53932210","22":"-1.38081654","23":"0.826813976","24":"bact","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-1.54686997","2":"1.7340412","3":"-2.463161","4":"3.133407686","5":"-3.1563079","6":"6.265912846","7":"0.062567940","8":"-3.1563079","9":"1.854327409","10":"4.660109","11":"0.340199677","12":"2.822577880","13":"-3.156308","14":"-3.1563079","15":"1.1063719921","16":"-2.057695596","17":"-2.057695596","18":"-3.156307885","19":"3.8833525","20":"1.200400942","21":"-3.15630788","22":"-0.01045984","23":"-0.517094598","24":"bact","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-2.46657680","2":"2.6302362","3":"-3.159724","4":"5.103608683","5":"-2.4665768","6":"5.804204210","7":"1.870713937","8":"-2.4665768","9":"2.492765196","10":"3.210177","11":"-0.326510640","12":"2.113275574","13":"-3.159724","14":"-3.1597240","15":"1.6923062798","16":"-3.159723984","17":"-3.159723984","18":"-3.159723984","19":"3.8240660","20":"1.102955893","21":"-3.15972398","22":"-0.75792713","23":"0.801476723","24":"bact","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-3.22399691","2":"3.2832808","3":"-3.223997","4":"5.774263480","5":"-3.2239969","6":"6.398784181","7":"1.658805009","8":"-3.2239969","9":"2.012445050","10":"3.654330","11":"0.071839953","12":"2.178680469","13":"-3.223997","14":"-3.2239969","15":"1.9234975637","16":"-3.223996913","17":"-3.223996913","18":"-3.223996913","19":"4.0421319","20":"1.241911206","21":"-3.22399691","22":"-0.85136054","23":"0.116853810","24":"bact","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-2.14568397","2":"3.0293352","3":"-3.755122","4":"4.555784879","5":"-3.7551219","6":"4.756656681","7":"1.007052057","8":"-3.7551219","9":"2.333922998","10":"3.890754","11":"-0.459285012","12":"2.485153967","13":"-3.755122","14":"-3.7551219","15":"1.7171487957","16":"0.449570741","17":"-2.368827517","18":"-3.061974697","19":"4.3185928","20":"2.022530445","21":"-3.75512188","22":"-0.47762690","23":"2.398951733","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.05934442","2":"2.8746575","3":"-3.256569","4":"4.871130856","5":"-3.2565690","6":"6.549305727","7":"1.137880158","8":"-3.2565690","9":"1.925214554","10":"3.333732","11":"-3.256568997","12":"3.711340205","13":"-3.256569","14":"-3.2565690","15":"1.5876180898","16":"-0.953983904","17":"-3.256568997","18":"-3.256568997","19":"3.6114054","20":"1.720164746","21":"-3.25656900","22":"-1.28738313","23":"0.015375527","24":"bact","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-1.14860045","2":"2.4550842","3":"-3.856651","4":"5.203680451","5":"-3.8566507","6":"5.566459650","7":"0.075174980","8":"-3.8566507","9":"2.106928690","10":"3.034975","11":"1.778138950","12":"2.429347441","13":"-3.856651","14":"-0.8609184","15":"2.0939918994","16":"-3.856650653","17":"-3.856650653","18":"1.416348905","19":"2.7513500","20":"0.094593065","21":"-3.85665065","22":"-1.56768337","23":"-0.009961726","24":"bact","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"4.29181828","2":"2.2212007","3":"-3.989399","4":"0.959360513","5":"-0.8983569","6":"1.376576638","7":"0.035952313","8":"-0.7313028","9":"0.392627257","10":"3.508916","11":"5.158639968","12":"-0.588201996","13":"-3.989399","14":"-3.2962522","15":"0.2590958646","16":"-1.591504105","17":"-0.853905162","18":"-2.379961465","19":"2.2151584","20":"-0.057573745","21":"-2.04348923","22":"0.33212933","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.89014696","2":"2.0709586","3":"-3.700483","4":"1.119799012","5":"-3.7004826","6":"3.398719190","7":"0.473904717","8":"-3.7004826","9":"0.576183566","10":"3.855945","11":"5.410037483","12":"0.603582540","13":"-3.007335","14":"-3.7004826","15":"0.6689652991","16":"-1.621041012","17":"-0.089564641","18":"-1.754572404","19":"2.5161235","20":"-0.609440100","21":"-3.70048255","22":"0.70586298","23":"-0.618508245","24":"bact_pred","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"5.33432527","2":"2.5237366","3":"-4.070677","4":"0.524442982","5":"-4.0706769","6":"2.598821221","7":"0.656710950","8":"-4.0706769","9":"0.725113677","10":"3.955493","11":"5.846417687","12":"-0.264014379","13":"-4.070677","14":"-4.0706769","15":"0.8045204547","16":"-2.461238956","17":"0.056457517","18":"-1.873452291","19":"3.2452066","20":"-0.138851236","21":"-1.18030511","22":"0.23869592","23":"-0.618508245","24":"bact_pred","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.61324447","2":"2.3226563","3":"-4.222693","4":"0.341654875","5":"-1.0446395","6":"1.981864446","7":"0.504694502","8":"-1.0038175","9":"0.352017662","10":"3.558028","11":"5.236068414","12":"-0.639174378","13":"-4.222693","14":"-3.1240810","15":"0.2990952603","16":"-2.025468739","17":"-0.063810233","18":"-3.124081028","19":"2.7930191","20":"-0.611775404","21":"-1.92010822","22":"0.42556275","23":"-0.618508245","24":"bact_pred","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.67637203","2":"2.0682544","3":"-3.562957","4":"1.784150136","5":"-3.5629574","6":"2.745141047","7":"0.020561544","8":"-3.5629574","9":"0.349065611","10":"4.035943","11":"5.214289702","12":"2.297828829","13":"-3.562957","14":"-3.5629574","15":"0.1747122236","16":"-1.953519482","17":"-0.471914941","18":"-2.869810214","19":"2.4629086","20":"0.150614672","21":"-2.86981021","22":"0.92387427","23":"-0.618508245","24":"bact_pred","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.73120466","2":"2.1716650","3":"-3.919645","4":"0.069339134","5":"-1.9737348","6":"1.807202835","7":"-0.453909010","8":"-1.9737348","9":"-0.518447531","10":"3.911575","11":"5.581946157","12":"1.117307690","13":"-3.919645","14":"-2.3102070","15":"-0.3932843878","16":"-1.280587583","17":"-1.434738263","18":"-1.617059819","19":"2.1347944","20":"-0.112982423","21":"-1.61705982","22":"0.08297357","23":"-0.618508245","24":"bact_pred","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.29032285","2":"2.2075633","3":"-4.310108","4":"0.243768949","5":"-0.4182876","6":"1.896467984","7":"-0.378282310","8":"-0.3211239","9":"0.758796260","10":"3.490874","11":"5.177712640","12":"0.007380171","13":"-4.310108","14":"-3.2114957","15":"0.1207088565","16":"-1.912212670","17":"-1.132054112","18":"-2.518348473","19":"2.0717081","20":"-0.621228488","21":"-1.13205411","22":"0.70586298","23":"-0.618508245","24":"bact_pred","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.63317248","2":"2.1254967","3":"-3.491274","4":"1.644524063","5":"-3.4912744","6":"2.888848163","7":"-0.195437508","8":"-3.4912744","9":"-0.123978544","10":"4.379655","11":"5.616368600","12":"2.546596546","13":"-2.392662","14":"-1.2940498","15":"0.4977096730","16":"-3.491274374","17":"-0.852217044","18":"-3.491274374","19":"1.4991582","20":"-0.025538471","21":"-3.49127437","22":"2.16965309","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.27670980","2":"2.7693856","3":"-3.939919","4":"-0.008093065","5":"-0.1787186","6":"1.897811749","7":"-0.111277301","8":"-0.1112773","9":"-0.111277301","10":"3.788497","11":"5.425800171","12":"0.822255237","13":"-3.939919","14":"-3.9399187","15":"-0.2022490795","16":"-1.637333605","17":"-1.374969340","18":"-3.246771517","19":"1.9265494","20":"-0.111277301","21":"-1.99400855","22":"0.61242957","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.80223099","2":"2.4949926","3":"-3.789142","4":"0.181150319","5":"-3.7891416","6":"2.166695775","7":"0.142684038","8":"-3.0959944","9":"0.369741489","10":"3.660938","11":"5.757599583","12":"0.816028591","13":"-3.789142","14":"-2.4028472","15":"0.4155510247","16":"-1.997382125","17":"-0.955928251","18":"-1.709700053","19":"2.5316267","20":"-0.100262141","21":"-1.70970005","22":"0.08297357","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.36590450","2":"2.3274626","3":"-3.995103","4":"0.115771257","5":"-2.0491925","6":"1.877015183","7":"0.194552135","8":"-2.0491925","9":"0.939371326","10":"3.396929","11":"5.320678278","12":"-0.439754545","13":"-3.995103","14":"-3.3019554","15":"-0.0632769741","16":"-2.385664694","17":"0.295356834","18":"-2.385664694","19":"2.3399516","20":"0.308962486","21":"-0.81704878","22":"1.01730769","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.58533544","2":"1.5917407","3":"-4.046614","4":"0.749176556","5":"-4.0466140","6":"4.903400040","7":"0.297191432","8":"-3.3534668","9":"-0.095370271","10":"3.884311","11":"5.151046329","12":"2.012509206","13":"-2.660320","14":"-2.1007038","15":"0.6262148445","16":"-2.254854521","17":"-0.550106429","18":"-2.100703841","19":"2.0670682","20":"-0.612626786","21":"-4.04661399","22":"0.98616321","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.96410865","2":"2.4507200","3":"-3.599013","4":"0.620494234","5":"-3.5990135","6":"2.957764885","7":"-0.231717642","8":"-3.5990135","9":"-0.420959641","10":"4.202378","11":"5.711081733","12":"1.444411645","13":"-3.599013","14":"-2.9058663","15":"0.4953310906","16":"-1.807254002","17":"-0.654574492","18":"-1.519571930","19":"2.5035451","20":"0.185176162","21":"-3.59901347","22":"0.11411804","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.21599159","2":"2.2639485","3":"-4.176998","4":"-0.082653440","5":"-0.9581222","6":"1.765801372","7":"0.071497239","8":"-0.8097022","9":"0.771761888","10":"3.496690","11":"5.214162800","12":"-0.116554992","13":"-4.176998","14":"-3.0783857","15":"-0.1165549921","16":"-1.979773425","17":"-0.593479064","18":"-2.567560090","19":"2.1686384","20":"-0.225754284","21":"-1.08595555","22":"0.89272980","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.12521752","2":"0.9296891","3":"-3.021555","4":"3.549328300","5":"-3.0215547","6":"3.427334732","7":"0.113939554","8":"-3.0215547","9":"-0.313504461","10":"2.330303","11":"6.390419578","12":"-0.623659389","13":"-3.021555","14":"-3.0215547","15":"0.3796427196","16":"-2.328407481","17":"-0.942113120","18":"-1.229795193","19":"2.6344371","20":"-1.922942373","21":"-1.41211675","22":"-0.44648243","23":"1.257870454","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.14925492","2":"1.6424192","3":"-3.048929","4":"1.595462242","5":"-1.9503164","6":"2.741031514","7":"-0.215715313","8":"-1.9503164","9":"-0.651033384","10":"2.530801","11":"5.587646292","12":"-1.257169188","13":"-3.048929","14":"-3.0489287","15":"0.7352609772","16":"-3.048928657","17":"-0.851704079","18":"-1.662634296","19":"2.8399493","20":"-1.257169188","21":"0.16994717","22":"-1.16280525","23":"-0.491757345","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.37492262","2":"1.6569481","3":"-3.187239","4":"1.476200083","5":"-3.1872390","6":"4.657785406","7":"0.278496892","8":"-3.1872390","9":"0.339121513","10":"2.638761","11":"6.054503124","12":"-0.414650289","13":"-3.187239","14":"-3.1872390","15":"0.6629085906","16":"-2.088626722","17":"-0.884653918","18":"-1.107797469","19":"2.7208439","20":"-1.241328862","21":"-3.18723901","22":"-0.32190455","23":"1.257870454","24":"bact_pred","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.59394844","2":"1.6764191","3":"-3.735227","4":"1.479708759","5":"-3.7352270","6":"2.951881609","7":"0.659222156","8":"-3.7352270","9":"-0.097640839","10":"2.948134","11":"5.746361139","12":"-1.432641905","13":"-3.735227","14":"-3.0420798","15":"0.8186498931","16":"-2.125789086","17":"-0.902013654","18":"-1.337331726","19":"2.7478804","20":"-0.403022488","21":"0.65922216","22":"-0.63334925","23":"-0.238190909","24":"bact_pred","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.95734281","2":"1.6578737","3":"-3.758227","4":"1.335523475","5":"-2.6596144","6":"2.560741388","7":"0.249106460","8":"-2.6596144","9":"0.048435764","10":"2.759445","11":"4.963701618","12":"-0.867854967","13":"-3.758227","14":"-2.6596144","15":"0.8667460879","16":"-2.659614437","17":"-0.324239521","18":"-1.561002148","19":"2.6133851","20":"-0.580172895","21":"0.47587978","22":"0.70586298","23":"-0.441018203","24":"bact_pred","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"3.65639481","2":"1.9688082","3":"-3.955448","4":"1.504137920","5":"-2.0095374","6":"3.499850891","7":"0.375285746","8":"-2.0095374","9":"0.401261232","10":"3.027415","11":"4.872313773","12":"-0.521460390","13":"-3.955448","14":"-3.9554476","15":"0.4140002583","16":"-2.856835306","17":"0.104995416","18":"-2.009537445","19":"2.6027502","20":"-0.959715321","21":"-0.19424748","22":"0.51899616","23":"0.345018357","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.11275310","2":"1.3534096","3":"-3.988925","4":"1.524504098","5":"-1.9094831","6":"2.906758049","7":"0.417794599","8":"-1.9094831","9":"-0.160283252","10":"2.756312","11":"5.622805874","12":"-0.993192375","13":"-3.988925","14":"-3.9889246","15":"0.9163501301","16":"-2.379486736","17":"-0.897882195","18":"-1.280874447","19":"2.8267153","20":"-1.155711304","21":"0.21576797","22":"0.70586298","23":"-0.136712626","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.93043632","2":"1.3861651","3":"-2.899718","4":"1.779322318","5":"-2.2065705","6":"3.027208309","7":"-0.148182404","8":"-2.2065705","9":"-0.028038092","10":"2.992847","11":"5.274703436","12":"-0.260660387","13":"-3.998330","14":"-3.9983300","15":"0.2783361135","16":"-2.388892093","17":"-0.564342801","18":"-1.801105428","19":"2.8216864","20":"-0.820276175","21":"-0.16968861","22":"1.17303004","23":"-0.542431851","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.19369779","2":"1.7896978","3":"-3.472992","4":"1.951957611","5":"-3.4729924","6":"4.139838624","7":"1.015643963","8":"-3.4729924","9":"0.716662335","10":"2.853157","11":"6.305498655","12":"-1.170407314","13":"-3.472992","14":"-3.4729924","15":"0.5343407783","16":"-2.086698046","17":"-0.477260133","18":"-0.528553428","19":"2.6754759","20":"-1.075097134","21":"-3.47299241","22":"-0.63334925","23":"-0.086038120","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"4.04102187","2":"1.7920616","3":"-4.033938","4":"2.114529811","5":"-2.4245006","6":"3.555397338","7":"0.420408811","8":"-2.4245006","9":"0.408712772","10":"3.132327","11":"5.385365375","12":"-0.855884654","13":"-4.033938","14":"-4.0339385","15":"0.5304097067","16":"-3.340791304","17":"-0.632741103","18":"-1.468989127","19":"2.6506732","20":"-1.038206211","21":"0.25652096","22":"0.45670722","23":"-0.491757345","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"-3.15525525","2":"2.2914821","3":"-3.155255","4":"3.604000016","5":"-3.1552553","6":"6.368142496","7":"0.582414363","8":"-3.1552553","9":"2.075853362","10":"4.553155","11":"0.022798575","12":"0.651407235","13":"-3.155255","14":"-3.1552553","15":"1.4499149311","16":"-0.110732817","17":"-3.155255255","18":"-1.545817342","19":"4.4843870","20":"0.815036659","21":"-3.15525525","22":"-0.19732666","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.28000316","2":"2.3000375","3":"-3.359445","4":"3.833489518","5":"-3.3594447","6":"6.390483661","7":"0.610847210","8":"-3.3594447","9":"2.882778562","10":"3.797512","11":"0.469196693","12":"3.078306946","13":"-3.359445","14":"-3.3594447","15":"0.5723809294","16":"-0.651394502","17":"-3.359444703","18":"-1.973150342","19":"2.9949253","20":"0.490702898","21":"-3.35944470","22":"-0.07274878","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.44951717","2":"2.2642156","3":"-3.449517","4":"3.717520709","5":"-3.4495172","6":"5.909674150","7":"0.400630433","8":"-3.4495172","9":"2.883762460","10":"4.134748","11":"-0.404994731","12":"4.313929220","13":"-3.449517","14":"-3.4495172","15":"1.3946699182","16":"0.046990393","17":"-3.449517168","18":"-2.350904880","19":"3.4421087","20":"1.843787656","21":"-3.44951717","22":"-0.19732666","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-3.06954943","2":"2.9093363","3":"-3.069549","4":"3.622534313","5":"-3.0695494","6":"6.453482650","7":"0.955802261","8":"-3.0695494","9":"2.277558101","10":"4.695595","11":"-3.069549430","12":"1.057584955","13":"-3.069549","14":"-3.0695494","15":"1.9738756873","16":"0.149326395","17":"-3.069549430","18":"-1.683255069","19":"4.4550118","20":"0.759091967","21":"-3.06954943","22":"-0.35304902","23":"-0.618508245","24":"bact_pred","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-0.99230165","2":"2.9375613","3":"-3.294887","4":"2.374994179","5":"-3.2948867","6":"6.292587846","7":"0.694097302","8":"-3.2948867","9":"2.591217287","10":"4.462592","11":"-0.655829415","12":"3.968442873","13":"-3.294887","14":"-3.2948867","15":"1.2484080381","16":"-0.404514986","17":"-3.294886744","18":"-3.294886744","19":"3.0936747","20":"0.748164524","21":"-3.29488674","22":"-0.35304902","23":"-0.618508245","24":"bact_pred","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.40863856","2":"2.4492946","3":"-3.408639","4":"3.153805535","5":"-3.4086386","6":"5.936582296","7":"0.503384447","8":"-3.4086386","9":"3.160842862","10":"4.276605","11":"0.561653355","12":"4.921984062","13":"-3.408639","14":"-3.4086386","15":"1.0457087376","16":"-0.112801693","17":"-2.715491378","18":"-3.408638559","19":"2.6363668","20":"1.451173846","21":"-3.40863856","22":"-0.32190455","23":"-0.618508245","24":"bact_pred","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-0.78745551","2":"2.6854661","3":"-3.352405","4":"4.467231440","5":"-3.3524049","6":"6.358165194","7":"0.741939700","8":"-3.3524049","9":"2.173048077","10":"4.419927","11":"-1.272963321","12":"1.169383714","13":"-3.352405","14":"-2.6592577","15":"1.0902463939","16":"-0.216910647","17":"-3.352404863","18":"-3.352404863","19":"4.4760315","20":"0.821982407","21":"-3.35240486","22":"-0.29076008","23":"-0.618508245","24":"bact_pred","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.26057130","2":"2.7457819","3":"-3.260571","4":"2.541547079","5":"-3.2605713","6":"6.149766817","7":"-0.002474759","8":"-3.2605713","9":"3.052976750","10":"4.458559","11":"-0.862676024","12":"3.420283382","13":"-3.260571","14":"-0.3701995","15":"0.8169661472","16":"0.140626085","17":"-3.260571297","18":"-3.260571297","19":"3.2286336","20":"0.764780394","21":"-3.26057130","22":"0.05182910","23":"-0.618508245","24":"bact_pred","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.31567329","2":"2.2177162","3":"-3.315673","4":"3.038696748","5":"-3.3156733","6":"5.601101063","7":"-0.224630840","8":"-3.3156733","9":"2.830655965","10":"3.792571","11":"0.016531217","12":"4.060208855","13":"-3.315673","14":"-0.6766160","15":"0.9328219490","16":"-0.543084571","17":"-3.315673293","18":"-1.523913824","19":"2.4924692","20":"1.195186213","21":"-3.31567329","22":"-0.47762690","23":"-0.618508245","24":"bact_pred","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-1.41072272","2":"2.0683171","3":"-3.356633","4":"3.536008768","5":"-3.3566329","6":"6.082912642","7":"1.430858870","8":"-3.3566329","9":"1.858302884","10":"4.884807","11":"0.381036745","12":"0.280953287","13":"-3.356633","14":"-3.3566329","15":"1.2780961151","16":"0.010662957","17":"-2.258020584","18":"-1.159408296","19":"4.1147302","20":"-0.958737600","21":"-3.35663287","22":"-0.22847113","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.17429621","2":"2.3630333","3":"-3.253738","4":"3.408116984","5":"-3.2537378","6":"6.257447674","7":"0.873396628","8":"-3.2537378","9":"1.763542080","10":"4.078631","11":"0.211998146","12":"0.596409845","13":"-3.253738","14":"-3.2537378","15":"1.5084361782","16":"-0.420524413","17":"-3.253737757","18":"-1.307827608","19":"4.3161899","20":"0.301610305","21":"-3.25373776","22":"-0.07274878","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-2.04964376","2":"2.2270224","3":"-3.435938","4":"2.725269205","5":"-3.4359381","6":"6.336529173","7":"0.534353797","8":"-3.4359381","9":"2.274488901","10":"4.468766","11":"0.348251517","12":"3.374204333","13":"-3.435938","14":"-3.4359381","15":"1.0184091796","16":"-0.177841579","17":"-3.435938117","18":"-1.826500204","19":"3.7124076","20":"1.085850460","21":"-3.43593812","22":"-0.07274878","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.42703850","2":"1.9934965","3":"-3.427039","4":"3.174191615","5":"-3.4270385","6":"5.837411194","7":"0.683835360","8":"-3.4270385","9":"2.486464502","10":"4.315364","11":"-0.025841122","12":"4.258664557","13":"-3.427039","14":"-3.4270385","15":"1.2076904844","16":"0.099322021","17":"-3.427038504","18":"-1.347596962","19":"3.0186813","20":"1.714625053","21":"-3.42703850","22":"0.02068463","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-1.44701325","2":"0.6530476","3":"-2.545626","4":"2.310303367","5":"-2.1401604","6":"6.363474597","7":"0.750211328","8":"-2.5456255","9":"2.084237261","10":"4.749431","11":"-0.103278502","12":"3.777836966","13":"-3.238773","14":"-3.2387727","15":"0.6732502872","16":"-1.292862569","17":"-3.238772718","18":"-3.238772718","19":"3.0891641","20":"1.817473087","21":"-3.23877272","22":"0.08297357","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-0.62517793","2":"1.9949035","3":"-3.569617","4":"3.552442968","5":"-3.5696169","6":"6.132488580","7":"0.191583202","8":"-3.5696169","9":"2.273927504","10":"4.272662","11":"0.119262541","12":"4.306262246","13":"-3.569617","14":"-3.5696169","15":"1.1488819580","16":"-0.237412403","17":"-2.876469733","18":"-2.876469733","19":"2.6268272","20":"1.413989708","21":"-3.56961691","22":"-0.13503772","23":"-0.618508245","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-0.98430194","2":"1.7170593","3":"-3.286887","4":"4.603695498","5":"-3.2868870","6":"6.422651622","7":"1.308232813","8":"-3.2868870","9":"2.266072548","10":"3.744854","11":"-3.286887037","12":"0.756164231","13":"-3.286887","14":"-3.2868870","15":"1.6330938888","16":"-0.151392821","17":"-3.286887037","18":"0.147100167","19":"4.3575537","20":"0.474313079","21":"-3.28688704","22":"3.72687662","23":"-0.060636232","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-0.92872565","2":"2.0475885","3":"-3.493675","4":"4.509019159","5":"-3.4936750","6":"6.086434212","7":"0.633459382","8":"-3.4936750","9":"1.038924490","10":"3.397951","11":"-0.197838137","12":"1.251257125","13":"-3.493675","14":"-3.4936750","15":"2.0034932220","16":"-0.197838137","17":"-3.493675003","18":"0.169886643","19":"4.1654964","20":"0.476616910","21":"-3.49367500","22":"-0.66449372","23":"-0.314202667","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-1.50610468","2":"2.5012285","3":"-3.452015","4":"2.711299971","5":"-3.4520148","6":"5.962816202","7":"0.810665044","8":"-3.4520148","9":"2.544437256","10":"4.976784","11":"-0.407492395","12":"1.597841175","13":"-3.452015","14":"-3.4520148","15":"1.7683409924","16":"1.112333359","17":"-3.452014833","18":"-3.452014833","19":"4.4526891","20":"1.091279950","21":"-3.45201483","22":"-1.44310548","23":"2.221397056","24":"bact_pred","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"0.11558600","2":"2.6593332","3":"-3.380922","4":"3.769779901","5":"-3.3809216","6":"6.280685499","7":"0.145438968","8":"-3.3809216","9":"3.252396877","10":"4.702407","11":"-3.380921557","12":"1.193789422","13":"-3.380922","14":"-3.3809216","15":"2.0913491169","16":"0.823771063","17":"-3.380921557","18":"-3.380921557","19":"3.8546976","20":"1.539059369","21":"-3.38092156","22":"-1.44310548","23":"0.978966765","24":"bact_pred","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.28482078","2":"2.1399071","3":"-3.923878","4":"2.977859092","5":"-3.9238781","6":"5.482604533","7":"0.758253113","8":"-3.9238781","9":"2.500990909","10":"4.531014","11":"-0.312960202","12":"3.453255598","13":"-3.923878","14":"-3.9238781","15":"1.9196663026","16":"1.151295701","17":"-3.230730934","18":"-0.928145841","19":"3.8901176","20":"0.494962493","21":"-3.92387811","22":"-1.31852760","23":"1.562176031","24":"bact_pred","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.48069339","2":"2.8434393","3":"-3.560135","4":"4.464072551","5":"-3.5601349","6":"5.869019630","7":"1.074594053","8":"-3.5601349","9":"2.294936987","10":"4.115875","11":"-2.866987755","12":"3.378149549","13":"-3.560135","14":"-3.5601349","15":"1.2840521512","16":"0.050782977","17":"-3.560134935","18":"-0.004786874","19":"3.0519061","20":"0.846584312","21":"-3.56013494","22":"-1.00708290","23":"0.801476723","24":"bact_pred","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.00668123","2":"2.2568948","3":"-3.645739","4":"3.129627536","5":"-3.6457386","6":"5.627952133","7":"0.886860938","8":"-3.6457386","9":"2.335675656","10":"4.732193","11":"-0.062219616","12":"1.090459893","13":"-3.645739","14":"-3.6457386","15":"1.2595362235","16":"-0.008152395","17":"-2.952591374","18":"-0.313534045","19":"4.5738569","20":"0.324553359","21":"-3.64573855","22":"-1.19394972","23":"1.917156114","24":"bact_pred","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-0.39899535","2":"2.8494393","3":"-3.577049","4":"4.469820334","5":"-3.5770492","6":"5.790636765","7":"1.335605708","8":"-3.5770492","9":"1.878271938","10":"4.020347","11":"0.006469761","12":"0.314771121","13":"-3.577049","14":"-3.5770492","15":"1.2592327296","16":"-0.581316904","17":"-3.577049177","18":"-0.281212311","19":"3.3889750","20":"0.987299014","21":"-3.57704918","22":"-1.44310548","23":"0.725400329","24":"bact_pred","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-0.81516593","2":"2.3234291","3":"-3.454223","4":"5.066762730","5":"-3.4542233","6":"5.852699210","7":"0.516068653","8":"-3.4542233","9":"1.451051518","10":"4.221787","11":"-0.020236056","12":"1.798050168","13":"-3.454223","14":"-3.4542233","15":"1.2731645586","16":"-0.318729044","17":"-3.454223260","18":"-0.969316610","19":"3.2839292","20":"0.516068653","21":"-3.45422326","22":"-1.47424995","23":"-0.009961726","24":"bact_pred","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-3.65182929","2":"2.1007433","3":"-3.651829","4":"1.589917722","5":"-3.6518293","6":"5.703995746","7":"1.207983111","8":"-3.6518293","9":"2.239814919","10":"5.138592","11":"-0.473775463","12":"3.593825775","13":"-3.651829","14":"-3.6518293","15":"0.6919761289","16":"0.408613718","17":"-1.012771963","18":"-0.284533463","19":"4.0761462","20":"0.582277212","21":"-3.65182929","22":"-1.16280525","23":"1.435360495","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-3.48503293","2":"1.6854511","3":"-3.485033","4":"3.537835159","5":"-3.4850329","6":"5.832007064","7":"0.252636691","8":"-3.4850329","9":"2.475972413","10":"4.530625","11":"-0.712444205","12":"3.934946997","13":"-3.485033","14":"-3.4850329","15":"0.3861680841","16":"-0.306979096","17":"-0.349538711","18":"-0.712444205","19":"3.1363727","20":"0.704621815","21":"-3.48503293","22":"-1.22509419","23":"1.638252426","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.84384260","2":"1.6008399","3":"-3.635602","4":"3.906081027","5":"-3.6356021","6":"5.849259141","7":"1.055745810","8":"-3.6356021","9":"1.231932378","10":"4.499159","11":"-0.927551872","12":"3.778368218","13":"-3.635602","14":"-3.6356021","15":"0.9695681133","16":"-0.544559619","17":"-1.237706800","18":"-0.802388729","19":"3.6948031","20":"0.583905633","21":"-3.63560207","22":"-0.75792713","23":"-0.390279062","24":"bact_pred","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-1.08214283","2":"2.3446501","3":"-3.279367","4":"4.361716840","5":"-3.2793674","6":"6.377452047","7":"0.925325210","8":"-3.2793674","9":"1.731267885","10":"5.354542","11":"0.217140152","12":"1.896782323","13":"-3.279367","14":"-3.2793674","15":"0.4095120447","16":"-3.279367409","17":"-3.279367409","18":"-2.180755121","19":"4.8150110","20":"1.064438012","21":"-3.27936741","22":"-0.22847113","23":"-0.517094598","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-0.77520787","2":"2.5978186","3":"-3.260115","4":"4.546581851","5":"-3.2601145","6":"6.304888771","7":"1.335005328","8":"-3.2601145","9":"1.615082801","10":"4.617283","11":"-0.041238697","12":"1.789741485","13":"-3.260115","14":"-3.2601145","15":"1.7897414854","16":"-3.260114522","17":"-3.260114522","18":"-3.260114522","19":"4.0852503","20":"1.476083927","21":"-3.26011452","22":"-0.57106031","23":"-0.111375373","24":"bact_pred","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"3.93174320","2":"2.1703762","3":"-3.850647","4":"0.226890304","5":"-1.7712056","6":"1.417211019","7":"-0.022005743","8":"-1.5480620","9":"0.243697422","10":"4.538485","11":"5.952854318","12":"3.080824666","13":"-2.752035","14":"-2.7520349","15":"0.1005965786","16":"-3.850647140","17":"-1.211589810","18":"-3.157499959","19":"1.4820717","20":"-0.324286615","21":"-1.90473699","22":"0.23869592","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.41341577","2":"2.3101378","3":"-3.678824","4":"0.690624218","5":"-2.2925293","6":"0.291468279","7":"-1.280928362","8":"-2.2925293","9":"0.212996663","10":"4.323201","11":"5.932639096","12":"2.480271754","13":"-3.678824","14":"-2.0693857","15":"0.7870844840","16":"-2.069385722","17":"-1.481599057","18":"-2.069385722","19":"1.2840210","20":"-0.213087732","21":"-1.59938209","22":"0.17640698","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.61998220","2":"2.4519775","3":"-3.625665","4":"-0.406788880","5":"-1.5462232","6":"-0.406788880","7":"0.037896941","8":"-1.3230796","9":"0.087907362","10":"4.169158","11":"5.964207393","12":"1.875593506","13":"-3.625665","14":"-3.6256647","15":"1.1618270378","16":"-2.932517524","17":"-1.323079612","18":"-2.527052416","19":"2.3904925","20":"0.011921455","21":"-1.42844013","22":"0.26984039","23":"-0.618508245","24":"bact_pred_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.10849712","2":"2.0887688","3":"-3.670133","4":"0.660600317","5":"-1.1051837","6":"1.373292094","7":"-0.779761265","8":"-1.0310757","9":"-0.725694044","10":"3.785165","11":"5.942667948","12":"3.946642785","13":"-3.670133","14":"-3.6701330","15":"0.6065330958","16":"-2.060695111","17":"-1.105183666","18":"-2.976985843","19":"1.5977251","20":"-1.031075694","21":"-2.28383866","22":"1.73363051","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.31197491","2":"2.2845788","3":"-3.573354","4":"-1.008404976","5":"-1.4939128","6":"-1.270769241","7":"-0.206058504","8":"-1.4939128","9":"0.487088677","10":"3.920520","11":"5.773961493","12":"2.861192185","13":"-3.573354","14":"-2.1870600","15":"0.8925537847","16":"-3.573354334","17":"-1.008404976","18":"-1.627444185","19":"0.9909939","20":"0.233308156","21":"-0.74014099","22":"0.02068463","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.10757555","2":"2.0459916","3":"-3.374543","4":"0.595748540","5":"-1.5827839","6":"-0.007247543","7":"-0.196489543","8":"-1.5827839","9":"0.454098023","10":"3.787854","11":"5.337887600","12":"1.996094655","13":"-3.374543","14":"-3.3745434","15":"0.6508083175","16":"-1.582783904","17":"-0.735486044","18":"-2.681396193","19":"1.2888957","20":"-0.007247543","21":"-1.76510546","22":"0.55014063","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.81005278","2":"1.7536512","3":"-3.818503","4":"0.525302547","5":"-2.4322085","6":"2.226502439","7":"-0.180916715","8":"-2.4322085","9":"0.415603630","10":"3.675927","11":"5.694309655","12":"2.050794038","13":"-3.818503","14":"-2.2090650","15":"0.4581632441","16":"-2.209064962","17":"-0.773980437","18":"-2.209064962","19":"2.1399218","20":"0.151789039","21":"-3.81850287","22":"1.88935286","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.09041286","2":"1.9251545","3":"-4.172920","4":"0.889675225","5":"-0.6465593","6":"0.831026498","7":"-0.062045944","8":"-0.5093582","9":"0.572012320","10":"3.378267","11":"5.181001292","12":"0.724919992","13":"-4.172920","14":"-2.7866254","15":"-0.2216760898","16":"-2.381160339","17":"-0.805623978","18":"-2.381160339","19":"2.2854185","20":"-0.129868541","21":"-1.60797045","22":"0.51899616","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.62295254","2":"2.4886850","3":"-3.659783","4":"-0.524289121","5":"-2.2734890","6":"-1.174876687","7":"0.514603933","8":"-2.2734890","9":"0.588711905","10":"4.011578","11":"5.935615333","12":"2.544774425","13":"-3.659783","14":"-2.9666362","15":"1.0036557570","16":"-1.094833980","17":"-2.273488976","18":"-1.868023868","19":"1.3374289","20":"0.077886281","21":"-1.35719824","22":"-0.07274878","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.26698070","2":"2.2907754","3":"-3.744706","4":"0.298345241","5":"-2.1352681","6":"0.187119606","7":"1.000226102","8":"-1.9529466","9":"0.946641855","10":"3.940538","11":"5.455280933","12":"1.938873741","13":"-3.744706","14":"-3.7447060","15":"0.7878934664","16":"-2.646093738","17":"-0.748973753","18":"-3.051558846","19":"2.1795498","20":"-0.081144381","21":"-1.44212093","22":"0.70586298","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.46374115","2":"2.0893053","3":"-3.892109","4":"1.306388136","5":"-2.7934966","6":"0.692858583","7":"0.133242795","8":"-2.7934966","9":"0.596527474","10":"3.902302","11":"5.626891956","12":"2.232574496","13":"-3.892109","14":"-2.7934966","15":"0.7130612907","16":"-2.505814534","17":"-1.407202246","18":"-1.946198746","19":"1.2896747","20":"-0.020907884","21":"-1.00173714","22":"-0.07274878","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"3.36216795","2":"1.9417239","3":"-4.057213","4":"3.347674943","5":"-2.4477747","6":"4.770841904","7":"0.442597038","8":"-2.4477747","9":"0.260275481","10":"3.048573","11":"1.956502524","12":"0.687719496","13":"-4.057213","14":"-3.3640655","15":"1.0116915699","16":"-1.572305983","17":"-0.165392334","18":"-1.572305983","19":"2.9256501","20":"-1.112773653","21":"-2.95860034","22":"-1.00708290","23":"0.116853810","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.27570307","2":"1.2330872","3":"-3.777548","4":"3.306678337","5":"-3.7775481","6":"4.067867951","7":"0.629171162","8":"-3.7775481","9":"0.349586300","10":"2.512167","11":"5.397372341","12":"0.299989359","13":"-3.777548","14":"-3.7775481","15":"1.1277266932","16":"-1.069497884","17":"-0.311812182","18":"-1.004959363","19":"3.2318608","20":"-1.379652812","21":"-3.77754809","22":"-0.53991584","23":"0.370420246","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.74235253","2":"1.6458785","3":"-4.188932","4":"3.099312166","5":"-4.1889322","6":"4.320833441","7":"1.009564797","8":"-4.1889322","9":"0.590191259","10":"2.805001","11":"4.492927578","12":"2.156704126","13":"-4.188932","14":"-2.8026379","15":"0.6862650886","16":"-1.791036962","17":"-0.551346075","18":"-0.787734853","19":"2.7561188","20":"-0.427732119","21":"-4.18893223","22":"-0.01045984","23":"-0.009961726","24":"bact_pred_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"3.60467828","2":"1.4094164","3":"-3.726382","4":"2.311488891","5":"-2.6277697","6":"3.336666135","7":"0.144818982","8":"-2.6277697","9":"-0.836010271","10":"2.938027","11":"5.558880270","12":"1.426909566","13":"-3.726382","14":"-3.7263820","15":"0.0112875897","16":"-1.529157451","17":"-1.241475379","18":"-1.328486756","19":"2.7428683","20":"-1.161432671","21":"-0.95379331","22":"-1.19394972","23":"-0.263528162","24":"bact_pred_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.16875404","2":"1.1146448","3":"-4.453700","4":"3.139674527","5":"-2.6619402","6":"4.684500028","7":"1.522651243","8":"-2.6619402","9":"-0.219593161","10":"1.893690","11":"1.026939257","12":"2.969868778","13":"-4.453700","14":"-3.0674053","15":"0.6761990490","16":"-0.764820212","17":"-0.692499550","18":"-1.814642336","19":"2.7969358","20":"-1.968793016","21":"-1.23482384","22":"-0.32190455","23":"1.638252426","24":"bact_pred_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"3.76192017","2":"0.9798004","3":"-3.840481","4":"2.608408227","5":"-3.8404812","6":"3.596136098","7":"0.636855647","8":"-3.8404812","9":"0.744486311","10":"1.765321","11":"5.586098979","12":"1.492237626","13":"-3.840481","14":"-3.1473340","15":"-0.1269091008","16":"-2.048721698","17":"-1.201423838","18":"-1.132430966","19":"2.8046098","20":"-1.067892445","21":"0.11076255","22":"0.92387427","23":"0.598584793","24":"bact_pred_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"4.09483205","2":"1.3517989","3":"-3.900475","4":"4.099874926","5":"-2.8018623","6":"5.082588720","7":"0.468973283","8":"-2.8018623","9":"0.704695616","10":"2.353354","11":"1.988403389","12":"0.050769149","13":"-3.900475","14":"-2.8018623","15":"1.1034717364","16":"-1.597889477","17":"-0.533178740","18":"-1.597889477","19":"3.3021866","20":"-0.764980354","21":"-3.90047457","22":"1.45333027","23":"1.333946848","24":"bact_pred_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.39867780","2":"1.6117690","3":"-3.592238","4":"2.355797322","5":"-3.5922377","6":"2.108205906","7":"0.802211487","8":"-2.8990905","9":"-0.547715230","10":"2.789578","11":"5.415986521","12":"-0.819648945","13":"-3.592238","14":"-3.5922377","15":"0.9403618259","16":"-1.289652574","17":"-0.547715230","18":"-1.512796126","19":"3.4099183","20":"-1.512796126","21":"-0.33414113","22":"-1.03822737","23":"-0.212789020","24":"bact_pred_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.07897525","2":"1.7450497","3":"-3.756209","4":"2.678338011","5":"-3.7562085","6":"5.096885328","7":"0.808139683","8":"-3.7562085","9":"1.087978578","10":"2.259949","11":"4.404023984","12":"1.014476116","13":"-3.756209","14":"-3.7562085","15":"0.8881823912","16":"-1.558983931","17":"-0.711686070","18":"-1.453623415","19":"2.8202611","20":"-0.620714292","21":"-3.75620851","22":"1.11074110","23":"0.268941963","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"4.21369476","2":"1.9489892","3":"-3.768039","4":"3.447936473","5":"-3.7680385","6":"5.289966181","7":"0.466067975","8":"-3.7680385","9":"0.494641347","10":"2.691866","11":"2.761380308","12":"0.968159918","13":"-3.768039","14":"-3.7680385","15":"1.0277520155","16":"-0.823599551","17":"-0.435834020","18":"-1.370143257","19":"2.9228037","20":"-0.995449808","21":"-3.76803853","22":"1.32875239","23":"1.612850537","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.42187400","2":"1.5154572","3":"-3.952603","4":"3.411944122","5":"-3.9526029","6":"3.872642399","7":"1.122570923","8":"-3.9526029","9":"0.662517625","10":"1.939041","11":"4.716624455","12":"0.107840119","13":"-3.952603","14":"-3.9526029","15":"0.2958923501","16":"-0.908080454","17":"-1.313545562","18":"-1.313545562","19":"2.9778919","20":"-1.554707619","21":"-0.19140278","22":"-0.66449372","23":"0.218267457","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"-1.70454249","2":"1.5535541","3":"-3.650453","4":"4.400888298","5":"-3.6504526","6":"5.746450288","7":"0.300791083","8":"-3.6504526","9":"2.726274313","10":"3.544735","11":"0.199694966","12":"3.664100197","13":"-3.650453","14":"-3.6504526","15":"0.3925986326","16":"-1.347867542","17":"0.220748376","18":"-1.571011094","19":"2.9959379","20":"0.780364164","21":"-3.65045264","22":"0.11411804","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-0.97552110","2":"1.6575661","3":"-3.460428","4":"4.549267611","5":"-3.4604277","6":"5.620828471","7":"0.431392551","8":"-3.4604277","9":"2.134283632","10":"3.533505","11":"-0.464695474","12":"3.227926967","13":"-3.460428","14":"-3.4604277","15":"0.6171096968","16":"-1.062532474","17":"-0.324933531","18":"-2.361815458","19":"3.1408024","20":"1.039381923","21":"-3.46042775","22":"0.02068463","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-3.38126742","2":"1.9220375","3":"-3.381267","4":"0.949465918","5":"-3.3812674","6":"5.141112296","7":"0.713077140","8":"-3.3812674","9":"1.817229609","10":"5.290019","11":"-0.336744984","12":"5.695312960","13":"-3.381267","14":"-1.9949731","15":"1.7307203663","16":"-1.078682329","17":"-3.381267422","18":"-2.282655133","19":"3.4065776","20":"2.696374821","21":"-3.38126742","22":"-0.16618219","23":"-0.618508245","24":"bact_pred_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.23165967","2":"1.0874547","3":"-3.023419","4":"0.272417725","5":"-3.0234191","6":"6.101363342","7":"2.152730591","8":"-3.0234191","9":"1.788765214","10":"5.819907","11":"0.021103296","12":"4.825514585","13":"-3.023419","14":"-2.3302720","15":"1.6587120858","16":"-2.330271961","17":"-3.023419141","18":"-1.924806853","19":"2.9503905","20":"-0.720834048","21":"-3.02341914","22":"2.04507521","23":"-0.618508245","24":"bact_pred_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.52975747","2":"2.4936901","3":"-3.529757","4":"2.446593438","5":"-3.5297575","6":"6.345176273","7":"0.912893785","8":"-3.5297575","9":"2.692818796","10":"4.892465","11":"-2.431145183","12":"5.227239712","13":"-3.529757","14":"-3.5297575","15":"1.5391467306","16":"0.689750234","17":"-2.836610291","18":"-2.431145183","19":"3.3839799","20":"1.783448507","21":"-3.52975747","22":"-0.41533796","23":"-0.618508245","24":"bact_pred_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-1.07408900","2":"2.1711041","3":"-3.558996","4":"1.788111882","5":"-3.5589956","6":"3.632433681","7":"0.784809773","8":"-3.5589956","9":"2.209325347","10":"4.588293","11":"-0.514473211","12":"5.720217587","13":"-3.558996","14":"-3.5589956","15":"0.0785905108","16":"-0.563263375","17":"-0.263158783","18":"-2.460383360","19":"2.6230893","20":"2.633366841","21":"-3.55899565","22":"-0.07274878","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.57811989","2":"1.8396068","3":"-3.880705","4":"2.852696906","5":"-3.8807050","6":"4.883348283","7":"0.662589796","8":"-3.8807050","9":"2.056831219","10":"4.360471","11":"-0.479507604","12":"5.285369970","13":"-3.880705","14":"-3.8807050","15":"0.2936822838","16":"-0.325356925","17":"-0.191825532","18":"-1.801263444","19":"3.1368012","20":"2.288905746","21":"-3.88070499","22":"0.20755145","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-0.97153704","2":"0.9648037","3":"-3.679587","4":"4.444859612","5":"-3.6795872","6":"5.232751323","7":"0.993241591","8":"-3.6795872","9":"1.116203302","10":"4.860932","11":"-0.213851341","12":"1.408009091","13":"-3.679587","14":"-3.6795872","15":"1.0299429574","16":"-0.735148265","17":"-0.635064806","18":"-1.887827775","19":"4.0120696","20":"2.458139810","21":"-3.67958724","22":"0.70586298","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.85344746","2":"1.5997097","3":"-3.462885","4":"4.722464846","5":"-3.4628854","6":"5.894926274","7":"0.274784241","8":"-3.4628854","9":"1.992435738","10":"3.866208","11":"-1.383443835","12":"2.598571542","13":"-3.462885","14":"-3.4628854","15":"0.1206335615","16":"-1.064990104","17":"0.225994077","18":"-1.265660800","19":"3.4685864","20":"1.580539740","21":"-3.46288538","22":"-0.07274878","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.89342535","2":"2.3290192","3":"-3.502863","4":"5.130333602","5":"-3.5028633","6":"5.875192511","7":"0.303799224","8":"-3.5028633","9":"2.334867182","10":"3.897146","11":"-3.502863265","12":"3.208877130","13":"-3.502863","14":"-3.5028633","15":"1.2156356060","16":"-1.200278172","17":"-0.324809435","18":"-2.404250977","19":"3.7247992","20":"2.323136842","21":"-3.50286327","22":"0.26984039","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-2.12643269","2":"1.7905779","3":"-3.512727","4":"1.249446881","5":"-3.5127271","6":"5.012632701","7":"0.476256993","8":"-3.5127271","9":"2.067002773","10":"5.049057","11":"-0.740138331","12":"5.475843823","13":"-3.512727","14":"-3.5127271","15":"0.6461560300","16":"-1.720967584","17":"0.893992194","18":"-1.315502476","19":"3.1126653","20":"1.205771818","21":"-3.51272705","22":"0.17640698","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.42689922","2":"2.4423977","3":"-3.426899","4":"2.129928840","5":"-3.4268992","6":"5.834039203","7":"0.616152046","8":"-3.4268992","9":"3.206419212","10":"4.444412","11":"-3.426899221","12":"5.406271912","13":"-3.426899","14":"-3.4268992","15":"1.1882212954","16":"-0.941992572","17":"0.543392692","18":"-1.124314128","19":"2.0865295","20":"1.583736073","21":"-3.42689922","22":"-0.19732666","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-1.95209066","2":"1.7165861","3":"-3.561529","4":"2.168571211","5":"-3.5615286","6":"5.652604599","7":"0.245133918","8":"-3.5615286","9":"2.197373202","10":"5.024817","11":"-0.265691706","12":"5.002739027","13":"-3.561529","14":"-3.5615286","15":"0.8573120362","16":"-2.175234210","17":"-0.565796298","18":"-2.462916283","19":"3.6208235","20":"2.304939485","21":"-3.56152857","22":"0.36327380","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.58296652","2":"1.8617160","3":"-3.374726","4":"2.491742067","5":"-3.3747260","6":"5.690010408","7":"0.453915407","8":"-3.3747260","9":"2.629161077","10":"3.932476","11":"-1.177501413","12":"4.959745565","13":"-3.374726","14":"-1.5829665","15":"0.4539154066","16":"-1.072140897","17":"-0.330203552","18":"-3.374725990","19":"1.6491545","20":"1.872298082","21":"-3.37472599","22":"-0.19732666","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.67871227","2":"3.2586018","3":"-3.678712","4":"1.583977915","5":"-3.6787123","6":"3.335203201","7":"0.703314360","8":"-3.6787123","9":"3.114753858","10":"4.752487","11":"-0.420615736","12":"6.092214843","13":"-3.678712","14":"-1.1938056","15":"0.5407954310","16":"-0.970662073","17":"0.010167180","18":"-2.580099986","19":"1.8934418","20":"1.952499508","21":"-3.67871227","22":"0.14526251","23":"-0.618508245","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-1.52615846","2":"1.4942664","3":"-3.317918","4":"5.191847746","5":"-3.3179179","6":"5.475087162","7":"0.443282187","8":"-3.3179179","9":"1.112898870","10":"2.832685","11":"2.437824284","12":"1.124733327","13":"-3.317918","14":"-3.3179179","15":"1.1818917411","16":"-1.708480017","17":"-0.678860600","18":"0.014286581","19":"3.3452148","20":"-0.833011279","21":"-3.31791793","22":"3.91374344","23":"0.623986682","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-2.19062806","2":"1.6380133","3":"-3.576922","4":"4.168080386","5":"-3.5769224","6":"5.493581009","7":"0.612732324","8":"-3.5769224","9":"0.517422145","10":"3.304489","11":"4.807424861","12":"2.079069393","13":"-3.576922","14":"-3.5769224","15":"0.8889857011","16":"-2.190628056","17":"-0.532399980","18":"0.160747201","19":"3.2858355","20":"-0.581190144","21":"-3.57692242","22":"-1.13166078","23":"-0.238190909","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-1.20666962","2":"1.7155955","3":"-3.691576","4":"2.627391843","5":"-3.6915763","6":"6.100420906","7":"0.715142976","8":"-3.6915763","9":"1.957397967","10":"3.546202","11":"-0.359371761","12":"4.261390520","13":"-3.691576","14":"-3.6915763","15":"1.2428976624","16":"-3.691576271","17":"-0.433479733","18":"0.137065126","19":"4.1106330","20":"1.426417542","21":"-3.69157627","22":"-1.25623866","23":"0.218267457","24":"bact_pred_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.91392566","2":"1.8379286","3":"-3.523364","4":"2.791994427","5":"-3.5233636","6":"5.824562460","7":"0.794124539","8":"-3.5233636","9":"2.166995880","10":"3.419759","11":"-0.750774852","12":"4.205052205","13":"-3.523364","14":"-3.5233636","15":"1.1861666268","16":"-3.523363575","17":"-0.815313373","18":"0.820441847","19":"3.9755062","20":"1.121027325","21":"-3.52336357","22":"-1.10051631","23":"0.319681104","24":"bact_pred_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-3.54551105","2":"2.2102312","3":"-3.545511","4":"2.482767468","5":"-3.5455111","6":"6.073156993","7":"0.731155067","8":"-3.5455111","9":"1.607780542","10":"3.643657","11":"0.628876218","12":"4.566117026","13":"-3.545511","14":"-3.5455111","15":"1.9434266738","16":"-3.545511052","17":"-0.980561695","18":"0.717168825","19":"3.7008570","20":"1.039456426","21":"-3.54551105","22":"-1.31852760","23":"-0.288865415","24":"bact_pred_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-0.15040046","2":"0.7284639","3":"-4.042221","4":"0.191885750","5":"-4.0422208","6":"4.744235924","7":"1.314365520","8":"-4.0422208","9":"2.866534025","10":"2.282138","11":"0.621218339","12":"4.136137411","13":"-4.042221","14":"-4.0422208","15":"1.4258393863","16":"0.934512988","17":"1.563581311","18":"-0.090977036","19":"3.8778624","20":"-0.192073153","21":"-4.04222075","22":"-1.47424995","23":"2.145385298","24":"bact_pred_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.00281247","2":"1.1327185","3":"-3.567762","4":"2.398384916","5":"-3.5677618","6":"5.662871252","7":"1.449518013","8":"-3.5677618","9":"1.415844798","10":"3.757387","11":"-0.432267607","12":"4.382388064","13":"-3.567762","14":"-3.5677618","15":"0.8266873313","16":"-0.677390066","17":"-0.389707993","18":"-1.621851674","19":"3.4978515","20":"1.006949155","21":"-3.56776182","22":"2.32537545","23":"0.801476723","24":"bact_pred_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.43164844","2":"1.9070286","3":"-3.829544","4":"2.372991809","5":"-3.8295437","6":"5.695242374","7":"1.433146481","8":"-3.8295437","9":"1.453660021","10":"3.543831","11":"-0.885104729","12":"4.710975309","13":"-3.829544","14":"-3.8295437","15":"1.3799424449","16":"-0.363807805","17":"-0.571447170","18":"-0.246024769","19":"2.9717393","20":"1.006738199","21":"-3.82954371","22":"-0.91364949","23":"0.116853810","24":"bact_pred_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-0.52412208","2":"1.6427314","3":"-3.782219","4":"4.288374920","5":"-3.7822186","6":"5.740154915","7":"0.574490207","8":"-3.7822186","9":"1.954353677","10":"3.021287","11":"0.612230535","12":"1.564888911","13":"-3.782219","14":"-3.7822186","15":"1.4542233427","16":"-0.949005276","17":"-0.414922790","18":"-0.171300707","19":"3.8979570","20":"0.001971014","21":"-3.78221862","22":"1.29760792","23":"0.522508399","24":"bact_pred_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.71614651","2":"1.2282925","3":"-3.662057","4":"4.714954504","5":"-3.6620567","6":"5.495093887","7":"1.117066837","8":"-3.6620567","9":"1.847331680","10":"3.758522","11":"-0.443180832","12":"2.262199141","13":"-3.662057","14":"-2.9689095","15":"1.1001172782","16":"-1.359471564","17":"-0.078537718","18":"-0.771684899","19":"3.4559595","20":"0.668676684","21":"-3.66205666","22":"2.29423098","23":"0.015375527","24":"bact_pred_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"0.18316458","2":"1.8239250","3":"-3.601025","4":"4.124304982","5":"-3.6010251","6":"5.981499370","7":"1.090322827","8":"-3.6010251","9":"1.251005208","10":"3.561372","11":"0.876311759","12":"3.030976722","13":"-3.601025","14":"-3.6010251","15":"1.4927251452","16":"-2.907877875","17":"-3.601025056","18":"0.526109329","19":"3.8623380","20":"0.310997950","21":"-3.60102506","22":"-0.78907160","23":"0.471833893","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-3.10805540","2":"1.9545396","3":"-3.108055","4":"4.212471563","5":"-3.1080554","6":"6.300151741","7":"1.671068094","8":"-3.1080554","9":"1.960848803","10":"3.563978","11":"-3.108055399","12":"3.741010884","13":"-3.108055","14":"-3.1080554","15":"1.4245440943","16":"-3.108055399","17":"-3.108055399","18":"1.182404042","19":"4.0504586","20":"1.019078986","21":"-3.10805540","22":"0.45670722","23":"0.091451921","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-0.49277152","2":"1.9570438","3":"-3.860067","4":"3.251444765","5":"-3.8600674","6":"6.172560718","7":"1.501224815","8":"-3.8600674","9":"1.472651442","10":"3.841585","11":"0.693809540","12":"4.337196020","13":"-3.860067","14":"-3.8600674","15":"1.8336647877","16":"-3.860067351","17":"-3.860067351","18":"1.067186334","19":"3.7967427","20":"1.448200346","21":"-3.86006735","22":"0.64357404","23":"-0.162114515","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-0.25436900","2":"1.7183884","3":"-3.298891","4":"3.777762382","5":"-3.2988914","6":"6.165703485","7":"1.095557722","8":"-3.2988914","9":"2.009376264","10":"3.394432","11":"-3.298891433","12":"3.239248391","13":"-3.298891","14":"-3.2988914","15":"1.1078278142","16":"-3.298891433","17":"-0.408519675","18":"-0.080015608","19":"3.8470930","20":"0.778646011","21":"-3.29889143","22":"4.00717685","23":"0.700063076","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-0.29936568","2":"1.8531010","3":"-3.795873","4":"2.567154863","5":"-3.7958732","6":"6.146883101","7":"0.778837738","8":"-3.7958732","9":"1.705384970","10":"3.732996","11":"0.940325208","12":"4.018526394","13":"-3.795873","14":"-3.7958732","15":"1.3340254747","16":"-3.102726060","17":"-1.023284518","18":"-0.269512716","19":"3.3445798","20":"1.048313846","21":"-3.79587324","22":"-0.22847113","23":"-0.162114515","24":"bact_pred_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"4.36482446","2":"2.5144467","3":"-3.594801","4":"2.157771794","5":"-3.5948008","6":"1.688402884","7":"-0.550278407","8":"-3.5948008","9":"0.337024788","10":"4.163105","11":"5.690090258","12":"2.358442489","13":"-3.594801","14":"-2.2085065","15":"0.8360159537","16":"-1.803041376","17":"-1.029851488","18":"-3.594800845","19":"1.7035165","20":"-0.039452784","21":"-2.20850648","22":"0.20755145","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.40513694","2":"2.5736861","3":"-3.701076","4":"0.306257226","5":"-3.7010760","6":"2.958217960","7":"-0.012196506","8":"-3.7010760","9":"-0.145727898","10":"3.500095","11":"5.572802433","12":"2.130806518","13":"-3.701076","14":"-1.5038514","15":"1.0084542417","16":"-2.602463671","17":"-0.928487237","18":"-1.398490867","19":"2.6286449","20":"0.012496107","21":"-3.70107596","22":"0.30098486","23":"-0.618508245","24":"bact_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.60840337","2":"2.9998597","3":"-3.796964","4":"2.140572204","5":"-3.7969640","6":"0.074237010","7":"0.465715876","8":"-3.7969640","9":"0.767384190","10":"3.828631","11":"5.676278952","12":"1.100875799","13":"-3.796964","14":"-2.4106696","15":"0.5850626333","16":"-1.851053852","17":"-0.963750657","18":"-2.187526089","19":"2.7382773","20":"0.313909863","21":"-2.69835171","22":"0.26984039","23":"-0.618508245","24":"bact_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"3.41770745","2":"2.0794598","3":"-4.000473","4":"-0.129272367","5":"-2.9018611","6":"4.643352465","7":"-0.909430924","8":"-2.9018611","9":"0.381553257","10":"3.747555","11":"5.340544318","12":"4.106945434","13":"-4.000473","14":"-2.9018611","15":"1.0429517392","16":"-2.208713908","17":"-1.110101620","18":"-1.697888285","19":"2.2892422","20":"-0.286901311","21":"-4.00047338","22":"0.89272980","23":"-0.618508245","24":"bact_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.47534098","2":"2.6214936","3":"-3.686605","4":"-0.160244295","5":"-3.6866048","6":"2.431492379","7":"-0.160244295","8":"-3.6866048","9":"0.002274635","10":"3.902225","11":"5.859922034","12":"3.147503919","13":"-3.686605","14":"-2.0771669","15":"1.1174162253","16":"-1.740694670","17":"-1.047547490","18":"-2.077166907","19":"2.3910374","20":"-0.252617615","21":"-3.68660482","22":"-0.10389325","23":"-0.618508245","24":"bact_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"3.93618473","2":"2.5097681","3":"-3.934363","4":"0.176510750","5":"-3.9343631","6":"4.318343563","7":"-0.468627211","8":"-3.9343631","9":"0.447663521","10":"3.938473","11":"5.592829708","12":"3.930824840","13":"-3.934363","14":"-2.1426036","15":"0.7661172520","16":"-1.631778021","17":"-0.938630840","18":"-1.988452965","19":"2.0240616","20":"-0.798868898","21":"-3.93436311","22":"1.35989686","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.45870391","2":"2.9190826","3":"-3.623389","4":"-0.678950384","5":"-3.6233894","6":"1.639300826","7":"0.065490091","8":"-3.6233894","9":"0.065490091","10":"4.076453","11":"5.834904239","12":"2.972391151","13":"-3.623389","14":"-2.5247771","15":"1.3110845698","16":"-1.543947822","17":"-0.850800641","18":"-2.013951451","19":"2.4263441","20":"-0.039870425","21":"-3.62338936","22":"0.20755145","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.61721997","2":"3.0144456","3":"-3.945902","4":"-0.390554093","5":"-1.8664606","6":"1.263583998","7":"0.061431031","8":"-1.8664606","9":"0.097149113","10":"3.779428","11":"5.646771162","12":"2.180967030","13":"-3.945902","14":"-3.9459022","15":"0.7725967168","16":"-2.559607793","17":"-0.950169881","18":"-2.154142685","19":"2.5820558","20":"-0.054081856","21":"-2.33646424","22":"0.64357404","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"4.21892090","2":"2.4731677","3":"-3.847601","4":"2.590151062","5":"-3.8476006","6":"2.881028025","7":"-0.803078150","8":"-3.8476006","9":"0.371907117","10":"4.153084","11":"5.712198755","12":"2.764440447","13":"-3.847601","14":"-2.4613062","15":"0.6956941943","16":"-1.768159046","17":"-0.957228830","18":"-2.238162676","19":"1.8153599","20":"-0.210014428","21":"-3.84760059","22":"0.05182910","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.28363447","2":"2.5144333","3":"-3.985354","4":"2.925397049","5":"-3.9853537","6":"2.254922107","7":"-0.374435826","8":"-3.9853537","9":"1.051598864","10":"3.784869","11":"5.517730871","12":"2.062018440","13":"-3.985354","14":"-2.3759158","15":"0.3321343749","16":"-1.682768646","17":"-1.420404381","18":"-2.599059378","19":"1.6565533","20":"-0.201164105","21":"-1.78812916","22":"0.61242957","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"3.47904248","2":"2.4557689","3":"-4.244962","4":"1.731388734","5":"-4.2449622","6":"4.317777831","7":"-0.843764794","8":"-4.2449622","9":"0.689511758","10":"3.915270","11":"5.532395100","12":"3.947331556","13":"-3.551815","14":"-1.6059048","15":"0.5753193901","16":"-2.858667814","17":"-0.332939170","18":"-2.299052026","19":"2.0127054","20":"-0.184519165","21":"-4.24496218","22":"0.48785169","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"0","33":"0","34":"0"},{"1":"4.29999130","2":"2.6450103","3":"-3.848744","4":"2.978885727","5":"-3.8487435","6":"2.885848152","7":"-0.211157348","8":"-3.8487435","9":"0.310139576","10":"3.986440","11":"5.798883585","12":"2.838365100","13":"-3.848744","14":"-2.4624491","15":"0.5820732910","16":"-2.462449147","17":"-1.140693307","18":"-2.239305595","19":"1.6193166","20":"-0.185181862","21":"-3.84874351","22":"0.14526251","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"0","33":"0","34":"0"},{"1":"4.37426646","2":"2.7167663","3":"-3.661660","4":"3.171371827","5":"-3.6616599","6":"2.314691004","7":"-0.165152344","8":"-3.6616599","9":"0.757180702","10":"3.774368","11":"5.532551084","12":"2.164340202","13":"-3.661660","14":"-2.5630476","15":"0.5430327137","16":"-1.582218364","17":"-1.096710548","18":"-3.661659906","19":"2.1066611","20":"-0.078140967","21":"-3.66165991","22":"0.36327380","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"0","34":"0"},{"1":"3.75220509","2":"1.5495604","3":"-3.665375","4":"3.224215997","5":"-3.6653753","6":"3.398528651","7":"0.377675957","8":"-3.6653753","9":"0.184772291","10":"2.234522","11":"6.123374564","12":"-0.832161967","13":"-3.665375","14":"-3.6653753","15":"0.0958248048","16":"-1.362790218","17":"-1.026317981","18":"-1.180468661","19":"2.4788103","20":"-0.832161967","21":"0.14128718","22":"-0.22847113","23":"-0.086038120","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"4.57962962","2":"1.3386411","3":"-3.934358","4":"3.861288091","5":"-3.9343584","6":"5.093980319","7":"1.189605534","8":"-3.9343584","9":"0.342307674","10":"2.062094","11":"4.230436359","12":"-0.084210843","13":"-3.934358","14":"-3.9343584","15":"1.1154975622","16":"-0.938626171","17":"-0.715482620","18":"-0.676261907","19":"2.2497904","20":"-0.042538147","21":"-3.93435845","22":"0.08297357","23":"0.268941963","24":"bact_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"4.16539483","2":"1.0795442","3":"-3.983051","4":"3.085121167","5":"-2.5967565","6":"4.078751441","7":"0.160083893","8":"-2.5967565","9":"-0.132903232","10":"2.066683","11":"5.321144114","12":"-1.210462112","13":"-3.289904","14":"-2.5967565","15":"0.8044409090","16":"-1.585155561","17":"-1.275000633","18":"-1.785826256","19":"1.9331512","20":"-1.092679076","21":"-0.54906363","22":"-0.85136054","23":"-0.517094598","24":"bact_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.18676824","2":"1.7660941","3":"-4.128309","4":"3.313597962","5":"-4.1283088","6":"4.080999646","7":"0.977636708","8":"-4.1283088","9":"0.061345976","10":"2.415603","11":"3.271089318","12":"1.269853936","13":"-4.128309","14":"-3.4351616","15":"0.9405954366","16":"-1.563359408","17":"-0.236488468","18":"-1.825723673","19":"3.4785758","20":"-1.643402116","21":"-0.54478983","22":"0.30098486","23":"1.207195948","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.22781331","2":"1.3173457","3":"-4.243336","4":"3.330709061","5":"-4.2433359","6":"4.230323245","7":"0.856530483","8":"-4.2433359","9":"0.624198506","10":"2.225914","11":"4.364063515","12":"-0.632418032","13":"-4.243336","14":"-3.5501888","15":"0.6394659782","16":"-1.604278615","17":"-0.659817006","18":"-1.065282114","19":"3.3749152","20":"-0.505666326","21":"-0.20028468","22":"0.30098486","23":"0.218267457","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"1","33":"0","34":"0"},{"1":"4.04548081","2":"1.0640968","3":"-4.123289","4":"3.365563939","5":"-2.7369947","6":"4.386678130","7":"0.647395608","8":"-3.0246767","9":"-0.567940955","10":"2.462883","11":"4.342821384","12":"-0.755993187","13":"-4.123289","14":"-4.1232890","15":"0.6642027261","16":"-2.043847475","17":"-1.032246563","18":"-1.032246563","19":"3.5100806","20":"-0.791084507","21":"-0.13430497","22":"-1.19394972","23":"-0.466355456","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.13776232","2":"1.7275792","3":"-4.199347","4":"3.888600749","5":"-4.1993468","6":"3.991007598","7":"0.289289564","8":"-4.1993468","9":"0.482784421","10":"2.867120","11":"1.972353791","12":"1.166629209","13":"-4.199347","14":"-4.1993468","15":"1.2122992459","16":"-0.485774739","17":"-0.615827868","18":"-1.254907827","19":"3.1218418","20":"-1.154824368","21":"-0.34919920","22":"-0.04160431","23":"1.486099637","24":"bact_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"3.84030343","2":"1.3748149","3":"-3.387359","4":"2.633664285","5":"-2.2887468","6":"3.280869184","7":"0.373841052","8":"-3.3873591","9":"-1.084773971","10":"2.464843","11":"5.883700043","12":"-1.307917522","13":"-2.694212","14":"-3.3873591","15":"0.2762025820","16":"-1.595599595","17":"-1.307917522","18":"-1.777921152","19":"3.1420598","20":"-0.496987306","21":"-0.55414572","22":"0.05182910","23":"-0.390279062","24":"bact_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"4.27120923","2":"1.8826019","3":"-3.804373","4":"3.875802229","5":"-3.8043734","6":"4.720589518","7":"0.966311213","8":"-3.8043734","9":"0.087446887","10":"2.746707","11":"0.770337567","12":"1.130100522","13":"-3.804373","14":"-3.8043734","15":"1.3136204012","16":"-0.403176030","17":"-0.668879195","18":"-1.406478138","19":"3.2500762","20":"-1.096323210","21":"-2.41807905","22":"0.95501874","23":"0.700063076","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"1","33":"0","34":"0"},{"1":"4.30959687","2":"2.0523453","3":"-3.836533","4":"2.920399750","5":"-3.8365326","6":"2.471565802","7":"0.817427710","8":"-3.8365326","9":"-0.435335258","10":"2.898059","11":"5.827173720","12":"-1.128482439","13":"-3.836533","14":"-3.8365326","15":"0.5823079681","16":"-2.227094727","17":"-0.840800366","18":"-1.197475310","19":"3.3149528","20":"-0.370796737","21":"0.18881905","22":"0.20755145","23":"-0.491757345","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"1","33":"0","34":"0"},{"1":"5.03975455","2":"2.4100086","3":"-3.692550","4":"3.297706478","5":"-3.6925500","6":"5.265604112","7":"-0.748111044","8":"-3.6925500","9":"1.792246911","10":"4.548626","11":"-3.692550023","12":"3.645037721","13":"-3.692550","14":"-3.6925500","15":"1.0523821056","16":"-3.692550023","17":"1.174984428","18":"-1.900790554","19":"3.0503306","20":"0.912620163","21":"-3.69255002","22":"0.39441828","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"4.81085801","2":"2.0682275","3":"-3.817877","4":"3.311420990","5":"-3.8178766","6":"5.244775541","7":"-0.128997104","8":"-3.8178766","9":"1.172556028","10":"4.553134","11":"-0.080206940","12":"2.626254698","13":"-3.817877","14":"-3.8178766","15":"0.3092578265","16":"-3.817876559","17":"-0.128997104","18":"-2.431582197","19":"3.1386689","20":"2.259765685","21":"-3.81787656","22":"0.42556275","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"4.71170752","2":"2.0650851","3":"-3.642025","4":"3.514931244","5":"-3.6420251","6":"5.051303868","7":"-0.383928583","8":"-3.6420251","9":"1.320819509","10":"3.600773","11":"0.383326570","12":"1.937704705","13":"-3.642025","14":"-3.6420251","15":"0.3282667928","16":"-2.032587208","17":"0.208122481","18":"-3.642025121","19":"3.1525615","20":"1.636089538","21":"-3.64202512","22":"0.76815192","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-1.12292896","2":"1.9831514","3":"-3.607836","4":"3.900951561","5":"-3.6078356","6":"5.917972221","7":"0.220805787","8":"-3.6078356","9":"2.508056516","10":"3.483074","11":"-2.509223321","12":"4.242267936","13":"-3.607836","14":"-3.6078356","15":"1.1628490151","16":"-0.774622265","17":"0.682623832","18":"-2.509223321","19":"3.7786352","20":"0.682623832","21":"-3.60783561","22":"0.08297357","23":"-0.618508245","24":"bact_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-0.99774282","2":"2.0015545","3":"-3.636800","4":"4.836650122","5":"-3.6368001","6":"5.335156125","7":"-0.378703608","8":"-3.6368001","9":"1.946696163","10":"3.311137","11":"-1.238904873","12":"3.710499555","13":"-3.636800","14":"-1.6908900","15":"0.1008694721","16":"-1.238904873","17":"-0.545757693","18":"-1.845040677","19":"3.3101758","20":"1.567206541","21":"-3.63680015","22":"0.36327380","23":"-0.618508245","24":"bact_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-3.65634529","2":"2.0204085","3":"-3.656345","4":"3.049293808","5":"-3.6563453","6":"5.807551443","7":"0.533309455","8":"-3.6563453","9":"1.828451646","10":"3.865514","11":"-0.478291457","12":"4.614435726","13":"-3.656345","14":"-3.6563453","15":"1.2852971354","16":"-0.072826349","17":"0.350987898","18":"-2.270050926","19":"3.8491470","20":"1.211189163","21":"-3.65634529","22":"0.08297357","23":"-0.618508245","24":"bact_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-0.99555278","2":"2.3342679","3":"-3.703603","4":"2.297811893","5":"-3.7036030","6":"5.525264692","7":"0.228222648","8":"-3.7036030","9":"2.305210201","10":"3.436057","11":"0.146544617","12":"4.872990550","13":"-3.703603","14":"-3.7036030","15":"0.6658448680","16":"-0.870389640","17":"0.640202437","18":"-2.094165072","19":"3.6042698","20":"0.125038412","21":"-3.70360298","22":"-0.10389325","23":"-0.618508245","24":"bact_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-2.11725186","2":"2.5461872","3":"-3.503546","4":"0.827187121","5":"-3.5035462","6":"5.629589081","7":"-0.207709354","8":"-3.5035462","9":"2.037717325","10":"4.179857","11":"-0.613174462","12":"5.216097900","13":"-3.503546","14":"-3.5035462","15":"1.8763511338","16":"-1.894108307","17":"0.701146400","18":"-1.306321642","19":"3.4151490","20":"0.730560285","21":"-3.50354622","22":"0.05182910","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"1.16191389","2":"0.4687667","3":"-1.322993","4":"1.672739513","5":"-1.3229928","6":"3.934502612","7":"-0.629845580","8":"-1.3229928","9":"0.756448781","10":"1.672740","11":"1.935103778","12":"2.505648636","13":"-1.322993","14":"-1.3229928","15":"-1.3229927604","16":"-1.322992760","17":"-1.322992760","18":"-1.322992760","19":"1.0749025","20":"-1.322992760","21":"-1.32299276","22":"-1.97256148","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-0.72904642","2":"2.6031581","3":"-2.808488","4":"0.880391497","5":"-2.8084880","6":"6.304460069","7":"-2.808487957","8":"-2.8084880","9":"2.956703146","10":"3.800861","11":"0.880391497","12":"4.702489795","13":"-2.808488","14":"-2.8084880","15":"-2.1153407763","16":"-2.808487957","17":"-0.169430627","18":"-2.808487957","19":"4.1499604","20":"2.011793609","21":"-2.80848796","22":"0.42556275","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"-3.36284809","2":"1.9794862","3":"-3.362848","4":"3.090776912","5":"-3.3628481","6":"5.728258197","7":"-0.227353871","8":"-3.3628481","9":"2.663017887","10":"4.278716","11":"-1.060262994","12":"4.837440173","13":"-3.362848","14":"-3.3628481","15":"1.1910288047","16":"-1.283406545","17":"0.350723980","18":"-1.283406545","19":"2.3070328","20":"0.967885253","21":"-3.36284809","22":"0.11411804","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.06412241","2":"2.3066158","3":"-3.366708","4":"3.665033751","5":"-3.3667075","6":"5.663309310","7":"-0.231213292","8":"-3.3667075","9":"2.919290587","10":"4.003523","11":"-0.275665054","12":"4.804043916","13":"-3.366708","14":"-3.3667075","15":"0.0005883224","16":"-1.574948038","17":"-0.594118785","18":"-2.268095219","19":"1.4853228","20":"1.360680311","21":"-3.36670751","22":"0.02068463","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-3.37339488","2":"2.4437163","3":"-3.373395","4":"3.215531600","5":"-3.3733949","6":"4.914888168","7":"-0.377662604","8":"-3.3733949","9":"3.054710395","10":"4.063811","11":"5.719737294","12":"4.119922371","13":"-3.373395","14":"-3.3733949","15":"0.4767527243","16":"-3.373394877","17":"0.970410544","18":"-3.373394877","19":"2.4930732","20":"-0.734337548","21":"-3.37339488","22":"-0.04160431","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"0","33":"0","34":"1"},{"1":"-0.99806233","2":"2.5596638","3":"-3.482969","4":"3.403562659","5":"-3.4829690","6":"4.207317037","7":"-0.843911654","8":"-3.4829690","9":"2.795552440","10":"3.601257","11":"5.728171068","12":"3.820201067","13":"-3.482969","14":"-3.4829690","15":"-0.5385300046","16":"-2.789821803","17":"0.205910470","18":"-1.180383891","19":"1.1517600","20":"-0.224872446","21":"-3.48296898","22":"-0.13503772","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"0","33":"0","34":"1"},{"1":"-1.20187243","2":"2.5224814","3":"-3.399097","4":"4.022678782","5":"-3.3990970","6":"4.010644943","7":"-0.403364738","8":"-3.3990970","9":"2.500800342","10":"3.639687","11":"5.691445797","12":"3.717297133","13":"-3.399097","14":"-3.3990970","15":"-0.1032601453","16":"-3.399097011","17":"0.002100370","18":"-2.300484723","19":"1.4837049","20":"0.211820901","21":"-3.39909701","22":"0.02068463","23":"-0.618508245","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"0","34":"1"},{"1":"4.39498449","2":"2.1482002","3":"-3.922538","4":"2.998133994","5":"-3.9225375","6":"5.287102617","7":"0.839636425","8":"-3.9225375","9":"1.641982897","10":"3.753472","11":"-3.922537510","12":"0.822394618","13":"-3.922538","14":"-3.9225375","15":"1.5068081187","16":"-0.555241680","17":"-0.284951351","18":"0.367921931","19":"3.3123609","20":"1.224956967","21":"-3.92253751","22":"-1.13166078","23":"1.105717665","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"3.87148508","2":"2.1244558","3":"-3.818344","4":"3.203632837","5":"-3.8183436","6":"5.618574434","7":"1.218609017","8":"-3.8183436","9":"0.724951197","10":"4.151014","11":"-3.125196405","12":"0.600497022","13":"-3.818344","14":"-3.8183436","15":"1.5239906664","16":"-0.873904606","17":"-0.384356381","18":"-0.011681096","19":"3.0823871","20":"1.185602720","21":"-3.81834359","22":"-1.10051631","23":"-0.035298979","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-0.91965105","2":"2.4125535","3":"-4.097705","4":"3.882660886","5":"-4.0977049","6":"4.986164829","7":"1.263587287","8":"-4.0977049","9":"2.565427817","10":"3.071645","11":"-0.601197318","12":"1.834540308","13":"-4.097705","14":"-4.0977049","15":"1.0380935580","16":"-1.900480302","17":"0.497414971","18":"0.246100543","19":"4.5418829","20":"1.667486224","21":"-4.09770488","22":"-1.00708290","23":"3.235662800","24":"bact_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.97140203","2":"2.3571359","3":"-3.763162","4":"2.930162168","5":"-3.7631615","6":"6.095694728","7":"1.178480922","8":"-3.7631615","9":"2.878020669","10":"3.298173","11":"-1.278254850","12":"1.049022855","13":"-3.763162","14":"-3.7631615","15":"1.5598484789","16":"-0.672119047","17":"0.207130413","18":"0.456346205","19":"3.4498702","20":"1.040859544","21":"-3.76316150","22":"-1.13166078","23":"1.460697748","24":"bact_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.98736646","2":"2.8227833","3":"-4.066808","4":"3.133616895","5":"-4.0668080","6":"5.978526279","7":"1.126148853","8":"-4.0668080","9":"1.765074479","10":"4.315939","11":"0.181687244","12":"2.013125197","13":"-4.066808","14":"-4.0668080","15":"1.5715466715","16":"-0.665610616","17":"0.122846744","18":"-0.216660396","19":"2.9684606","20":"1.270730082","21":"-4.06680800","22":"-0.97593843","23":"-0.035298979","24":"bact_strep","25":"1","26":"0","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-1.12591706","2":"2.4158944","3":"-3.959130","4":"4.818887403","5":"-3.9591304","6":"4.846544538","7":"1.266616267","8":"-3.9591304","9":"2.345318396","10":"2.178597","11":"-0.462622845","12":"2.076351026","13":"-3.959130","14":"-3.9591304","15":"0.5517291002","16":"-0.130489010","17":"-0.321544247","18":"-0.245558340","19":"4.2068017","20":"1.334174418","21":"-3.95913041","22":"-0.82021607","23":"3.844273955","24":"bact_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-0.87975330","2":"1.9758323","3":"-3.444703","4":"4.678558658","5":"-3.4447027","6":"5.917328224","7":"0.949746494","8":"-3.4447027","9":"1.430494662","10":"2.743561","11":"-0.148865795","12":"1.119645530","13":"-3.444703","14":"-3.4447027","15":"0.7599899584","16":"-0.736652460","17":"-0.554330903","18":"-0.077406831","19":"2.7758875","20":"0.714180422","21":"-3.44470266","22":"-1.25623866","23":"1.181794059","24":"bact_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.73824330","2":"2.2576612","3":"-3.817685","4":"4.712227122","5":"-3.8176848","6":"6.002475448","7":"1.049849608","8":"-3.8176848","9":"0.589034405","10":"3.832960","11":"0.444995035","12":"1.646146963","13":"-3.817685","14":"-3.8176848","15":"1.0498496082","16":"-0.234165904","17":"-0.639631012","18":"0.010956554","19":"2.8568765","20":"1.065117080","21":"-3.81768484","22":"-0.53991584","23":"0.015375527","24":"bact_strep","25":"0","26":"1","27":"0","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"3.47771319","2":"1.3842769","3":"-3.933843","4":"2.641232747","5":"-3.9338431","6":"5.254353914","7":"0.971431685","8":"-3.9338431","9":"0.255811649","10":"2.652329","11":"-0.270281447","12":"2.451351306","13":"-3.933843","14":"-3.9338431","15":"1.3184303348","16":"-1.225792892","17":"-0.350324155","18":"-0.532645712","19":"4.6037408","20":"0.971431685","21":"-3.93384309","22":"-0.57106031","23":"2.474963492","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"4.26664104","2":"1.5870625","3":"-3.755272","4":"2.451304183","5":"-3.7552717","6":"5.537109339","7":"0.788023039","8":"-3.7552717","9":"1.015412881","10":"2.732412","11":"-0.321284539","12":"1.200555314","13":"-3.755272","14":"-3.7552717","15":"1.0650098219","16":"-1.270365094","17":"-0.536395919","18":"-0.664229290","19":"3.7535154","20":"0.926859483","21":"-3.75527174","22":"0.64357404","23":"0.421094752","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"3.86979590","2":"2.1506335","3":"-3.858180","4":"2.669778278","5":"-3.8581796","6":"5.706823653","7":"1.032169488","8":"-3.8581796","9":"-0.096979524","10":"3.771796","11":"-0.424192436","12":"0.485625782","13":"-3.858180","14":"-3.8581796","15":"1.5217177135","16":"-0.967807882","17":"-0.680125810","18":"-0.490883810","19":"3.6797830","20":"0.920943853","21":"-3.85817964","22":"-0.69563819","23":"-0.187451767","24":"bact_strep","25":"0","26":"0","27":"1","28":"0","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-0.84090596","2":"3.5548419","3":"-3.785345","4":"4.824062732","5":"-3.7853449","6":"4.495112743","7":"0.308999618","8":"-3.7853449","9":"2.493176480","10":"3.155845","11":"-1.077294743","12":"2.303699932","13":"-3.785345","14":"-3.7853449","15":"1.0666853200","16":"-3.785344944","17":"0.064802658","18":"-0.351357739","19":"4.4502808","20":"2.049465793","21":"-3.78534494","22":"-0.94479396","23":"2.018569762","24":"bact_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.27701004","2":"1.8185676","3":"-3.579595","4":"4.129264473","5":"-3.5795951","6":"5.930775759","7":"1.074365222","8":"-3.5795951","9":"1.182578806","10":"4.051837","11":"0.886312990","12":"2.225539841","13":"-3.579595","14":"-3.5795951","15":"1.0647957708","16":"-3.579595128","17":"-0.283758262","18":"-0.113859226","19":"3.5529024","20":"0.814854026","21":"-3.57959513","22":"-1.31852760","23":"-0.187451767","24":"bact_strep","25":"0","26":"0","27":"0","28":"1","29":"0","30":"0","31":"1","32":"0","33":"1","34":"0"},{"1":"-1.28375108","2":"2.5839717","3":"-3.768658","4":"4.871637661","5":"-3.7686577","6":"5.298274061","7":"0.465448777","8":"-3.7686577","9":"2.717503061","10":"2.629937","11":"1.844470379","12":"2.257208246","13":"-3.768658","14":"-3.7686577","15":"0.7199786420","16":"-3.768657728","17":"0.143365278","18":"0.182585991","19":"4.3513361","20":"-0.401361898","21":"-3.76865773","22":"-1.19394972","23":"3.539968377","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.85820406","2":"1.8117474","3":"-3.244498","4":"3.132228528","5":"-3.2444984","6":"4.690373146","7":"0.051338446","8":"-3.2444984","9":"1.779382101","10":"2.566643","11":"6.097396392","12":"1.319849772","13":"-3.244498","14":"-3.2444984","15":"0.5621640701","16":"-3.244498420","17":"0.189488785","18":"-0.066444589","19":"2.8468115","20":"-0.411285076","21":"-3.24449842","22":"-1.28738313","23":"0.750737582","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"1","31":"0","32":"0","33":"1","34":"0"},{"1":"-1.22148133","2":"1.7229576","3":"-3.418706","4":"3.564156843","5":"-3.4187059","6":"4.797382190","7":"0.218880251","8":"-3.4187059","9":"1.441106496","10":"2.690542","11":"6.051148516","12":"2.032332545","13":"-3.418706","14":"-3.4187059","15":"-0.1606093703","16":"-2.725558728","17":"0.387956581","18":"-1.020810636","19":"2.4893770","20":"0.244855738","21":"-3.41870591","22":"-1.16280525","23":"0.040777416","24":"bact_strep","25":"0","26":"0","27":"0","28":"0","29":"1","30":"0","31":"1","32":"0","33":"1","34":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="sec-specs" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="sec-specs"><span class="header-section-number">5.1.3</span> Model specifications</h3>
<p>The process of specifying models is:</p>
<ol type="1">
<li>Pick a model type</li>
<li>Set the engine</li>
<li>Set the mode: regression or classification</li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">library</span>(rules)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">library</span>(baguette)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>svm_r_spec <span class="ot">&lt;-</span> </span>
<span id="cb15-5"><a href="#cb15-5"></a>   parsnip<span class="sc">::</span><span class="fu">svm_rbf</span>(<span class="at">cost =</span> <span class="fu">tune</span>(), <span class="at">rbf_sigma =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"kernlab"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb15-8"><a href="#cb15-8"></a></span>
<span id="cb15-9"><a href="#cb15-9"></a>svm_p_spec <span class="ot">&lt;-</span> </span>
<span id="cb15-10"><a href="#cb15-10"></a>   parsnip<span class="sc">::</span><span class="fu">svm_poly</span>(<span class="at">cost =</span> <span class="fu">tune</span>(), <span class="at">degree =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb15-11"><a href="#cb15-11"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"kernlab"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-12"><a href="#cb15-12"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb15-13"><a href="#cb15-13"></a></span>
<span id="cb15-14"><a href="#cb15-14"></a>cart_spec <span class="ot">&lt;-</span> </span>
<span id="cb15-15"><a href="#cb15-15"></a>   parsnip<span class="sc">::</span><span class="fu">decision_tree</span>(<span class="at">cost_complexity =</span> <span class="fu">tune</span>(), <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb15-16"><a href="#cb15-16"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"rpart"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-17"><a href="#cb15-17"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb15-18"><a href="#cb15-18"></a></span>
<span id="cb15-19"><a href="#cb15-19"></a>bag_cart_spec <span class="ot">&lt;-</span> </span>
<span id="cb15-20"><a href="#cb15-20"></a>   parsnip<span class="sc">::</span><span class="fu">bag_tree</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-21"><a href="#cb15-21"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"rpart"</span>, <span class="at">times =</span> <span class="dv">50</span>L) <span class="sc">%&gt;%</span> </span>
<span id="cb15-22"><a href="#cb15-22"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb15-23"><a href="#cb15-23"></a></span>
<span id="cb15-24"><a href="#cb15-24"></a>rf_spec <span class="ot">&lt;-</span> </span>
<span id="cb15-25"><a href="#cb15-25"></a>   parsnip<span class="sc">::</span><span class="fu">rand_forest</span>(<span class="at">mtry =</span> <span class="fu">tune</span>(), <span class="at">min_n =</span> <span class="fu">tune</span>(), <span class="at">trees =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-26"><a href="#cb15-26"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"ranger"</span>, <span class="at">importance =</span> <span class="st">"impurity"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-27"><a href="#cb15-27"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb15-28"><a href="#cb15-28"></a></span>
<span id="cb15-29"><a href="#cb15-29"></a>xgb_spec <span class="ot">&lt;-</span> </span>
<span id="cb15-30"><a href="#cb15-30"></a>   parsnip<span class="sc">::</span><span class="fu">boost_tree</span>(<span class="at">tree_depth =</span> <span class="fu">tune</span>(), <span class="at">learn_rate =</span> <span class="fu">tune</span>(), <span class="at">loss_reduction =</span> <span class="fu">tune</span>(), </span>
<span id="cb15-31"><a href="#cb15-31"></a>              <span class="at">min_n =</span> <span class="fu">tune</span>(), <span class="at">sample_size =</span> <span class="fu">tune</span>(), <span class="at">trees =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb15-32"><a href="#cb15-32"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"xgboost"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-33"><a href="#cb15-33"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb15-34"><a href="#cb15-34"></a></span>
<span id="cb15-35"><a href="#cb15-35"></a>nnet_spec <span class="ot">&lt;-</span> </span>
<span id="cb15-36"><a href="#cb15-36"></a>   parsnip<span class="sc">::</span><span class="fu">mlp</span>(<span class="at">hidden_units =</span> <span class="fu">tune</span>(), <span class="at">penalty =</span> <span class="fu">tune</span>(), <span class="at">epochs =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb15-37"><a href="#cb15-37"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"nnet"</span>, <span class="at">MaxNWts =</span> <span class="dv">2600</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-38"><a href="#cb15-38"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb15-39"><a href="#cb15-39"></a></span>
<span id="cb15-40"><a href="#cb15-40"></a>fda_spec <span class="ot">&lt;-</span> </span>
<span id="cb15-41"><a href="#cb15-41"></a>   parsnip<span class="sc">::</span><span class="fu">discrim_flexible</span>(<span class="at">prod_degree =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span>  <span class="co">#&lt;- use GCV to choose terms</span></span>
<span id="cb15-42"><a href="#cb15-42"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"earth"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-43"><a href="#cb15-43"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb15-44"><a href="#cb15-44"></a></span>
<span id="cb15-45"><a href="#cb15-45"></a>bart_spec <span class="ot">&lt;-</span> </span>
<span id="cb15-46"><a href="#cb15-46"></a>  parsnip<span class="sc">::</span><span class="fu">bart</span>(<span class="at">trees =</span> <span class="dv">1000</span>, <span class="at">prior_terminal_node_coef =</span> <span class="fu">tune</span>(), <span class="at">prior_terminal_node_expo =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb15-47"><a href="#cb15-47"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"dbarts"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-48"><a href="#cb15-48"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sec-wf" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="sec-wf"><span class="header-section-number">5.1.4</span> Create workflow set</h3>
<p>Now we need to specify the workflows that will be followed for the different model types</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>balclr_5c_wf <span class="ot">&lt;-</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_set</span>(</span>
<span id="cb16-3"><a href="#cb16-3"></a>      <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">balclr_5c =</span> balclr_5c_rec), </span>
<span id="cb16-4"><a href="#cb16-4"></a>      <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb16-5"><a href="#cb16-5"></a>        <span class="co">#SVM_radial = svm_r_spec, </span></span>
<span id="cb16-6"><a href="#cb16-6"></a>        <span class="co">#SVM_poly = svm_p_spec, </span></span>
<span id="cb16-7"><a href="#cb16-7"></a>        <span class="co">#CART = cart_spec, </span></span>
<span id="cb16-8"><a href="#cb16-8"></a>        <span class="co">#CART_bagged = bag_cart_spec,</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>        <span class="co">#NNET = nnet_spec,</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>        <span class="at">boosting =</span> xgb_spec,</span>
<span id="cb16-11"><a href="#cb16-11"></a>        <span class="co">#bart = bart_spec, </span></span>
<span id="cb16-12"><a href="#cb16-12"></a>        <span class="co">#fda = fda_spec,</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>        <span class="at">RF =</span> rf_spec)</span>
<span id="cb16-14"><a href="#cb16-14"></a>   )</span>
<span id="cb16-15"><a href="#cb16-15"></a></span>
<span id="cb16-16"><a href="#cb16-16"></a>balclr_5c_wf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["wflow_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["info"],"name":[2],"type":["list"],"align":["right"]},{"label":["option"],"name":[3],"type":["list"],"align":["right"]},{"label":["result"],"name":[4],"type":["list"],"align":["right"]}],"data":[{"1":"balclr_5c_boosting","2":"<tibble[,4]>","3":"<wrkflw__>","4":"<list [0]>"},{"1":"balclr_5c_RF","2":"<tibble[,4]>","3":"<wrkflw__>","4":"<list [0]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="sec-tune" class="level3" data-number="5.1.5">
<h3 data-number="5.1.5" class="anchored" data-anchor-id="sec-tune"><span class="header-section-number">5.1.5</span> Tune</h3>
<p>Train and test performance for all the different models over the different train/test and 5-fold cv splits. This takes a long time to run…</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>balclr_5c_grid_results <span class="ot">&lt;-</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_map</span>(balclr_5c_wf, </span>
<span id="cb17-3"><a href="#cb17-3"></a>      <span class="at">seed =</span> <span class="dv">1578</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>      <span class="at">resamples =</span> balclr_5c_folds,</span>
<span id="cb17-5"><a href="#cb17-5"></a>      <span class="at">grid =</span> <span class="dv">15</span>,</span>
<span id="cb17-6"><a href="#cb17-6"></a>      <span class="at">control =</span> tune<span class="sc">::</span><span class="fu">control_grid</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">parallel_over =</span> <span class="st">"everything"</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-7"><a href="#cb17-7"></a>      <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(recall, precision, f_meas, j_index, accuracy, kap, roc_auc, sens, spec),</span>
<span id="cb17-8"><a href="#cb17-8"></a>   )</span>
<span id="cb17-9"><a href="#cb17-9"></a></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co"># save this for later</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>readr<span class="sc">::</span><span class="fu">write_rds</span>(balclr_5c_grid_results, here<span class="sc">::</span><span class="fu">here</span>(data_ml, <span class="st">"model_tune_5_class.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="best-tuning-parameters-and-best-performing-models" class="level3" data-number="5.1.6">
<h3 data-number="5.1.6" class="anchored" data-anchor-id="best-tuning-parameters-and-best-performing-models"><span class="header-section-number">5.1.6</span> Best tuning parameters and best performing models</h3>
<p>First look at which of the models performed best according to area under the receiver operator curve</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>mymetric <span class="ot">&lt;-</span> <span class="st">"roc_auc"</span></span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(</span>
<span id="cb18-4"><a href="#cb18-4"></a>  balclr_5c_grid_results,</span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="at">rank_metric =</span> mymetric,  </span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="at">metric =</span> mymetric,       </span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="co"># one point per workflow </span></span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Mean and standard deviation across train-test splits of the areas under the receiver operator curves for the different models. boosting = Gradient Boosted Trees Classifier (XGBoost), RF = Random Forest Classifier (Ranger).
</figcaption>
</figure>
</div>
<section id="peformance-metrics-for-best-model" class="level4" data-number="5.1.6.1">
<h4 data-number="5.1.6.1" class="anchored" data-anchor-id="peformance-metrics-for-best-model"><span class="header-section-number">5.1.6.1</span> Peformance metrics for best model</h4>
<p>Defines a function for easily extracting metrics of interest</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>getmymetrics <span class="ot">&lt;-</span> <span class="cf">function</span>(gridresults, myworkflow, mymetric, mysplit){</span>
<span id="cb19-2"><a href="#cb19-2"></a>  best_results <span class="ot">&lt;-</span> gridresults <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>   workflowsets<span class="sc">::</span><span class="fu">extract_workflow_set_result</span>(myworkflow) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4"></a>   tune<span class="sc">::</span><span class="fu">select_best</span>(<span class="at">metric =</span> mymetric)</span>
<span id="cb19-5"><a href="#cb19-5"></a>  </span>
<span id="cb19-6"><a href="#cb19-6"></a>   gridresults <span class="sc">%&gt;%</span> </span>
<span id="cb19-7"><a href="#cb19-7"></a>     hardhat<span class="sc">::</span><span class="fu">extract_workflow</span>(myworkflow) <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href="#cb19-8"></a>     tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(best_results) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9"></a>     tune<span class="sc">::</span><span class="fu">last_fit</span>(<span class="at">split =</span> mysplit,</span>
<span id="cb19-10"><a href="#cb19-10"></a>             <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(recall, precision, f_meas, j_index, accuracy, kap, roc_auc, sens, spec))</span>
<span id="cb19-11"><a href="#cb19-11"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Call the function to get performance metrics of different models</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">set.seed</span>(<span class="dv">23784</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>balclr_5c_rf_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_5c_grid_results,</span>
<span id="cb20-3"><a href="#cb20-3"></a>                                          <span class="st">"balclr_5c_RF"</span>,</span>
<span id="cb20-4"><a href="#cb20-4"></a>                                          <span class="st">"roc_auc"</span>,</span>
<span id="cb20-5"><a href="#cb20-5"></a>                                          balclr_5c_split)</span>
<span id="cb20-6"><a href="#cb20-6"></a>balclr_5c_boosting_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_5c_grid_results,</span>
<span id="cb20-7"><a href="#cb20-7"></a>                                                <span class="st">"balclr_5c_boosting"</span>,</span>
<span id="cb20-8"><a href="#cb20-8"></a>                                                <span class="st">"roc_auc"</span>,</span>
<span id="cb20-9"><a href="#cb20-9"></a>                                                balclr_5c_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Defines a function to collect and format metrics of different models and calls the function on all the different trained models</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>collect_format <span class="ot">&lt;-</span> <span class="cf">function</span>(res, name){</span>
<span id="cb21-2"><a href="#cb21-2"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">metric =</span> .metric,</span>
<span id="cb21-4"><a href="#cb21-4"></a>                {{ name }} <span class="sc">:</span><span class="er">=</span> .estimate,</span>
<span id="cb21-5"><a href="#cb21-5"></a>                <span class="at">estimate_type =</span> .estimator)</span>
<span id="cb21-6"><a href="#cb21-6"></a>}</span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="fu">collect_format</span>(balclr_5c_rf_test_results, <span class="st">"random_forest"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-9"><a href="#cb21-9"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">collect_format</span>(balclr_5c_boosting_test_results, <span class="st">"boosting"</span>), <span class="at">by =</span> <span class="fu">join_by</span>(metric, estimate_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-10"><a href="#cb21-10"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(estimate_type, metric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["estimate_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["metric"],"name":[2],"type":["chr"],"align":["left"]},{"label":["random_forest"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["boosting"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"macro","2":"recall","3":"0.6666667","4":"0.6555556"},{"1":"macro","2":"precision","3":"0.6894639","4":"0.6766667"},{"1":"macro","2":"f_meas","3":"0.6694878","4":"0.6610155"},{"1":"macro","2":"j_index","3":"0.5833333","4":"0.5694444"},{"1":"multiclass","2":"accuracy","3":"0.6666667","4":"0.6555556"},{"1":"multiclass","2":"kap","3":"0.5833333","4":"0.5694444"},{"1":"macro","2":"sens","3":"0.6666667","4":"0.6555556"},{"1":"macro","2":"spec","3":"0.9166667","4":"0.9138889"},{"1":"hand_till","2":"roc_auc","3":"0.8762346","4":"0.8594136"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="roc-and-pr-curves" class="level4" data-number="5.1.6.2">
<h4 data-number="5.1.6.2" class="anchored" data-anchor-id="roc-and-pr-curves"><span class="header-section-number">5.1.6.2</span> ROC and PR curves</h4>
<p><a href="https://www.nature.com/articles/nmeth.3945">This is a useful resource</a> for understanding ROC curves and PR curves.</p>
<p>ROC curves here indicate that there is decent performance for the evolution environments of the ancestral clones, bacteria only, and bacteria plus ciliates. Performance is worse for treatments with streptomycin (see the PR curves). This is consistent with the strong overlap in community composition that we saw between strep and strep plus ciliate treatments. If the community response of the treatments is similiar it will be difficult to identify discriminating patterns in the data.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>balclr_5c_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  yardstick<span class="sc">::</span><span class="fu">roc_curve</span>(home_env_5c, .pred_anc<span class="sc">:</span>.pred_bact_strep) <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"FP rate"</span>, <span class="at">y =</span> <span class="st">"TP rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-02" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: ROC curve for True positive rate (TPR, vertical axis) versus the false positive rate (FPR, horizontal axis) for the five different evolutionary histories in the experiment from the hold-out testing data. The dashed 1:1 line is the expected performance of a random classifier. Curves above the 1:1 are better performance than random. Curves below 1:1 are worse performance than random.
</figcaption>
</figure>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>balclr_5c_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  yardstick<span class="sc">::</span><span class="fu">pr_curve</span>(home_env_5c, .pred_anc<span class="sc">:</span>.pred_bact_strep) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Recall"</span>, <span class="at">y =</span> <span class="st">"Precision"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-03" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Precision recall curves for the five different evolutionary histories in the experiment from the hold-out testing data. There is a good tuorial for interpretation of these plots on <a href="https://scikit-learn.org/1.5/auto_examples/model_selection/plot_precision_recall.html">scikit-learn</a>.
</figcaption>
</figure>
</div>
</section>
<section id="confusion-matrix" class="level4" data-number="5.1.6.3">
<h4 data-number="5.1.6.3" class="anchored" data-anchor-id="confusion-matrix"><span class="header-section-number">5.1.6.3</span> Confusion matrix</h4>
<p>The confusion matrix shows that for ciliates evolution environment (bact_pred), the model is only getting the evolution environment correct about half the time (10 correct/8 incorrect) which is basically the same as guessing. The best performing home environments are the ancestral and the combined predators and streptomycin treatments.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>balclr_5c_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(home_env_5c, .pred_class) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">"heatmap"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-04" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Confusion matrix showing the classifier performance on each of the five evolutionary history classes using the hold-out testing data.
</figcaption>
</figure>
</div>
</section>
<section id="probability-distributions-for-the-5-classes" class="level4" data-number="5.1.6.4">
<h4 data-number="5.1.6.4" class="anchored" data-anchor-id="probability-distributions-for-the-5-classes"><span class="header-section-number">5.1.6.4</span> Probability distributions for the 5 classes</h4>
<p>Gradient boosting trees give each prediction a probability for every class. The higher the probability the higher the confidence in the prediction. We can visualize the distribution of these prediction probabilities to get some insight as to which classes the model has trouble distinguishing and which are very clearly separated.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>balclr_5c_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(</span>
<span id="cb25-4"><a href="#cb25-4"></a>    .pred_anc,</span>
<span id="cb25-5"><a href="#cb25-5"></a>    .pred_bact,</span>
<span id="cb25-6"><a href="#cb25-6"></a>    .pred_bact_pred,</span>
<span id="cb25-7"><a href="#cb25-7"></a>    .pred_bact_pred_strep,</span>
<span id="cb25-8"><a href="#cb25-8"></a>    .pred_bact_strep</span>
<span id="cb25-9"><a href="#cb25-9"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> home_env_5c), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Prediction Probability"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>( <span class="sc">~</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-05" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Prediction probability densities (colors) for each observation of the five evolutionary history classes (grid columns) tested with the model.
</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="classes-ancestral-clones-vs-coevolved-history" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="classes-ancestral-clones-vs-coevolved-history"><span class="header-section-number">5.2</span> 2 classes (ancestral clones vs coevolved history)</h2>
<p>Based on the above analysis and from inspecting the community composition data it appears that ancestral/clonal community has a distinct response to the measurement conditions compared with all the other evolutionary histories. Here instead of trying to predict 5 different home environment classes we just want to predict whether the bacteria had a coevolutionary history from the YSK experiment or not. However, this introduces an additional challenge because now the classes we will be trying to predict are imbalanced.</p>
<section id="spliting" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="spliting"><span class="header-section-number">5.2.1</span> Spliting</h3>
<p>Done the same as in <a href="#sec-split" class="quarto-xref">Section&nbsp;5.1.1</a> from the 5-class classification.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>balclr_ae <span class="ot">&lt;-</span> balclr_md <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>home_env_5c, <span class="sc">-</span>home_env_sns, <span class="sc">-</span>home_env_pnp) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb26-4"><a href="#cb26-4"></a>         <span class="at">transfer =</span> <span class="fu">factor</span>(transfer),</span>
<span id="cb26-5"><a href="#cb26-5"></a>         <span class="at">measure_env =</span> <span class="fu">factor</span>(measure_env),</span>
<span id="cb26-6"><a href="#cb26-6"></a>         <span class="at">home_env_ae =</span> <span class="fu">factor</span>(home_env_ae))</span>
<span id="cb26-7"><a href="#cb26-7"></a></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="fu">table</span>(balclr_ae<span class="sc">$</span>home_env_ae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
anc evo 
 72 283 </code></pre>
</div>
</div>
<p>So in this case the classes from the data are clearly not balanced… We will try and address that in the recipe step using the <code>themis</code> package. In particular we use Randomly Over Sampling Examples (ROSE). The ROSE algorithm works by selecting an observation belonging to class k and generates new examples in its neighborhood is determined by some matrix H_k. Smaller values of these arguments have the effect of shrinking the entries of the corresponding smoothing matrix H_k, Shrinking would be a cautious choice if there is a concern that excessively large neighborhoods could lead to blur the boundaries between the regions of the feature space associated with each class.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">set.seed</span>(<span class="dv">1467</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>balclr_ae_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(balclr_ae, <span class="at">strata =</span> home_env_ae)</span>
<span id="cb28-3"><a href="#cb28-3"></a>balclr_ae_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(balclr_ae_split)</span>
<span id="cb28-4"><a href="#cb28-4"></a>balclr_ae_test  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(balclr_ae_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">set.seed</span>(<span class="dv">1468</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>balclr_ae_folds <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(balclr_ae_train, <span class="at">strata =</span> home_env_ae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="recipe" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="recipe"><span class="header-section-number">5.2.2</span> Recipe</h3>
<p>Done the same as in <a href="#sec-recipe" class="quarto-xref">Section&nbsp;5.1.2</a> from the 5-class classification.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>balclr_ae_rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(home_env_ae <span class="sc">~</span> ., <span class="at">data =</span> balclr_ae_train) <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(od600, ciliate_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(od600, ciliate_per_ml)</span>
<span id="cb30-5"><a href="#cb30-5"></a></span>
<span id="cb30-6"><a href="#cb30-6"></a>balclr_ae_rec_rose <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(home_env_ae <span class="sc">~</span> ., <span class="at">data =</span> balclr_ae_train) <span class="sc">%&gt;%</span> </span>
<span id="cb30-7"><a href="#cb30-7"></a>  themis<span class="sc">::</span><span class="fu">step_rose</span>(home_env_ae) <span class="sc">%&gt;%</span> </span>
<span id="cb30-8"><a href="#cb30-8"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(od600, ciliate_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb30-9"><a href="#cb30-9"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(od600, ciliate_per_ml)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-specifications" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="model-specifications"><span class="header-section-number">5.2.3</span> Model specifications</h3>
<p>Using the same model specifications as in <a href="#sec-specs" class="quarto-xref">Section&nbsp;5.1.3</a> from the 5-class classification.</p>
</section>
<section id="create-workflow-set" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="create-workflow-set"><span class="header-section-number">5.2.4</span> Create workflow set</h3>
<p>Same process as in <a href="#sec-wf" class="quarto-xref">Section&nbsp;5.1.4</a> from the 5-class classification.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>balclr_ae_wf <span class="ot">&lt;-</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_set</span>(</span>
<span id="cb31-3"><a href="#cb31-3"></a>      <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">balclr_ae =</span> balclr_ae_rec, </span>
<span id="cb31-4"><a href="#cb31-4"></a>                     <span class="at">balclr_ae_rose =</span> balclr_ae_rec_rose), </span>
<span id="cb31-5"><a href="#cb31-5"></a>      <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb31-6"><a href="#cb31-6"></a>        <span class="co">#SVM_radial = svm_r_spec, </span></span>
<span id="cb31-7"><a href="#cb31-7"></a>        <span class="co">#SVM_poly = svm_p_spec, </span></span>
<span id="cb31-8"><a href="#cb31-8"></a>        <span class="co">#CART = cart_spec, </span></span>
<span id="cb31-9"><a href="#cb31-9"></a>        <span class="co">#CART_bagged = bag_cart_spec,</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>        <span class="co">#NNET = nnet_spec,</span></span>
<span id="cb31-11"><a href="#cb31-11"></a>        <span class="at">boosting =</span> xgb_spec,</span>
<span id="cb31-12"><a href="#cb31-12"></a>        <span class="co">#bart = bart_spec, </span></span>
<span id="cb31-13"><a href="#cb31-13"></a>        <span class="co">#fda = fda_spec,</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>        <span class="at">RF =</span> rf_spec</span>
<span id="cb31-15"><a href="#cb31-15"></a>      )</span>
<span id="cb31-16"><a href="#cb31-16"></a>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tune" class="level3" data-number="5.2.5">
<h3 data-number="5.2.5" class="anchored" data-anchor-id="tune"><span class="header-section-number">5.2.5</span> Tune</h3>
<p>Same as in <a href="#sec-tune" class="quarto-xref">Section&nbsp;5.1.5</a> from the 5-class classification. Warning this takes some time…</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>balclr_ae_grid_results <span class="ot">&lt;-</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_map</span>(balclr_ae_wf, </span>
<span id="cb32-3"><a href="#cb32-3"></a>      <span class="at">seed =</span> <span class="dv">1469</span>,</span>
<span id="cb32-4"><a href="#cb32-4"></a>      <span class="at">resamples =</span> balclr_ae_folds,</span>
<span id="cb32-5"><a href="#cb32-5"></a>      <span class="at">grid =</span> <span class="dv">15</span>,</span>
<span id="cb32-6"><a href="#cb32-6"></a>      <span class="at">control =</span> tune<span class="sc">::</span><span class="fu">control_grid</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">parallel_over =</span> <span class="st">"everything"</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-7"><a href="#cb32-7"></a>      <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(recall, precision, f_meas, j_index, accuracy, kap, roc_auc, sens, spec),</span>
<span id="cb32-8"><a href="#cb32-8"></a>   )</span>
<span id="cb32-9"><a href="#cb32-9"></a></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="co"># save this for later</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>readr<span class="sc">::</span><span class="fu">write_rds</span>(balclr_ae_grid_results, here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_ae.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>balclr_ae_grid_results <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_ae.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="best-tuning-parameters-and-best-performing-models-1" class="level3" data-number="5.2.6">
<h3 data-number="5.2.6" class="anchored" data-anchor-id="best-tuning-parameters-and-best-performing-models-1"><span class="header-section-number">5.2.6</span> Best tuning parameters and best performing models</h3>
<p>First look at which of the models performed best. We’ll use the J index and the ROC auc as suggested in the <a href="https://www.tidymodels.org/learn/models/sub-sampling/">tidymodels unbalanced class tutorial.</a></p>
<ul>
<li>The area under the ROC curve is an overall assessment of performance across all cutoffs. Values near one indicate very good results while values near 0.5 would imply that the model is very poor (i.e.&nbsp;no better than guessing)</li>
<li>The J index (a.k.a. Youden’s J statistic) is sensitivity + specificity - 1. Values near one are once again best.</li>
</ul>
<p>If a model is poorly calibrated, the ROC curve value might not show diminished performance. However, the J index would be lower for models with pathological distributions for the class probabilities. The yardstick package will be used to compute these metrics.</p>
<p>J index</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># which metric to visualize</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>mymetric <span class="ot">&lt;-</span> <span class="st">"j_index"</span></span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(</span>
<span id="cb34-5"><a href="#cb34-5"></a>  balclr_ae_grid_results,</span>
<span id="cb34-6"><a href="#cb34-6"></a>  <span class="at">rank_metric =</span> mymetric,  </span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="at">metric =</span> mymetric,       </span>
<span id="cb34-8"><a href="#cb34-8"></a>  <span class="co"># one point per workflow </span></span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-06" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Mean and standard deviation across train-test splits of the <a href="https://en.wikipedia.org/wiki/Youden%27s_J_statistic">J-index</a> for the different models. boosting = Gradient Boosted Trees Classifier (XGBoost), RF = Random Forest Classifier (Ranger). Rose indicates that synthetic data has been generated using the ROSE algorithm to better balance the classes.
</figcaption>
</figure>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># which metric to visualize</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>mymetric <span class="ot">&lt;-</span> <span class="st">"roc_auc"</span></span>
<span id="cb35-3"><a href="#cb35-3"></a></span>
<span id="cb35-4"><a href="#cb35-4"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(</span>
<span id="cb35-5"><a href="#cb35-5"></a>  balclr_ae_grid_results,</span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="at">rank_metric =</span> mymetric,  </span>
<span id="cb35-7"><a href="#cb35-7"></a>  <span class="at">metric =</span> mymetric,       </span>
<span id="cb35-8"><a href="#cb35-8"></a>  <span class="co"># one point per workflow </span></span>
<span id="cb35-9"><a href="#cb35-9"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-07" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Mean and standard deviation across train-test splits of the areas under the receiver operator curves for the different models. boosting = Gradient Boosted Trees Classifier (XGBoost), RF = Random Forest Classifier (Ranger). Rose indicates that synthetic data has been generated using the ROSE algorithm to better balance the classes.
</figcaption>
</figure>
</div>
<p>It looks like ROSE preprocessing step helped (at least somewhat) with the J-index. Class imbalance sampling methods tend to greatly improve metrics based on the hard class predictions (i.e., the categorical predictions) because the default cutoff tends to be a better balance of sensitivity and specificity.</p>
<section id="peformance-metrics-for-best-model-1" class="level4" data-number="5.2.6.1">
<h4 data-number="5.2.6.1" class="anchored" data-anchor-id="peformance-metrics-for-best-model-1"><span class="header-section-number">5.2.6.1</span> Peformance metrics for best model</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">set.seed</span>(<span class="dv">4671</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>balclr_ae_boosting_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_ae_grid_results,</span>
<span id="cb36-3"><a href="#cb36-3"></a>                                                <span class="st">"balclr_ae_rose_boosting"</span>,</span>
<span id="cb36-4"><a href="#cb36-4"></a>                                                <span class="st">"j_index"</span>,</span>
<span id="cb36-5"><a href="#cb36-5"></a>                                                balclr_ae_split)</span>
<span id="cb36-6"><a href="#cb36-6"></a>balclr_ae_rf_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_ae_grid_results,</span>
<span id="cb36-7"><a href="#cb36-7"></a>                                          <span class="st">"balclr_ae_rose_RF"</span>,</span>
<span id="cb36-8"><a href="#cb36-8"></a>                                          <span class="st">"j_index"</span>,</span>
<span id="cb36-9"><a href="#cb36-9"></a>                                          balclr_ae_split)</span>
<span id="cb36-10"><a href="#cb36-10"></a></span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="fu">collect_format</span>(balclr_ae_rf_test_results, <span class="st">"random_forest"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-12"><a href="#cb36-12"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">collect_format</span>(balclr_ae_boosting_test_results, <span class="st">"boosting"</span>), <span class="at">by =</span> <span class="fu">join_by</span>(metric, estimate_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-13"><a href="#cb36-13"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(estimate_type, metric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["estimate_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["metric"],"name":[2],"type":["chr"],"align":["left"]},{"label":["random_forest"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["boosting"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"binary","2":"recall","3":"0.6111111","4":"0.6666667"},{"1":"binary","2":"precision","3":"0.5000000","4":"0.4444444"},{"1":"binary","2":"f_meas","3":"0.5500000","4":"0.5333333"},{"1":"binary","2":"j_index","3":"0.4561815","4":"0.4553991"},{"1":"binary","2":"accuracy","3":"0.7977528","4":"0.7640449"},{"1":"binary","2":"kap","3":"0.4212428","4":"0.3837784"},{"1":"binary","2":"sens","3":"0.6111111","4":"0.6666667"},{"1":"binary","2":"spec","3":"0.8450704","4":"0.7887324"},{"1":"binary","2":"roc_auc","3":"0.8059468","4":"0.7840376"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Gradient boosting and random forest seems to be doing performing about equally here</p>
</section>
<section id="roc-and-pr-curves-1" class="level4" data-number="5.2.6.2">
<h4 data-number="5.2.6.2" class="anchored" data-anchor-id="roc-and-pr-curves-1"><span class="header-section-number">5.2.6.2</span> ROC and PR curves</h4>
<p>With unbalaced classes like we have here, it is best to look at both the ROC curve and the PR (precision-recall) curve. <a href="https://www.nature.com/articles/nmeth.3945">See here</a></p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>balclr_ae_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>  yardstick<span class="sc">::</span><span class="fu">roc_curve</span>(home_env_ae, .pred_anc) <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="#cb37-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"FP rate"</span>, <span class="at">y =</span> <span class="st">"TP rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-08" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: ROC curve for True positive rate (TPR, vertical axis) versus the false positive rate (FPR, horizontal axis) for classifying the evolutionary history as either ancestral/clonal or YSK-derived in the experiment from the hold-out testing data. The dashed 1:1 line is the expected performance of a random classifier. Curves above the 1:1 are better performance than random. Curves below 1:1 are worse performance than random.
</figcaption>
</figure>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>balclr_ae_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3"></a>  yardstick<span class="sc">::</span><span class="fu">pr_curve</span>(home_env_ae, .pred_anc) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Recall"</span>, <span class="at">y =</span> <span class="st">"Precision"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-09" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Precision recall curves for classifying the evolutionary history as either ancestral/clonal or YSK-derived in the experiment from the hold-out testing data. There is a good tuorial for interpretation of these plots on <a href="https://scikit-learn.org/1.5/auto_examples/model_selection/plot_precision_recall.html">scikit-learn</a>.
</figcaption>
</figure>
</div>
</section>
<section id="confusion-matrix-1" class="level4" data-number="5.2.6.3">
<h4 data-number="5.2.6.3" class="anchored" data-anchor-id="confusion-matrix-1"><span class="header-section-number">5.2.6.3</span> Confusion matrix</h4>
<p>The model is doing pretty well finding the communiuties with a coevolutionary history, but it is doing less well at finding the ancestral communities. It is getting the ancestral correct 2/3 of the time.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>balclr_ae_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>  yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(home_env_ae, .pred_class) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">"heatmap"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-10" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Confusion matrix showing the classifier performance on each of the two evolutionary history classes using the hold-out testing data. (anc = ancelstra/clonal, evo = from YSK)
</figcaption>
</figure>
</div>
</section>
<section id="probability-distributions-for-the-2-classes" class="level4" data-number="5.2.6.4">
<h4 data-number="5.2.6.4" class="anchored" data-anchor-id="probability-distributions-for-the-2-classes"><span class="header-section-number">5.2.6.4</span> Probability distributions for the 2 classes</h4>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>balclr_ae_boosting_test_results <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred_evo, <span class="at">fill =</span> home_env_ae), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Prediction Probability"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-11" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Prediction probability densities (colors) for each observation of the two evolutionary history classes tested with the model.
</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="classes-streptomycin-history-vs-no-streptomycin-history" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="classes-streptomycin-history-vs-no-streptomycin-history"><span class="header-section-number">5.3</span> 2 classes (streptomycin history vs no streptomycin history)</h2>
<p>Now we will try and predict whether the evolutionary history of the communities included exposure to streptomycin</p>
<section id="spliting-1" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="spliting-1"><span class="header-section-number">5.3.1</span> Spliting</h3>
<p>Done the same as in <a href="#sec-split" class="quarto-xref">Section&nbsp;5.1.1</a> from the 5-class classification.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>balclr_sns <span class="ot">&lt;-</span> balclr_md <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>home_env_5c, <span class="sc">-</span>home_env_ae, <span class="sc">-</span>home_env_pnp) <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb41-4"><a href="#cb41-4"></a>         <span class="at">transfer =</span> <span class="fu">factor</span>(transfer),</span>
<span id="cb41-5"><a href="#cb41-5"></a>         <span class="at">measure_env =</span> <span class="fu">factor</span>(measure_env),</span>
<span id="cb41-6"><a href="#cb41-6"></a>         <span class="at">home_env_sns =</span> <span class="fu">factor</span>(home_env_sns)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-7"><a href="#cb41-7"></a>  <span class="co"># we omit the ancestral samples to keep it more balanced</span></span>
<span id="cb41-8"><a href="#cb41-8"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb41-9"><a href="#cb41-9"></a></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="fu">table</span>(balclr_sns<span class="sc">$</span>home_env_sns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
nostrep   strep 
    141     142 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">set.seed</span>(<span class="dv">1567</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a>balclr_sns_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(balclr_sns, <span class="at">strata =</span> home_env_sns)</span>
<span id="cb43-3"><a href="#cb43-3"></a>balclr_sns_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(balclr_sns_split)</span>
<span id="cb43-4"><a href="#cb43-4"></a>balclr_sns_test  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(balclr_sns_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">set.seed</span>(<span class="dv">1568</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a>balclr_sns_folds <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(balclr_sns_train, <span class="at">strata =</span> home_env_sns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="recipe-1" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="recipe-1"><span class="header-section-number">5.3.2</span> Recipe</h3>
<p>Done the same as in <a href="#sec-recipe" class="quarto-xref">Section&nbsp;5.1.2</a> from the 5-class classification.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>balclr_sns_rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(home_env_sns <span class="sc">~</span> ., <span class="at">data =</span> balclr_sns_train) <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(od600, ciliate_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(od600, ciliate_per_ml)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-specifications-1" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="model-specifications-1"><span class="header-section-number">5.3.3</span> Model specifications</h3>
<p>Using the same model specifications as in <a href="#sec-specs" class="quarto-xref">Section&nbsp;5.1.3</a> from the 5-class classification.</p>
</section>
<section id="create-workflow-set-1" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="create-workflow-set-1"><span class="header-section-number">5.3.4</span> Create workflow set</h3>
<p>Same process as in <a href="#sec-wf" class="quarto-xref">Section&nbsp;5.1.4</a> from the 5-class classification.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">library</span>(discrim)</span>
<span id="cb46-2"><a href="#cb46-2"></a></span>
<span id="cb46-3"><a href="#cb46-3"></a>balclr_sns_wf <span class="ot">&lt;-</span> </span>
<span id="cb46-4"><a href="#cb46-4"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_set</span>(</span>
<span id="cb46-5"><a href="#cb46-5"></a>      <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">balclr_sns =</span> balclr_sns_rec), </span>
<span id="cb46-6"><a href="#cb46-6"></a>      <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb46-7"><a href="#cb46-7"></a>        <span class="co">#SVM_radial = svm_r_spec, </span></span>
<span id="cb46-8"><a href="#cb46-8"></a>        <span class="co">#SVM_poly = svm_p_spec, </span></span>
<span id="cb46-9"><a href="#cb46-9"></a>        <span class="co">#CART = cart_spec, </span></span>
<span id="cb46-10"><a href="#cb46-10"></a>        <span class="co">#CART_bagged = bag_cart_spec,</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>        <span class="co">#NNET = nnet_spec,</span></span>
<span id="cb46-12"><a href="#cb46-12"></a>        <span class="at">boosting =</span> xgb_spec,</span>
<span id="cb46-13"><a href="#cb46-13"></a>        <span class="co">#bart = bart_spec, </span></span>
<span id="cb46-14"><a href="#cb46-14"></a>        <span class="co">#fda = fda_spec,</span></span>
<span id="cb46-15"><a href="#cb46-15"></a>        <span class="at">RF =</span> rf_spec</span>
<span id="cb46-16"><a href="#cb46-16"></a>      )</span>
<span id="cb46-17"><a href="#cb46-17"></a>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tune-1" class="level3" data-number="5.3.5">
<h3 data-number="5.3.5" class="anchored" data-anchor-id="tune-1"><span class="header-section-number">5.3.5</span> Tune</h3>
<p>Same as in <a href="#sec-tune" class="quarto-xref">Section&nbsp;5.1.5</a> from the 5-class classification. Warning this takes some time…</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>balclr_sns_grid_results <span class="ot">&lt;-</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_map</span>(balclr_sns_wf, </span>
<span id="cb47-3"><a href="#cb47-3"></a>      <span class="at">seed =</span> <span class="dv">1569</span>,</span>
<span id="cb47-4"><a href="#cb47-4"></a>      <span class="at">resamples =</span> balclr_sns_folds,</span>
<span id="cb47-5"><a href="#cb47-5"></a>      <span class="at">grid =</span> <span class="dv">15</span>,</span>
<span id="cb47-6"><a href="#cb47-6"></a>      <span class="at">control =</span> tune<span class="sc">::</span><span class="fu">control_grid</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">parallel_over =</span> <span class="st">"everything"</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb47-7"><a href="#cb47-7"></a>      <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(recall, precision, f_meas, j_index, accuracy, kap, roc_auc, sens, spec),</span>
<span id="cb47-8"><a href="#cb47-8"></a>   )</span>
<span id="cb47-9"><a href="#cb47-9"></a></span>
<span id="cb47-10"><a href="#cb47-10"></a><span class="co"># save this for later</span></span>
<span id="cb47-11"><a href="#cb47-11"></a>readr<span class="sc">::</span><span class="fu">write_rds</span>(balclr_sns_grid_results, here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_sns.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>balclr_sns_grid_results <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_sns.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="best-tuning-parameters-and-best-performing-models-2" class="level3" data-number="5.3.6">
<h3 data-number="5.3.6" class="anchored" data-anchor-id="best-tuning-parameters-and-best-performing-models-2"><span class="header-section-number">5.3.6</span> Best tuning parameters and best performing models</h3>
<p>First look at which of the models performed best. It appears that based on all metrics the random forest performs the best.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>mymetric <span class="ot">&lt;-</span> <span class="st">"roc_auc"</span></span>
<span id="cb49-2"><a href="#cb49-2"></a></span>
<span id="cb49-3"><a href="#cb49-3"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(</span>
<span id="cb49-4"><a href="#cb49-4"></a>  balclr_sns_grid_results,</span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="at">rank_metric =</span> mymetric,  </span>
<span id="cb49-6"><a href="#cb49-6"></a>  <span class="at">metric =</span> mymetric,       </span>
<span id="cb49-7"><a href="#cb49-7"></a>  <span class="co"># one point per workflow </span></span>
<span id="cb49-8"><a href="#cb49-8"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-12" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Mean and standard deviation across train-test splits of the areas under the receiver operator curves for the different models. boosting = Gradient Boosted Trees Classifier (XGBoost), RF = Random Forest Classifier (Ranger). Rose indicates that synthetic data has been generated using the ROSE algorithm to better balance the classes.
</figcaption>
</figure>
</div>
<section id="peformance-metrics-for-best-model-2" class="level4" data-number="5.3.6.1">
<h4 data-number="5.3.6.1" class="anchored" data-anchor-id="peformance-metrics-for-best-model-2"><span class="header-section-number">5.3.6.1</span> Peformance metrics for best model</h4>
<p>All performance metrics are almost identical (making same overall predictions) with RF just having higher ROC auc</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">set.seed</span>(<span class="dv">4671</span>)</span>
<span id="cb50-2"><a href="#cb50-2"></a>balclr_sns_rf_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_sns_grid_results,</span>
<span id="cb50-3"><a href="#cb50-3"></a>                                           <span class="st">"balclr_sns_RF"</span>,</span>
<span id="cb50-4"><a href="#cb50-4"></a>                                           <span class="st">"roc_auc"</span>,</span>
<span id="cb50-5"><a href="#cb50-5"></a>                                           balclr_sns_split)</span>
<span id="cb50-6"><a href="#cb50-6"></a>balclr_sns_boosting_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_sns_grid_results,</span>
<span id="cb50-7"><a href="#cb50-7"></a>                                                 <span class="st">"balclr_sns_boosting"</span>,</span>
<span id="cb50-8"><a href="#cb50-8"></a>                                                 <span class="st">"roc_auc"</span>,</span>
<span id="cb50-9"><a href="#cb50-9"></a>                                                 balclr_sns_split)</span>
<span id="cb50-10"><a href="#cb50-10"></a></span>
<span id="cb50-11"><a href="#cb50-11"></a><span class="fu">collect_format</span>(balclr_sns_rf_test_results, <span class="st">"random_forest"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-12"><a href="#cb50-12"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">collect_format</span>(balclr_sns_boosting_test_results, <span class="st">"boosting"</span>), <span class="at">by =</span> <span class="fu">join_by</span>(metric, estimate_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-13"><a href="#cb50-13"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(estimate_type, metric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["estimate_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["metric"],"name":[2],"type":["chr"],"align":["left"]},{"label":["random_forest"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["boosting"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"binary","2":"recall","3":"0.8333333","4":"0.8055556"},{"1":"binary","2":"precision","3":"0.8571429","4":"0.8285714"},{"1":"binary","2":"f_meas","3":"0.8450704","4":"0.8169014"},{"1":"binary","2":"j_index","3":"0.6944444","4":"0.6388889"},{"1":"binary","2":"accuracy","3":"0.8472222","4":"0.8194444"},{"1":"binary","2":"kap","3":"0.6944444","4":"0.6388889"},{"1":"binary","2":"sens","3":"0.8333333","4":"0.8055556"},{"1":"binary","2":"spec","3":"0.8611111","4":"0.8333333"},{"1":"binary","2":"roc_auc","3":"0.9027778","4":"0.8533951"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="roc-and-pr-curves-2" class="level4" data-number="5.3.6.2">
<h4 data-number="5.3.6.2" class="anchored" data-anchor-id="roc-and-pr-curves-2"><span class="header-section-number">5.3.6.2</span> ROC and PR curves</h4>
<p>ROC curves indicate that there is good performance for the evolution environments that either contain streptomycin or do not.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>balclr_sns_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3"></a>  yardstick<span class="sc">::</span><span class="fu">roc_curve</span>(home_env_sns, .pred_nostrep) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"FP rate"</span>, <span class="at">y =</span> <span class="st">"TP rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-13" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: ROC curve for True positive rate (TPR, vertical axis) versus the false positive rate (FPR, horizontal axis) for classifying the evolutionary history as either exposed to streptomycin or not in the experiment from the hold-out testing data. The dashed 1:1 line is the expected performance of a random classifier. Curves above the 1:1 are better performance than random. Curves below 1:1 are worse performance than random.
</figcaption>
</figure>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>balclr_sns_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3"></a>  yardstick<span class="sc">::</span><span class="fu">pr_curve</span>(home_env_sns, .pred_nostrep) <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Recall"</span>, <span class="at">y =</span> <span class="st">"Precision"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-14" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Precision recall curves for classifying the evolutionary history as either exposed to streptomycin or not in the experiment from the hold-out testing data. There is a good tuorial for interpretation of these plots on <a href="https://scikit-learn.org/1.5/auto_examples/model_selection/plot_precision_recall.html">scikit-learn</a>.
</figcaption>
</figure>
</div>
</section>
<section id="confusion-matrix-2" class="level4" data-number="5.3.6.3">
<h4 data-number="5.3.6.3" class="anchored" data-anchor-id="confusion-matrix-2"><span class="header-section-number">5.3.6.3</span> Confusion matrix</h4>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>balclr_sns_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3"></a>  yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(home_env_sns, .pred_class) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">"heatmap"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-15" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Confusion matrix showing the classifier performance on each of the two evolutionary history classes (strep exposure or no strep exposure) using the hold-out testing data. (nostrep = bact and bact_pred, strep = bact_strep, bact_pred_strep)
</figcaption>
</figure>
</div>
</section>
<section id="probability-distributions-for-the-2-classes-1" class="level4" data-number="5.3.6.4">
<h4 data-number="5.3.6.4" class="anchored" data-anchor-id="probability-distributions-for-the-2-classes-1"><span class="header-section-number">5.3.6.4</span> Probability distributions for the 2 classes</h4>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>balclr_sns_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred_strep, <span class="at">fill =</span> home_env_sns), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Prediction Probability"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-16" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Prediction probability densities (colors) for each observation of the two evolutionary history classes tested with the model. (nostrep = bact and bact_pred, strep = bact_strep, bact_pred_strep)
</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="classes-predation-history-vs-no-predation-history" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="classes-predation-history-vs-no-predation-history"><span class="header-section-number">5.4</span> 2 classes (predation history vs no predation history)</h2>
<section id="spliting-2" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="spliting-2"><span class="header-section-number">5.4.1</span> Spliting</h3>
<p>Done the same as in <a href="#sec-split" class="quarto-xref">Section&nbsp;5.1.1</a> from the 5-class classification.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>balclr_pnp <span class="ot">&lt;-</span> balclr_md <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>home_env_5c, <span class="sc">-</span>home_env_ae, <span class="sc">-</span>home_env_sns) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb55-4"><a href="#cb55-4"></a>         <span class="at">transfer =</span> <span class="fu">factor</span>(transfer),</span>
<span id="cb55-5"><a href="#cb55-5"></a>         <span class="at">measure_env =</span> <span class="fu">factor</span>(measure_env),</span>
<span id="cb55-6"><a href="#cb55-6"></a>         <span class="at">home_env_pnp =</span> <span class="fu">factor</span>(home_env_pnp)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-7"><a href="#cb55-7"></a>  <span class="co"># we omit the ancestral samples to keep it more balanced</span></span>
<span id="cb55-8"><a href="#cb55-8"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb55-9"><a href="#cb55-9"></a></span>
<span id="cb55-10"><a href="#cb55-10"></a><span class="fu">table</span>(balclr_pnp<span class="sc">$</span>home_env_pnp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
nopred   pred 
   142    141 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">set.seed</span>(<span class="dv">1567</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a>balclr_pnp_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(balclr_pnp, <span class="at">strata =</span> home_env_pnp)</span>
<span id="cb57-3"><a href="#cb57-3"></a>balclr_pnp_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(balclr_pnp_split)</span>
<span id="cb57-4"><a href="#cb57-4"></a>balclr_pnp_test  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(balclr_pnp_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">set.seed</span>(<span class="dv">1568</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a>balclr_pnp_folds <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(balclr_pnp_train, <span class="at">strata =</span> home_env_pnp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="recipe-2" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="recipe-2"><span class="header-section-number">5.4.2</span> Recipe</h3>
<p>Done the same as in <a href="#sec-recipe" class="quarto-xref">Section&nbsp;5.1.2</a> from the 5-class classification.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>balclr_pnp_rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(home_env_pnp <span class="sc">~</span> ., <span class="at">data =</span> balclr_pnp_train) <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(od600, ciliate_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(od600, ciliate_per_ml)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-specifications-2" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="model-specifications-2"><span class="header-section-number">5.4.3</span> Model specifications</h3>
<p>Using the same model specifications as in <a href="#sec-specs" class="quarto-xref">Section&nbsp;5.1.3</a> from the 5-class classification.</p>
</section>
<section id="create-workflow-set-2" class="level3" data-number="5.4.4">
<h3 data-number="5.4.4" class="anchored" data-anchor-id="create-workflow-set-2"><span class="header-section-number">5.4.4</span> Create workflow set</h3>
<p>Same process as in <a href="#sec-wf" class="quarto-xref">Section&nbsp;5.1.4</a> from the 5-class classification.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>balclr_pnp_wf <span class="ot">&lt;-</span> </span>
<span id="cb60-2"><a href="#cb60-2"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_set</span>(</span>
<span id="cb60-3"><a href="#cb60-3"></a>      <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">balclr_pnp =</span> balclr_pnp_rec), </span>
<span id="cb60-4"><a href="#cb60-4"></a>      <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb60-5"><a href="#cb60-5"></a>        <span class="co">#SVM_radial = svm_r_spec, </span></span>
<span id="cb60-6"><a href="#cb60-6"></a>        <span class="co">#SVM_poly = svm_p_spec, </span></span>
<span id="cb60-7"><a href="#cb60-7"></a>        <span class="co">#CART = cart_spec, </span></span>
<span id="cb60-8"><a href="#cb60-8"></a>        <span class="co">#CART_bagged = bag_cart_spec,</span></span>
<span id="cb60-9"><a href="#cb60-9"></a>        <span class="co">#NNET = nnet_spec,</span></span>
<span id="cb60-10"><a href="#cb60-10"></a>        <span class="at">boosting =</span> xgb_spec,</span>
<span id="cb60-11"><a href="#cb60-11"></a>        <span class="co">#bart = bart_spec, </span></span>
<span id="cb60-12"><a href="#cb60-12"></a>        <span class="co">#fda = fda_spec,</span></span>
<span id="cb60-13"><a href="#cb60-13"></a>        <span class="at">RF =</span> rf_spec</span>
<span id="cb60-14"><a href="#cb60-14"></a>      )</span>
<span id="cb60-15"><a href="#cb60-15"></a>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tune-2" class="level3" data-number="5.4.5">
<h3 data-number="5.4.5" class="anchored" data-anchor-id="tune-2"><span class="header-section-number">5.4.5</span> Tune</h3>
<p>Same as in <a href="#sec-tune" class="quarto-xref">Section&nbsp;5.1.5</a> from the 5-class classification. Warning this takes some time…</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>balclr_pnp_grid_results <span class="ot">&lt;-</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_map</span>(balclr_pnp_wf, </span>
<span id="cb61-3"><a href="#cb61-3"></a>      <span class="at">seed =</span> <span class="dv">1569</span>,</span>
<span id="cb61-4"><a href="#cb61-4"></a>      <span class="at">resamples =</span> balclr_pnp_folds,</span>
<span id="cb61-5"><a href="#cb61-5"></a>      <span class="at">grid =</span> <span class="dv">25</span>,</span>
<span id="cb61-6"><a href="#cb61-6"></a>      <span class="at">control =</span> tune<span class="sc">::</span><span class="fu">control_grid</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">parallel_over =</span> <span class="st">"everything"</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-7"><a href="#cb61-7"></a>      <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(recall, precision, f_meas, j_index, accuracy, kap, roc_auc, sens, spec),</span>
<span id="cb61-8"><a href="#cb61-8"></a>   )</span>
<span id="cb61-9"><a href="#cb61-9"></a></span>
<span id="cb61-10"><a href="#cb61-10"></a><span class="co"># save this for later</span></span>
<span id="cb61-11"><a href="#cb61-11"></a>readr<span class="sc">::</span><span class="fu">write_rds</span>(balclr_pnp_grid_results, here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_pnp.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>balclr_pnp_grid_results <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_pnp.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="best-tuning-parameters-and-best-performing-models-3" class="level3" data-number="5.4.6">
<h3 data-number="5.4.6" class="anchored" data-anchor-id="best-tuning-parameters-and-best-performing-models-3"><span class="header-section-number">5.4.6</span> Best tuning parameters and best performing models</h3>
<p>First look at which of the models performed best. It appears that based on all metrics the random forest performs the best.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>mymetric <span class="ot">&lt;-</span> <span class="st">"roc_auc"</span></span>
<span id="cb63-2"><a href="#cb63-2"></a></span>
<span id="cb63-3"><a href="#cb63-3"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(</span>
<span id="cb63-4"><a href="#cb63-4"></a>  balclr_pnp_grid_results,</span>
<span id="cb63-5"><a href="#cb63-5"></a>  <span class="at">rank_metric =</span> mymetric,  </span>
<span id="cb63-6"><a href="#cb63-6"></a>  <span class="at">metric =</span> mymetric,       </span>
<span id="cb63-7"><a href="#cb63-7"></a>  <span class="co"># one point per workflow </span></span>
<span id="cb63-8"><a href="#cb63-8"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-17" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Mean and standard deviation across train-test splits of the areas under the receiver operator curves for the different models. boosting = Gradient Boosted Trees Classifier (XGBoost), RF = Random Forest Classifier (Ranger).
</figcaption>
</figure>
</div>
<section id="peformance-metrics-for-best-model-3" class="level4" data-number="5.4.6.1">
<h4 data-number="5.4.6.1" class="anchored" data-anchor-id="peformance-metrics-for-best-model-3"><span class="header-section-number">5.4.6.1</span> Peformance metrics for best model</h4>
<p>Clearly here random forest is doing better</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">set.seed</span>(<span class="dv">87605</span>)</span>
<span id="cb64-2"><a href="#cb64-2"></a>balclr_pnp_boosting_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_pnp_grid_results,</span>
<span id="cb64-3"><a href="#cb64-3"></a>                                                 <span class="st">"balclr_pnp_boosting"</span>,</span>
<span id="cb64-4"><a href="#cb64-4"></a>                                                 <span class="st">"j_index"</span>,</span>
<span id="cb64-5"><a href="#cb64-5"></a>                                                 balclr_pnp_split)</span>
<span id="cb64-6"><a href="#cb64-6"></a></span>
<span id="cb64-7"><a href="#cb64-7"></a>balclr_pnp_rf_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_pnp_grid_results,</span>
<span id="cb64-8"><a href="#cb64-8"></a>                                           <span class="st">"balclr_pnp_RF"</span>,</span>
<span id="cb64-9"><a href="#cb64-9"></a>                                           <span class="st">"j_index"</span>,</span>
<span id="cb64-10"><a href="#cb64-10"></a>                                           balclr_pnp_split)</span>
<span id="cb64-11"><a href="#cb64-11"></a></span>
<span id="cb64-12"><a href="#cb64-12"></a><span class="fu">collect_format</span>(balclr_pnp_rf_test_results, <span class="st">"random_forest"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-13"><a href="#cb64-13"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">collect_format</span>(balclr_pnp_boosting_test_results, <span class="st">"boosting"</span>), <span class="at">by =</span> <span class="fu">join_by</span>(metric, estimate_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-14"><a href="#cb64-14"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(estimate_type, metric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["estimate_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["metric"],"name":[2],"type":["chr"],"align":["left"]},{"label":["random_forest"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["boosting"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"binary","2":"recall","3":"0.8333333","4":"0.8055556"},{"1":"binary","2":"precision","3":"0.7894737","4":"0.7250000"},{"1":"binary","2":"f_meas","3":"0.8108108","4":"0.7631579"},{"1":"binary","2":"j_index","3":"0.6111111","4":"0.5000000"},{"1":"binary","2":"accuracy","3":"0.8055556","4":"0.7500000"},{"1":"binary","2":"kap","3":"0.6111111","4":"0.5000000"},{"1":"binary","2":"sens","3":"0.8333333","4":"0.8055556"},{"1":"binary","2":"spec","3":"0.7777778","4":"0.6944444"},{"1":"binary","2":"roc_auc","3":"0.8865741","4":"0.8433642"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="roc-and-pr-curves-3" class="level4" data-number="5.4.6.2">
<h4 data-number="5.4.6.2" class="anchored" data-anchor-id="roc-and-pr-curves-3"><span class="header-section-number">5.4.6.2</span> ROC and PR curves</h4>
<p>ROC curves indicate that there is good performance for the evolution environments that either contain streptomycin or do not.</p>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>balclr_pnp_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>  yardstick<span class="sc">::</span><span class="fu">roc_curve</span>(home_env_pnp, .pred_nopred) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"FP rate"</span>, <span class="at">y =</span> <span class="st">"TP rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-18" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: ROC curve for True positive rate (TPR, vertical axis) versus the false positive rate (FPR, horizontal axis) for classifying the evolutionary history as either exposed to predator or not in the experiment from the hold-out testing data. The dashed 1:1 line is the expected performance of a random classifier. Curves above the 1:1 are better performance than random. Curves below 1:1 are worse performance than random.
</figcaption>
</figure>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>balclr_pnp_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3"></a>  yardstick<span class="sc">::</span><span class="fu">pr_curve</span>(home_env_pnp, .pred_nopred) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Recall"</span>, <span class="at">y =</span> <span class="st">"Precision"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-19" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-19-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-19-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19: Precision recall curves for classifying the YSK evolutionary history as either exposed to predator or not in the experiment from the hold-out testing data. There is a good tutorial for interpretation of these plots on <a href="https://scikit-learn.org/1.5/auto_examples/model_selection/plot_precision_recall.html">scikit-learn</a>.
</figcaption>
</figure>
</div>
</section>
<section id="confusion-matrix-3" class="level4" data-number="5.4.6.3">
<h4 data-number="5.4.6.3" class="anchored" data-anchor-id="confusion-matrix-3"><span class="header-section-number">5.4.6.3</span> Confusion matrix</h4>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>balclr_pnp_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3"></a>  yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(home_env_pnp, .pred_class) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">"heatmap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-20" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20: Confusion matrix showing the classifier performance on each of the two evolutionary history classes (predator exposure or no predator exposure) using the hold-out testing data. (nospred = bact and bact_strep, pred = bact_pred, bact_pred_strep)
</figcaption>
</figure>
</div>
</section>
<section id="probability-distributions-for-the-2-classes-2" class="level4" data-number="5.4.6.4">
<h4 data-number="5.4.6.4" class="anchored" data-anchor-id="probability-distributions-for-the-2-classes-2"><span class="header-section-number">5.4.6.4</span> Probability distributions for the 2 classes</h4>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>balclr_pnp_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb68-4"><a href="#cb68-4"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred_pred, <span class="at">fill =</span> home_env_pnp), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb68-5"><a href="#cb68-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Prediction Probability"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-21" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01_machine_learn_home_env_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21: Prediction probability densities (colors) for each observation of the two evolutionary history classes tested with the model. (nopred = bact and bact_strep, pred = bact_pred, bact_pred_strep)
</figcaption>
</figure>
</div>


<!-- -->

</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb69" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb69-1"><a href="#cb69-1"></a><span class="co">---</span></span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="an">title:</span><span class="co"> "Predator and STR Community species composition workflow iii) prediction of evolution environment from measurement environment"</span></span>
<span id="cb69-3"><a href="#cb69-3"></a><span class="an">author:</span><span class="co"> "Shane Hogle"</span></span>
<span id="cb69-4"><a href="#cb69-4"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb69-5"><a href="#cb69-5"></a><span class="an">link-citations:</span><span class="co"> true</span></span>
<span id="cb69-6"><a href="#cb69-6"></a><span class="co">---</span></span>
<span id="cb69-7"><a href="#cb69-7"></a></span>
<span id="cb69-8"><a href="#cb69-8"></a><span class="fu"># Setup </span></span>
<span id="cb69-9"><a href="#cb69-9"></a></span>
<span id="cb69-10"><a href="#cb69-10"></a>Loads required libraries and sets global variables</span>
<span id="cb69-11"><a href="#cb69-11"></a></span>
<span id="cb69-14"><a href="#cb69-14"></a><span class="in">```{r}</span></span>
<span id="cb69-15"><a href="#cb69-15"></a><span class="co">#| output: false</span></span>
<span id="cb69-16"><a href="#cb69-16"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb69-17"><a href="#cb69-17"></a><span class="fu">library</span>(here)</span>
<span id="cb69-18"><a href="#cb69-18"></a><span class="fu">library</span>(fs)</span>
<span id="cb69-19"><a href="#cb69-19"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils_generic.R"</span>))</span>
<span id="cb69-20"><a href="#cb69-20"></a><span class="in">```</span></span>
<span id="cb69-21"><a href="#cb69-21"></a></span>
<span id="cb69-22"><a href="#cb69-22"></a><span class="fu"># Read</span></span>
<span id="cb69-23"><a href="#cb69-23"></a></span>
<span id="cb69-24"><a href="#cb69-24"></a>Read and format 16S amplicon data</span>
<span id="cb69-25"><a href="#cb69-25"></a></span>
<span id="cb69-28"><a href="#cb69-28"></a><span class="in">```{r}</span></span>
<span id="cb69-29"><a href="#cb69-29"></a><span class="co">#| output: false</span></span>
<span id="cb69-30"><a href="#cb69-30"></a><span class="co">#| warning: false</span></span>
<span id="cb69-31"><a href="#cb69-31"></a>sptable <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_sp, <span class="st">"species_counts_md.tsv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-32"><a href="#cb69-32"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">transfer =</span> day<span class="sc">/</span><span class="dv">7</span>)</span>
<span id="cb69-33"><a href="#cb69-33"></a></span>
<span id="cb69-34"><a href="#cb69-34"></a>counts_f <span class="ot">&lt;-</span> sptable <span class="sc">%&gt;%</span> </span>
<span id="cb69-35"><a href="#cb69-35"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb69-36"><a href="#cb69-36"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">f=</span>count_correct<span class="sc">/</span><span class="fu">sum</span>(count_correct)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-37"><a href="#cb69-37"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-38"><a href="#cb69-38"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">measure_env_short =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(measure_env <span class="sc">==</span> <span class="st">"bact"</span> <span class="sc">~</span> <span class="st">"Meas: B"</span>,</span>
<span id="cb69-39"><a href="#cb69-39"></a>                                       measure_env <span class="sc">==</span> <span class="st">"bact_pred"</span> <span class="sc">~</span> <span class="st">"Meas: BP"</span>,</span>
<span id="cb69-40"><a href="#cb69-40"></a>                                       measure_env <span class="sc">==</span> <span class="st">"bact_strep"</span> <span class="sc">~</span> <span class="st">"Meas: BS"</span>,</span>
<span id="cb69-41"><a href="#cb69-41"></a>                                       measure_env <span class="sc">==</span> <span class="st">"bact_pred_strep"</span> <span class="sc">~</span> <span class="st">"Meas: BPS"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-42"><a href="#cb69-42"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">home_env_short =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(evolution_env <span class="sc">==</span> <span class="st">"anc"</span> <span class="sc">~</span> <span class="st">"Home: Anc"</span>,</span>
<span id="cb69-43"><a href="#cb69-43"></a>                                    evolution_env <span class="sc">==</span> <span class="st">"bact"</span> <span class="sc">~</span> <span class="st">"Home: B"</span>,</span>
<span id="cb69-44"><a href="#cb69-44"></a>                                    evolution_env <span class="sc">==</span> <span class="st">"bact_pred"</span> <span class="sc">~</span> <span class="st">"Home: BP"</span>,</span>
<span id="cb69-45"><a href="#cb69-45"></a>                                    evolution_env <span class="sc">==</span> <span class="st">"bact_strep"</span> <span class="sc">~</span> <span class="st">"Home: BS"</span>,</span>
<span id="cb69-46"><a href="#cb69-46"></a>                                    evolution_env <span class="sc">==</span> <span class="st">"bact_pred_strep"</span> <span class="sc">~</span> <span class="st">"Home: BPS"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-47"><a href="#cb69-47"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">measure_env_short =</span> <span class="fu">factor</span>(measure_env_short, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Meas: B"</span>, <span class="st">"Meas: BP"</span>, <span class="st">"Meas: BS"</span>, <span class="st">"Meas: BPS"</span>)),</span>
<span id="cb69-48"><a href="#cb69-48"></a>         <span class="at">home_env_short =</span> <span class="fu">factor</span>(home_env_short, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Home: Anc"</span>, <span class="st">"Home: B"</span>, <span class="st">"Home: BP"</span>, <span class="st">"Home: BS"</span>, <span class="st">"Home: BPS"</span>)),</span>
<span id="cb69-49"><a href="#cb69-49"></a>         <span class="at">day =</span> <span class="fu">factor</span>(day),</span>
<span id="cb69-50"><a href="#cb69-50"></a>         <span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb69-51"><a href="#cb69-51"></a>         <span class="at">strainID =</span> <span class="fu">factor</span>(strainID, <span class="at">levels =</span> <span class="fu">names</span>(hambi_colors)))</span>
<span id="cb69-52"><a href="#cb69-52"></a><span class="in">```</span></span>
<span id="cb69-53"><a href="#cb69-53"></a></span>
<span id="cb69-54"><a href="#cb69-54"></a>Read population density data</span>
<span id="cb69-55"><a href="#cb69-55"></a></span>
<span id="cb69-58"><a href="#cb69-58"></a><span class="in">```{r}</span></span>
<span id="cb69-59"><a href="#cb69-59"></a><span class="co">#| output: false</span></span>
<span id="cb69-60"><a href="#cb69-60"></a><span class="co">#| warning: false</span></span>
<span id="cb69-61"><a href="#cb69-61"></a>celldens <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"density4ML.tsv"</span>))</span>
<span id="cb69-62"><a href="#cb69-62"></a><span class="in">```</span></span>
<span id="cb69-63"><a href="#cb69-63"></a></span>
<span id="cb69-64"><a href="#cb69-64"></a><span class="fu"># Data formatting</span></span>
<span id="cb69-65"><a href="#cb69-65"></a></span>
<span id="cb69-66"><a href="#cb69-66"></a>Separate the samples to only include those from the experiment. These are the samples that will be used in the machine learning pipeline</span>
<span id="cb69-67"><a href="#cb69-67"></a></span>
<span id="cb69-70"><a href="#cb69-70"></a><span class="in">```{r}</span></span>
<span id="cb69-71"><a href="#cb69-71"></a><span class="co"># these are communities of a (supposedly) known composition. Can be used with metacal</span></span>
<span id="cb69-72"><a href="#cb69-72"></a>pos_ctrl_samples <span class="ot">&lt;-</span> counts_f <span class="sc">%&gt;%</span> </span>
<span id="cb69-73"><a href="#cb69-73"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(sample, <span class="st">"pos_ctrl"</span>))</span>
<span id="cb69-74"><a href="#cb69-74"></a></span>
<span id="cb69-75"><a href="#cb69-75"></a><span class="co"># these are samples taken directly from YSK and represent the composition of the communities used to start the experiment</span></span>
<span id="cb69-76"><a href="#cb69-76"></a>t0_samples <span class="ot">&lt;-</span> counts_f <span class="sc">%&gt;%</span> </span>
<span id="cb69-77"><a href="#cb69-77"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(sample, <span class="st">"pos_ctrl"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-78"><a href="#cb69-78"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(day <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb69-79"><a href="#cb69-79"></a></span>
<span id="cb69-80"><a href="#cb69-80"></a><span class="co"># only samples from the experiment</span></span>
<span id="cb69-81"><a href="#cb69-81"></a>counts_f_experiment <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(counts_f, pos_ctrl_samples, </span>
<span id="cb69-82"><a href="#cb69-82"></a>                                 <span class="at">by =</span> <span class="fu">join_by</span>(sample, strainID, genus, species, count, count_correct, replicate, </span>
<span id="cb69-83"><a href="#cb69-83"></a>                                              day, measure_env, evolution_env, transfer, f, </span>
<span id="cb69-84"><a href="#cb69-84"></a>                                              measure_env_short, home_env_short)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-85"><a href="#cb69-85"></a>  dplyr<span class="sc">::</span><span class="fu">anti_join</span>(., t0_samples,</span>
<span id="cb69-86"><a href="#cb69-86"></a>                   <span class="at">by =</span> <span class="fu">join_by</span>(sample, strainID, genus, species, count, count_correct, replicate, </span>
<span id="cb69-87"><a href="#cb69-87"></a>                                              day, measure_env, evolution_env, transfer, f, </span>
<span id="cb69-88"><a href="#cb69-88"></a>                                              measure_env_short, home_env_short)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-89"><a href="#cb69-89"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">measure_env_short =</span> <span class="fu">factor</span>(measure_env_short, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Meas: B"</span>, <span class="st">"Meas: BP"</span>, <span class="st">"Meas: BS"</span>, <span class="st">"Meas: BPS"</span>)),</span>
<span id="cb69-90"><a href="#cb69-90"></a>         <span class="at">home_env_short =</span> <span class="fu">factor</span>(home_env_short, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Home: Anc"</span>, <span class="st">"Home: B"</span>, <span class="st">"Home: BP"</span>, <span class="st">"Home: BS"</span>, <span class="st">"Home: BPS"</span>)),</span>
<span id="cb69-91"><a href="#cb69-91"></a>         <span class="at">day =</span> <span class="fu">factor</span>(day),</span>
<span id="cb69-92"><a href="#cb69-92"></a>         <span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb69-93"><a href="#cb69-93"></a>         <span class="at">strainID =</span> <span class="fu">factor</span>(strainID, <span class="at">levels =</span> <span class="fu">names</span>(hambi_colors)))</span>
<span id="cb69-94"><a href="#cb69-94"></a><span class="in">```</span></span>
<span id="cb69-95"><a href="#cb69-95"></a></span>
<span id="cb69-96"><a href="#cb69-96"></a><span class="fu"># Data normalization</span></span>
<span id="cb69-97"><a href="#cb69-97"></a></span>
<span id="cb69-98"><a href="#cb69-98"></a>Here we'll use the same filtering criteria as in <span class="co">[</span><span class="ot">the t-SNE analysis from section 3 of the last analysis.</span><span class="co">](../amplicon_sp_counts/02_composition_analysis.qmd)</span></span>
<span id="cb69-99"><a href="#cb69-99"></a></span>
<span id="cb69-102"><a href="#cb69-102"></a><span class="in">```{r}</span></span>
<span id="cb69-103"><a href="#cb69-103"></a>counts_f_experiment <span class="sc">%&gt;%</span> </span>
<span id="cb69-104"><a href="#cb69-104"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb69-105"><a href="#cb69-105"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">n_samples =</span> <span class="fu">n</span>(),</span>
<span id="cb69-106"><a href="#cb69-106"></a>            <span class="at">n_gt0 =</span> <span class="fu">sum</span>(count <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb69-107"><a href="#cb69-107"></a>            <span class="at">p_gt0 =</span> n_gt0 <span class="sc">/</span> n_samples) <span class="sc">%&gt;%</span> </span>
<span id="cb69-108"><a href="#cb69-108"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-109"><a href="#cb69-109"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(n_gt0)</span>
<span id="cb69-110"><a href="#cb69-110"></a><span class="in">```</span></span>
<span id="cb69-111"><a href="#cb69-111"></a></span>
<span id="cb69-112"><a href="#cb69-112"></a>Briefly, we will use the <span class="co">[</span><span class="ot">centered log-ratio transformation</span><span class="co">](https://en.wikipedia.org/wiki/Compositional_data#Center_log_ratio_transform)</span> for the species abundances. The centered log-ratio can be interpreted as the log-fold change of species i relative to the average microbe in a sample. The formula for the transformation is:</span>
<span id="cb69-113"><a href="#cb69-113"></a></span>
<span id="cb69-114"><a href="#cb69-114"></a>$$</span>
<span id="cb69-115"><a href="#cb69-115"></a>\text{clr}(\mathbf x)= \left(log</span>
<span id="cb69-116"><a href="#cb69-116"></a>\frac{x_i}{g(\mathbf x)} \right)_{i=1,...,D} \qquad \text{with} \quad</span>
<span id="cb69-117"><a href="#cb69-117"></a>g(\mathbf x) = \left(\prod_{i=1}^Dx_i\right)^{1/D} =</span>
<span id="cb69-118"><a href="#cb69-118"></a>\exp\left(\frac{1}{D}\sum_{i=1}^D \log x_i\right)\text{,}</span>
<span id="cb69-119"><a href="#cb69-119"></a>$$</span>
<span id="cb69-120"><a href="#cb69-120"></a></span>
<span id="cb69-121"><a href="#cb69-121"></a>We will use the implementation of centered log-ratio transform in the <span class="in">`compositions`</span> package</span>
<span id="cb69-122"><a href="#cb69-122"></a></span>
<span id="cb69-125"><a href="#cb69-125"></a><span class="in">```{r}</span></span>
<span id="cb69-126"><a href="#cb69-126"></a><span class="fu">set.seed</span>(<span class="dv">12353</span>)</span>
<span id="cb69-127"><a href="#cb69-127"></a></span>
<span id="cb69-128"><a href="#cb69-128"></a>lowstrainsv <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb69-129"><a href="#cb69-129"></a>  <span class="st">"HAMBI_0097"</span>,</span>
<span id="cb69-130"><a href="#cb69-130"></a>  <span class="st">"HAMBI_2792"</span></span>
<span id="cb69-131"><a href="#cb69-131"></a>)</span>
<span id="cb69-132"><a href="#cb69-132"></a></span>
<span id="cb69-133"><a href="#cb69-133"></a>mymat <span class="ot">&lt;-</span> counts_f_experiment <span class="sc">%&gt;%</span> </span>
<span id="cb69-134"><a href="#cb69-134"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>(strainID <span class="sc">%in%</span> lowstrainsv)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-135"><a href="#cb69-135"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample, strainID, count) <span class="sc">%&gt;%</span> </span>
<span id="cb69-136"><a href="#cb69-136"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">count =</span> count <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-137"><a href="#cb69-137"></a>  <span class="co"># important to arrange by sample as this makes some later joins easier</span></span>
<span id="cb69-138"><a href="#cb69-138"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb69-139"><a href="#cb69-139"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"strainID"</span>, <span class="at">values_from =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-140"><a href="#cb69-140"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">"sample"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-141"><a href="#cb69-141"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb69-142"><a href="#cb69-142"></a></span>
<span id="cb69-143"><a href="#cb69-143"></a><span class="co"># calculate clr transform</span></span>
<span id="cb69-144"><a href="#cb69-144"></a>balclr <span class="ot">&lt;-</span> compositions<span class="sc">::</span><span class="fu">clr</span>(mymat)</span>
<span id="cb69-145"><a href="#cb69-145"></a><span class="in">```</span></span>
<span id="cb69-146"><a href="#cb69-146"></a></span>
<span id="cb69-147"><a href="#cb69-147"></a><span class="fu"># Machine learning the home environment</span></span>
<span id="cb69-148"><a href="#cb69-148"></a></span>
<span id="cb69-149"><a href="#cb69-149"></a>The goal is to see if we can reliably predict which home environment a community came from (either ancestral clonal, or co-evolved in YSK) using only the species abundances, knowledge of the experiment structure (e.g., replicate and experimental transfer), and the measurement environment. The motivation behind this is that if we can learn the evolutionary home environment there must be some kind of "ecological signal" embedded in the community data that is a function of the evolutionary home environment. We are using machine learning approaches because they are flexible, powerful, and we are most interested in prediction. We care less about which features/variables are driving the signal...</span>
<span id="cb69-150"><a href="#cb69-150"></a></span>
<span id="cb69-151"><a href="#cb69-151"></a>Load the <span class="in">`tidymodels`</span> ecosystem. We are using <span class="co">[</span><span class="ot">`tidymodels`</span><span class="co">](https://www.tidymodels.org/)</span> because it allows us to work with familiar <span class="in">`tidyverse`</span> syntax while making sure we adhere to best practices in training and assessing the performance of machine learning models.</span>
<span id="cb69-152"><a href="#cb69-152"></a></span>
<span id="cb69-155"><a href="#cb69-155"></a><span class="in">```{r}</span></span>
<span id="cb69-156"><a href="#cb69-156"></a><span class="co">#| output: false</span></span>
<span id="cb69-157"><a href="#cb69-157"></a><span class="co">#| warning: false</span></span>
<span id="cb69-158"><a href="#cb69-158"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb69-159"><a href="#cb69-159"></a><span class="fu">library</span>(discrim)</span>
<span id="cb69-160"><a href="#cb69-160"></a><span class="fu">library</span>(themis)</span>
<span id="cb69-161"><a href="#cb69-161"></a><span class="fu">tidymodels_prefer</span>()</span>
<span id="cb69-162"><a href="#cb69-162"></a><span class="in">```</span></span>
<span id="cb69-163"><a href="#cb69-163"></a></span>
<span id="cb69-164"><a href="#cb69-164"></a>First doing some basic data preparations. We will create some additional classification structures that we will investigate further below</span>
<span id="cb69-165"><a href="#cb69-165"></a></span>
<span id="cb69-168"><a href="#cb69-168"></a><span class="in">```{r}</span></span>
<span id="cb69-169"><a href="#cb69-169"></a>balclr_md <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(balclr) <span class="sc">%&gt;%</span></span>
<span id="cb69-170"><a href="#cb69-170"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"sample"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-171"><a href="#cb69-171"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">distinct</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(counts_f_experiment, sample, replicate, </span>
<span id="cb69-172"><a href="#cb69-172"></a>                                          transfer, measure_env, evolution_env)), <span class="at">by =</span> <span class="fu">join_by</span>(sample)) <span class="sc">%&gt;%</span></span>
<span id="cb69-173"><a href="#cb69-173"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(celldens, <span class="at">by =</span> <span class="fu">join_by</span>(replicate, transfer, measure_env, evolution_env)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-174"><a href="#cb69-174"></a>  <span class="co">#dplyr::filter(measure_env != evolution_env) %&gt;% </span></span>
<span id="cb69-175"><a href="#cb69-175"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb69-176"><a href="#cb69-176"></a>         <span class="at">transfer =</span> <span class="fu">factor</span>(transfer),</span>
<span id="cb69-177"><a href="#cb69-177"></a>         <span class="at">measure_env =</span> <span class="fu">factor</span>(measure_env),</span>
<span id="cb69-178"><a href="#cb69-178"></a>         <span class="co">#home_env_5c = factor(if_else(evolution_env == "anc", NA_character_, evolution_env)),</span></span>
<span id="cb69-179"><a href="#cb69-179"></a>         <span class="at">home_env_5c =</span> <span class="fu">factor</span>(evolution_env),</span>
<span id="cb69-180"><a href="#cb69-180"></a>         <span class="at">home_env_ae =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(evolution_env <span class="sc">==</span> <span class="st">"anc"</span>, <span class="st">"anc"</span>, <span class="st">"evo"</span>)),</span>
<span id="cb69-181"><a href="#cb69-181"></a>         <span class="at">home_env_sns =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(evolution_env <span class="sc">==</span> <span class="st">"bact_strep"</span> <span class="sc">|</span> evolution_env <span class="sc">==</span> <span class="st">"bact_pred_strep"</span> <span class="sc">~</span> <span class="st">"strep"</span>, </span>
<span id="cb69-182"><a href="#cb69-182"></a>                                         evolution_env <span class="sc">==</span> <span class="st">"anc"</span> <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb69-183"><a href="#cb69-183"></a>                                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"nostrep"</span>)),</span>
<span id="cb69-184"><a href="#cb69-184"></a>         <span class="at">home_env_pnp =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(evolution_env <span class="sc">==</span> <span class="st">"bact_pred"</span> <span class="sc">|</span> evolution_env <span class="sc">==</span> <span class="st">"bact_pred_strep"</span> <span class="sc">~</span> <span class="st">"pred"</span>, </span>
<span id="cb69-185"><a href="#cb69-185"></a>                                         evolution_env <span class="sc">==</span> <span class="st">"anc"</span> <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb69-186"><a href="#cb69-186"></a>                                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"nopred"</span>))) <span class="sc">%&gt;%</span>  </span>
<span id="cb69-187"><a href="#cb69-187"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>sample, <span class="sc">-</span>evolution_env)</span>
<span id="cb69-188"><a href="#cb69-188"></a><span class="in">```</span></span>
<span id="cb69-189"><a href="#cb69-189"></a></span>
<span id="cb69-190"><a href="#cb69-190"></a><span class="fu">## 5 classes (ancesteral, B, BP, BS, and BPS)</span></span>
<span id="cb69-191"><a href="#cb69-191"></a></span>
<span id="cb69-192"><a href="#cb69-192"></a>First were going to try and predict all 5 different home evolution environments</span>
<span id="cb69-193"><a href="#cb69-193"></a></span>
<span id="cb69-194"><a href="#cb69-194"></a><span class="fu">### Spliting {#sec-split}</span></span>
<span id="cb69-195"><a href="#cb69-195"></a></span>
<span id="cb69-196"><a href="#cb69-196"></a>Split the data using the default 3:1 ratio of training-to-test. Here we also set the strata argument. This argument makes sure that both sides of the split have roughly the same distribution for each value of strata. If a numeric variable is passed to strata then it is binned and distributions are matched within bins. In this case there will be roughly the same distribution of the 5 classes within each side of the test/train split.</span>
<span id="cb69-197"><a href="#cb69-197"></a></span>
<span id="cb69-200"><a href="#cb69-200"></a><span class="in">```{r}</span></span>
<span id="cb69-201"><a href="#cb69-201"></a>balclr_5c <span class="ot">&lt;-</span> balclr_md <span class="sc">%&gt;%</span> </span>
<span id="cb69-202"><a href="#cb69-202"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>home_env_ae, <span class="sc">-</span>home_env_sns, <span class="sc">-</span>home_env_pnp) <span class="sc">%&gt;%</span> </span>
<span id="cb69-203"><a href="#cb69-203"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb69-204"><a href="#cb69-204"></a></span>
<span id="cb69-205"><a href="#cb69-205"></a><span class="fu">table</span>(balclr_5c<span class="sc">$</span>home_env_5c)</span>
<span id="cb69-206"><a href="#cb69-206"></a><span class="in">```</span></span>
<span id="cb69-207"><a href="#cb69-207"></a></span>
<span id="cb69-208"><a href="#cb69-208"></a>The data is balanced</span>
<span id="cb69-209"><a href="#cb69-209"></a></span>
<span id="cb69-212"><a href="#cb69-212"></a><span class="in">```{r}</span></span>
<span id="cb69-213"><a href="#cb69-213"></a><span class="fu">set.seed</span>(<span class="dv">1501</span>)</span>
<span id="cb69-214"><a href="#cb69-214"></a>balclr_5c_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(balclr_5c, <span class="at">strata =</span> home_env_5c)</span>
<span id="cb69-215"><a href="#cb69-215"></a>balclr_5c_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(balclr_5c_split)</span>
<span id="cb69-216"><a href="#cb69-216"></a>balclr_5c_test  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(balclr_5c_split)</span>
<span id="cb69-217"><a href="#cb69-217"></a><span class="in">```</span></span>
<span id="cb69-218"><a href="#cb69-218"></a></span>
<span id="cb69-219"><a href="#cb69-219"></a>Resample the training set using five repeats of 10-fold cross-validation</span>
<span id="cb69-220"><a href="#cb69-220"></a></span>
<span id="cb69-223"><a href="#cb69-223"></a><span class="in">```{r}</span></span>
<span id="cb69-224"><a href="#cb69-224"></a><span class="fu">set.seed</span>(<span class="dv">1502</span>)</span>
<span id="cb69-225"><a href="#cb69-225"></a>balclr_5c_folds <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(balclr_5c_train, <span class="at">strata =</span> home_env_5c)</span>
<span id="cb69-226"><a href="#cb69-226"></a><span class="in">```</span></span>
<span id="cb69-227"><a href="#cb69-227"></a></span>
<span id="cb69-228"><a href="#cb69-228"></a><span class="fu">### Recipe {#sec-recipe}</span></span>
<span id="cb69-229"><a href="#cb69-229"></a></span>
<span id="cb69-230"><a href="#cb69-230"></a>First we need to preprocess the data so that it is in optimal format for Ml. Some useful steps include:</span>
<span id="cb69-231"><a href="#cb69-231"></a></span>
<span id="cb69-232"><a href="#cb69-232"></a><span class="ss">- </span><span class="in">`step_novel():`</span> converts all nominal variables to factors and takes care of other issues related to categorical variables.</span>
<span id="cb69-233"><a href="#cb69-233"></a><span class="ss">- </span><span class="in">`step_normalize():`</span> normalizes (center and scales) the numeric variables to have a standard deviation of one and a mean of zero. (i.e., z-standardization).</span>
<span id="cb69-234"><a href="#cb69-234"></a><span class="ss">- </span><span class="in">`step_dummy():`</span> converts our factor column ocean_proximity into numeric binary (0 and 1) variables.</span>
<span id="cb69-235"><a href="#cb69-235"></a><span class="ss">  - </span>Note that this step may cause problems if your categorical variable has too many levels - especially if some of the levels are very infrequent. In this case you should either drop the variable or pool infrequently occurring values into an “other” category with step_other. This steps has to be performed before step_dummy.</span>
<span id="cb69-236"><a href="#cb69-236"></a><span class="ss">- </span><span class="in">`step_zv():`</span> removes any numeric variables that have zero variance.</span>
<span id="cb69-237"><a href="#cb69-237"></a><span class="ss">- </span><span class="in">`step_corr():`</span> will remove predictor variables that have large correlations with other predictor variables.</span>
<span id="cb69-238"><a href="#cb69-238"></a></span>
<span id="cb69-239"><a href="#cb69-239"></a>**Edit: data is already in centered log-ratio transform and further normalization doesn't really help.**</span>
<span id="cb69-240"><a href="#cb69-240"></a></span>
<span id="cb69-243"><a href="#cb69-243"></a><span class="in">```{r}</span></span>
<span id="cb69-244"><a href="#cb69-244"></a>balclr_5c_rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(home_env_5c <span class="sc">~</span> ., <span class="at">data =</span> balclr_5c_train) <span class="sc">%&gt;%</span> </span>
<span id="cb69-245"><a href="#cb69-245"></a>  <span class="co">#step_novel(all_nominal(), -all_outcomes()) %&gt;%</span></span>
<span id="cb69-246"><a href="#cb69-246"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(od600, ciliate_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb69-247"><a href="#cb69-247"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb69-248"><a href="#cb69-248"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(od600, ciliate_per_ml)<span class="co"># %&gt;% </span></span>
<span id="cb69-249"><a href="#cb69-249"></a>  <span class="co">#step_corr(all_predictors(), threshold = 0.7, method = "spearman")</span></span>
<span id="cb69-250"><a href="#cb69-250"></a><span class="in">```</span></span>
<span id="cb69-251"><a href="#cb69-251"></a></span>
<span id="cb69-252"><a href="#cb69-252"></a>You can take a peek at the what the preprocessing recipe does using <span class="in">`prep`</span> and <span class="in">`bake`</span></span>
<span id="cb69-253"><a href="#cb69-253"></a></span>
<span id="cb69-256"><a href="#cb69-256"></a><span class="in">```{r}</span></span>
<span id="cb69-257"><a href="#cb69-257"></a>balclr_5c_rec <span class="sc">%&gt;%</span> </span>
<span id="cb69-258"><a href="#cb69-258"></a>  <span class="co"># perform the recipe on training data</span></span>
<span id="cb69-259"><a href="#cb69-259"></a>  recipes<span class="sc">::</span><span class="fu">prep</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-260"><a href="#cb69-260"></a>  <span class="co"># extract only the preprocessed dataframe </span></span>
<span id="cb69-261"><a href="#cb69-261"></a>  recipes<span class="sc">::</span><span class="fu">bake</span>(<span class="at">new_data =</span> <span class="cn">NULL</span>)</span>
<span id="cb69-262"><a href="#cb69-262"></a><span class="in">```</span></span>
<span id="cb69-263"><a href="#cb69-263"></a></span>
<span id="cb69-264"><a href="#cb69-264"></a><span class="fu">### Model specifications  {#sec-specs}</span></span>
<span id="cb69-265"><a href="#cb69-265"></a></span>
<span id="cb69-266"><a href="#cb69-266"></a>The process of specifying models is:</span>
<span id="cb69-267"><a href="#cb69-267"></a></span>
<span id="cb69-268"><a href="#cb69-268"></a><span class="ss">1. </span>Pick a model type</span>
<span id="cb69-269"><a href="#cb69-269"></a><span class="ss">2. </span>Set the engine</span>
<span id="cb69-270"><a href="#cb69-270"></a><span class="ss">3. </span>Set the mode: regression or classification</span>
<span id="cb69-271"><a href="#cb69-271"></a></span>
<span id="cb69-274"><a href="#cb69-274"></a><span class="in">```{r}</span></span>
<span id="cb69-275"><a href="#cb69-275"></a><span class="fu">library</span>(rules)</span>
<span id="cb69-276"><a href="#cb69-276"></a><span class="fu">library</span>(baguette)</span>
<span id="cb69-277"><a href="#cb69-277"></a></span>
<span id="cb69-278"><a href="#cb69-278"></a>svm_r_spec <span class="ot">&lt;-</span> </span>
<span id="cb69-279"><a href="#cb69-279"></a>   parsnip<span class="sc">::</span><span class="fu">svm_rbf</span>(<span class="at">cost =</span> <span class="fu">tune</span>(), <span class="at">rbf_sigma =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb69-280"><a href="#cb69-280"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"kernlab"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-281"><a href="#cb69-281"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb69-282"><a href="#cb69-282"></a></span>
<span id="cb69-283"><a href="#cb69-283"></a>svm_p_spec <span class="ot">&lt;-</span> </span>
<span id="cb69-284"><a href="#cb69-284"></a>   parsnip<span class="sc">::</span><span class="fu">svm_poly</span>(<span class="at">cost =</span> <span class="fu">tune</span>(), <span class="at">degree =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb69-285"><a href="#cb69-285"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"kernlab"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-286"><a href="#cb69-286"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb69-287"><a href="#cb69-287"></a></span>
<span id="cb69-288"><a href="#cb69-288"></a>cart_spec <span class="ot">&lt;-</span> </span>
<span id="cb69-289"><a href="#cb69-289"></a>   parsnip<span class="sc">::</span><span class="fu">decision_tree</span>(<span class="at">cost_complexity =</span> <span class="fu">tune</span>(), <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb69-290"><a href="#cb69-290"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"rpart"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-291"><a href="#cb69-291"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb69-292"><a href="#cb69-292"></a></span>
<span id="cb69-293"><a href="#cb69-293"></a>bag_cart_spec <span class="ot">&lt;-</span> </span>
<span id="cb69-294"><a href="#cb69-294"></a>   parsnip<span class="sc">::</span><span class="fu">bag_tree</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-295"><a href="#cb69-295"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"rpart"</span>, <span class="at">times =</span> <span class="dv">50</span>L) <span class="sc">%&gt;%</span> </span>
<span id="cb69-296"><a href="#cb69-296"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb69-297"><a href="#cb69-297"></a></span>
<span id="cb69-298"><a href="#cb69-298"></a>rf_spec <span class="ot">&lt;-</span> </span>
<span id="cb69-299"><a href="#cb69-299"></a>   parsnip<span class="sc">::</span><span class="fu">rand_forest</span>(<span class="at">mtry =</span> <span class="fu">tune</span>(), <span class="at">min_n =</span> <span class="fu">tune</span>(), <span class="at">trees =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-300"><a href="#cb69-300"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"ranger"</span>, <span class="at">importance =</span> <span class="st">"impurity"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-301"><a href="#cb69-301"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb69-302"><a href="#cb69-302"></a></span>
<span id="cb69-303"><a href="#cb69-303"></a>xgb_spec <span class="ot">&lt;-</span> </span>
<span id="cb69-304"><a href="#cb69-304"></a>   parsnip<span class="sc">::</span><span class="fu">boost_tree</span>(<span class="at">tree_depth =</span> <span class="fu">tune</span>(), <span class="at">learn_rate =</span> <span class="fu">tune</span>(), <span class="at">loss_reduction =</span> <span class="fu">tune</span>(), </span>
<span id="cb69-305"><a href="#cb69-305"></a>              <span class="at">min_n =</span> <span class="fu">tune</span>(), <span class="at">sample_size =</span> <span class="fu">tune</span>(), <span class="at">trees =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb69-306"><a href="#cb69-306"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"xgboost"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-307"><a href="#cb69-307"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb69-308"><a href="#cb69-308"></a></span>
<span id="cb69-309"><a href="#cb69-309"></a>nnet_spec <span class="ot">&lt;-</span> </span>
<span id="cb69-310"><a href="#cb69-310"></a>   parsnip<span class="sc">::</span><span class="fu">mlp</span>(<span class="at">hidden_units =</span> <span class="fu">tune</span>(), <span class="at">penalty =</span> <span class="fu">tune</span>(), <span class="at">epochs =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb69-311"><a href="#cb69-311"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"nnet"</span>, <span class="at">MaxNWts =</span> <span class="dv">2600</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-312"><a href="#cb69-312"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb69-313"><a href="#cb69-313"></a></span>
<span id="cb69-314"><a href="#cb69-314"></a>fda_spec <span class="ot">&lt;-</span> </span>
<span id="cb69-315"><a href="#cb69-315"></a>   parsnip<span class="sc">::</span><span class="fu">discrim_flexible</span>(<span class="at">prod_degree =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span>  <span class="co">#&lt;- use GCV to choose terms</span></span>
<span id="cb69-316"><a href="#cb69-316"></a>   parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"earth"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-317"><a href="#cb69-317"></a>   parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb69-318"><a href="#cb69-318"></a></span>
<span id="cb69-319"><a href="#cb69-319"></a>bart_spec <span class="ot">&lt;-</span> </span>
<span id="cb69-320"><a href="#cb69-320"></a>  parsnip<span class="sc">::</span><span class="fu">bart</span>(<span class="at">trees =</span> <span class="dv">1000</span>, <span class="at">prior_terminal_node_coef =</span> <span class="fu">tune</span>(), <span class="at">prior_terminal_node_expo =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb69-321"><a href="#cb69-321"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"dbarts"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-322"><a href="#cb69-322"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span>
<span id="cb69-323"><a href="#cb69-323"></a><span class="in">```</span></span>
<span id="cb69-324"><a href="#cb69-324"></a></span>
<span id="cb69-325"><a href="#cb69-325"></a><span class="fu">### Create workflow set {#sec-wf}</span></span>
<span id="cb69-326"><a href="#cb69-326"></a></span>
<span id="cb69-327"><a href="#cb69-327"></a>Now we need to specify the workflows that will be followed for the different model types</span>
<span id="cb69-328"><a href="#cb69-328"></a></span>
<span id="cb69-331"><a href="#cb69-331"></a><span class="in">```{r}</span></span>
<span id="cb69-332"><a href="#cb69-332"></a>balclr_5c_wf <span class="ot">&lt;-</span> </span>
<span id="cb69-333"><a href="#cb69-333"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_set</span>(</span>
<span id="cb69-334"><a href="#cb69-334"></a>      <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">balclr_5c =</span> balclr_5c_rec), </span>
<span id="cb69-335"><a href="#cb69-335"></a>      <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb69-336"><a href="#cb69-336"></a>        <span class="co">#SVM_radial = svm_r_spec, </span></span>
<span id="cb69-337"><a href="#cb69-337"></a>        <span class="co">#SVM_poly = svm_p_spec, </span></span>
<span id="cb69-338"><a href="#cb69-338"></a>        <span class="co">#CART = cart_spec, </span></span>
<span id="cb69-339"><a href="#cb69-339"></a>        <span class="co">#CART_bagged = bag_cart_spec,</span></span>
<span id="cb69-340"><a href="#cb69-340"></a>        <span class="co">#NNET = nnet_spec,</span></span>
<span id="cb69-341"><a href="#cb69-341"></a>        <span class="at">boosting =</span> xgb_spec,</span>
<span id="cb69-342"><a href="#cb69-342"></a>        <span class="co">#bart = bart_spec, </span></span>
<span id="cb69-343"><a href="#cb69-343"></a>        <span class="co">#fda = fda_spec,</span></span>
<span id="cb69-344"><a href="#cb69-344"></a>        <span class="at">RF =</span> rf_spec)</span>
<span id="cb69-345"><a href="#cb69-345"></a>   )</span>
<span id="cb69-346"><a href="#cb69-346"></a></span>
<span id="cb69-347"><a href="#cb69-347"></a>balclr_5c_wf</span>
<span id="cb69-348"><a href="#cb69-348"></a><span class="in">```</span></span>
<span id="cb69-349"><a href="#cb69-349"></a></span>
<span id="cb69-350"><a href="#cb69-350"></a><span class="fu">### Tune {#sec-tune}</span></span>
<span id="cb69-351"><a href="#cb69-351"></a></span>
<span id="cb69-352"><a href="#cb69-352"></a>Train and test performance for all the different models over the different train/test and 5-fold cv splits. This takes a long time to run...</span>
<span id="cb69-353"><a href="#cb69-353"></a></span>
<span id="cb69-356"><a href="#cb69-356"></a><span class="in">```{r}</span></span>
<span id="cb69-357"><a href="#cb69-357"></a><span class="co">#| eval: false</span></span>
<span id="cb69-358"><a href="#cb69-358"></a><span class="co">#| echo: true</span></span>
<span id="cb69-359"><a href="#cb69-359"></a>balclr_5c_grid_results <span class="ot">&lt;-</span></span>
<span id="cb69-360"><a href="#cb69-360"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_map</span>(balclr_5c_wf, </span>
<span id="cb69-361"><a href="#cb69-361"></a>      <span class="at">seed =</span> <span class="dv">1578</span>,</span>
<span id="cb69-362"><a href="#cb69-362"></a>      <span class="at">resamples =</span> balclr_5c_folds,</span>
<span id="cb69-363"><a href="#cb69-363"></a>      <span class="at">grid =</span> <span class="dv">15</span>,</span>
<span id="cb69-364"><a href="#cb69-364"></a>      <span class="at">control =</span> tune<span class="sc">::</span><span class="fu">control_grid</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">parallel_over =</span> <span class="st">"everything"</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb69-365"><a href="#cb69-365"></a>      <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(recall, precision, f_meas, j_index, accuracy, kap, roc_auc, sens, spec),</span>
<span id="cb69-366"><a href="#cb69-366"></a>   )</span>
<span id="cb69-367"><a href="#cb69-367"></a></span>
<span id="cb69-368"><a href="#cb69-368"></a><span class="co"># save this for later</span></span>
<span id="cb69-369"><a href="#cb69-369"></a>readr<span class="sc">::</span><span class="fu">write_rds</span>(balclr_5c_grid_results, here<span class="sc">::</span><span class="fu">here</span>(data_ml, <span class="st">"model_tune_5_class.rds"</span>))</span>
<span id="cb69-370"><a href="#cb69-370"></a><span class="in">```</span></span>
<span id="cb69-371"><a href="#cb69-371"></a></span>
<span id="cb69-374"><a href="#cb69-374"></a><span class="in">```{r}</span></span>
<span id="cb69-375"><a href="#cb69-375"></a><span class="co">#| eval: true</span></span>
<span id="cb69-376"><a href="#cb69-376"></a><span class="co">#| echo: false</span></span>
<span id="cb69-377"><a href="#cb69-377"></a>balclr_5c_grid_results <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_5_class.rds"</span>))</span>
<span id="cb69-378"><a href="#cb69-378"></a><span class="in">```</span></span>
<span id="cb69-379"><a href="#cb69-379"></a></span>
<span id="cb69-380"><a href="#cb69-380"></a><span class="fu">### Best tuning parameters and best performing models</span></span>
<span id="cb69-381"><a href="#cb69-381"></a></span>
<span id="cb69-382"><a href="#cb69-382"></a>First look at which of the models performed best according to area under the receiver operator curve</span>
<span id="cb69-383"><a href="#cb69-383"></a></span>
<span id="cb69-384"><a href="#cb69-384"></a>::: {#fig-01}</span>
<span id="cb69-387"><a href="#cb69-387"></a><span class="in">```{r}</span></span>
<span id="cb69-388"><a href="#cb69-388"></a>mymetric <span class="ot">&lt;-</span> <span class="st">"roc_auc"</span></span>
<span id="cb69-389"><a href="#cb69-389"></a></span>
<span id="cb69-390"><a href="#cb69-390"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(</span>
<span id="cb69-391"><a href="#cb69-391"></a>  balclr_5c_grid_results,</span>
<span id="cb69-392"><a href="#cb69-392"></a>  <span class="at">rank_metric =</span> mymetric,  </span>
<span id="cb69-393"><a href="#cb69-393"></a>  <span class="at">metric =</span> mymetric,       </span>
<span id="cb69-394"><a href="#cb69-394"></a>  <span class="co"># one point per workflow </span></span>
<span id="cb69-395"><a href="#cb69-395"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb69-396"><a href="#cb69-396"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb69-397"><a href="#cb69-397"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb69-398"><a href="#cb69-398"></a><span class="in">```</span></span>
<span id="cb69-399"><a href="#cb69-399"></a>Mean and standard deviation across train-test splits of the areas under the receiver operator curves for the different models.  boosting = Gradient Boosted Trees Classifier (XGBoost),  RF = Random Forest Classifier (Ranger).</span>
<span id="cb69-400"><a href="#cb69-400"></a>:::</span>
<span id="cb69-401"><a href="#cb69-401"></a></span>
<span id="cb69-402"><a href="#cb69-402"></a><span class="fu">#### Peformance metrics for best model</span></span>
<span id="cb69-403"><a href="#cb69-403"></a></span>
<span id="cb69-404"><a href="#cb69-404"></a>Defines a function for easily extracting metrics of interest</span>
<span id="cb69-405"><a href="#cb69-405"></a></span>
<span id="cb69-408"><a href="#cb69-408"></a><span class="in">```{r}</span></span>
<span id="cb69-409"><a href="#cb69-409"></a>getmymetrics <span class="ot">&lt;-</span> <span class="cf">function</span>(gridresults, myworkflow, mymetric, mysplit){</span>
<span id="cb69-410"><a href="#cb69-410"></a>  best_results <span class="ot">&lt;-</span> gridresults <span class="sc">%&gt;%</span> </span>
<span id="cb69-411"><a href="#cb69-411"></a>   workflowsets<span class="sc">::</span><span class="fu">extract_workflow_set_result</span>(myworkflow) <span class="sc">%&gt;%</span> </span>
<span id="cb69-412"><a href="#cb69-412"></a>   tune<span class="sc">::</span><span class="fu">select_best</span>(<span class="at">metric =</span> mymetric)</span>
<span id="cb69-413"><a href="#cb69-413"></a>  </span>
<span id="cb69-414"><a href="#cb69-414"></a>   gridresults <span class="sc">%&gt;%</span> </span>
<span id="cb69-415"><a href="#cb69-415"></a>     hardhat<span class="sc">::</span><span class="fu">extract_workflow</span>(myworkflow) <span class="sc">%&gt;%</span> </span>
<span id="cb69-416"><a href="#cb69-416"></a>     tune<span class="sc">::</span><span class="fu">finalize_workflow</span>(best_results) <span class="sc">%&gt;%</span> </span>
<span id="cb69-417"><a href="#cb69-417"></a>     tune<span class="sc">::</span><span class="fu">last_fit</span>(<span class="at">split =</span> mysplit,</span>
<span id="cb69-418"><a href="#cb69-418"></a>             <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(recall, precision, f_meas, j_index, accuracy, kap, roc_auc, sens, spec))</span>
<span id="cb69-419"><a href="#cb69-419"></a>}</span>
<span id="cb69-420"><a href="#cb69-420"></a><span class="in">```</span></span>
<span id="cb69-421"><a href="#cb69-421"></a></span>
<span id="cb69-422"><a href="#cb69-422"></a>Call the function to get performance metrics of different models</span>
<span id="cb69-423"><a href="#cb69-423"></a></span>
<span id="cb69-426"><a href="#cb69-426"></a><span class="in">```{r}</span></span>
<span id="cb69-427"><a href="#cb69-427"></a><span class="fu">set.seed</span>(<span class="dv">23784</span>)</span>
<span id="cb69-428"><a href="#cb69-428"></a>balclr_5c_rf_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_5c_grid_results,</span>
<span id="cb69-429"><a href="#cb69-429"></a>                                          <span class="st">"balclr_5c_RF"</span>,</span>
<span id="cb69-430"><a href="#cb69-430"></a>                                          <span class="st">"roc_auc"</span>,</span>
<span id="cb69-431"><a href="#cb69-431"></a>                                          balclr_5c_split)</span>
<span id="cb69-432"><a href="#cb69-432"></a>balclr_5c_boosting_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_5c_grid_results,</span>
<span id="cb69-433"><a href="#cb69-433"></a>                                                <span class="st">"balclr_5c_boosting"</span>,</span>
<span id="cb69-434"><a href="#cb69-434"></a>                                                <span class="st">"roc_auc"</span>,</span>
<span id="cb69-435"><a href="#cb69-435"></a>                                                balclr_5c_split)</span>
<span id="cb69-436"><a href="#cb69-436"></a><span class="in">```</span></span>
<span id="cb69-437"><a href="#cb69-437"></a></span>
<span id="cb69-438"><a href="#cb69-438"></a>Defines a function to collect and format metrics of different models and calls the function on all the different trained models</span>
<span id="cb69-439"><a href="#cb69-439"></a></span>
<span id="cb69-442"><a href="#cb69-442"></a><span class="in">```{r}</span></span>
<span id="cb69-443"><a href="#cb69-443"></a>collect_format <span class="ot">&lt;-</span> <span class="cf">function</span>(res, name){</span>
<span id="cb69-444"><a href="#cb69-444"></a>  tune<span class="sc">::</span><span class="fu">collect_metrics</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb69-445"><a href="#cb69-445"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">metric =</span> .metric,</span>
<span id="cb69-446"><a href="#cb69-446"></a>                {{ name }} <span class="sc">:</span><span class="er">=</span> .estimate,</span>
<span id="cb69-447"><a href="#cb69-447"></a>                <span class="at">estimate_type =</span> .estimator)</span>
<span id="cb69-448"><a href="#cb69-448"></a>}</span>
<span id="cb69-449"><a href="#cb69-449"></a></span>
<span id="cb69-450"><a href="#cb69-450"></a><span class="fu">collect_format</span>(balclr_5c_rf_test_results, <span class="st">"random_forest"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-451"><a href="#cb69-451"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">collect_format</span>(balclr_5c_boosting_test_results, <span class="st">"boosting"</span>), <span class="at">by =</span> <span class="fu">join_by</span>(metric, estimate_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-452"><a href="#cb69-452"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(estimate_type, metric)</span>
<span id="cb69-453"><a href="#cb69-453"></a><span class="in">```</span></span>
<span id="cb69-454"><a href="#cb69-454"></a></span>
<span id="cb69-455"><a href="#cb69-455"></a><span class="fu">#### ROC and PR curves</span></span>
<span id="cb69-456"><a href="#cb69-456"></a></span>
<span id="cb69-457"><a href="#cb69-457"></a><span class="co">[</span><span class="ot">This is a useful resource</span><span class="co">](https://www.nature.com/articles/nmeth.3945)</span> for understanding ROC curves and PR curves.</span>
<span id="cb69-458"><a href="#cb69-458"></a></span>
<span id="cb69-459"><a href="#cb69-459"></a>ROC curves here indicate that there is decent performance for the evolution environments of the ancestral clones, bacteria only, and bacteria plus ciliates. Performance is worse for treatments with streptomycin (see the PR curves). This is consistent with the strong overlap in community composition that we saw between strep and strep plus ciliate treatments. If the community response of the treatments is similiar it will be difficult to identify discriminating patterns in the data.</span>
<span id="cb69-460"><a href="#cb69-460"></a></span>
<span id="cb69-461"><a href="#cb69-461"></a>::: {#fig-02}</span>
<span id="cb69-464"><a href="#cb69-464"></a><span class="in">```{r}</span></span>
<span id="cb69-465"><a href="#cb69-465"></a>balclr_5c_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb69-466"><a href="#cb69-466"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-467"><a href="#cb69-467"></a>  yardstick<span class="sc">::</span><span class="fu">roc_curve</span>(home_env_5c, .pred_anc<span class="sc">:</span>.pred_bact_strep) <span class="sc">%&gt;%</span> </span>
<span id="cb69-468"><a href="#cb69-468"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb69-469"><a href="#cb69-469"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"FP rate"</span>, <span class="at">y =</span> <span class="st">"TP rate"</span>)</span>
<span id="cb69-470"><a href="#cb69-470"></a><span class="in">```</span></span>
<span id="cb69-471"><a href="#cb69-471"></a>ROC curve for True positive rate (TPR, vertical axis) versus the false positive rate (FPR, horizontal axis) for the five different evolutionary histories in the experiment from the hold-out testing data. The dashed 1:1 line is the expected performance of a random classifier. Curves above the 1:1 are better performance than random. Curves below 1:1 are worse performance than random.</span>
<span id="cb69-472"><a href="#cb69-472"></a>:::</span>
<span id="cb69-473"><a href="#cb69-473"></a></span>
<span id="cb69-474"><a href="#cb69-474"></a>::: {#fig-03}</span>
<span id="cb69-477"><a href="#cb69-477"></a><span class="in">```{r}</span></span>
<span id="cb69-478"><a href="#cb69-478"></a>balclr_5c_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb69-479"><a href="#cb69-479"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-480"><a href="#cb69-480"></a>  yardstick<span class="sc">::</span><span class="fu">pr_curve</span>(home_env_5c, .pred_anc<span class="sc">:</span>.pred_bact_strep) <span class="sc">%&gt;%</span> </span>
<span id="cb69-481"><a href="#cb69-481"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb69-482"><a href="#cb69-482"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Recall"</span>, <span class="at">y =</span> <span class="st">"Precision"</span>)</span>
<span id="cb69-483"><a href="#cb69-483"></a><span class="in">```</span></span>
<span id="cb69-484"><a href="#cb69-484"></a>Precision recall curves for the five different evolutionary histories in the experiment from the hold-out testing data. There is a good tuorial for interpretation of these plots on <span class="co">[</span><span class="ot">scikit-learn</span><span class="co">](https://scikit-learn.org/1.5/auto_examples/model_selection/plot_precision_recall.html)</span>. </span>
<span id="cb69-485"><a href="#cb69-485"></a>:::</span>
<span id="cb69-486"><a href="#cb69-486"></a></span>
<span id="cb69-487"><a href="#cb69-487"></a><span class="fu">#### Confusion matrix</span></span>
<span id="cb69-488"><a href="#cb69-488"></a></span>
<span id="cb69-489"><a href="#cb69-489"></a>The confusion matrix shows that for ciliates evolution environment (bact_pred), the model is only getting the evolution environment correct about half the time (10 correct/8 incorrect) which is basically the same as guessing. The best performing home environments are the ancestral and the combined predators and streptomycin treatments.</span>
<span id="cb69-490"><a href="#cb69-490"></a></span>
<span id="cb69-491"><a href="#cb69-491"></a>::: {#fig-04}</span>
<span id="cb69-494"><a href="#cb69-494"></a><span class="in">```{r}</span></span>
<span id="cb69-495"><a href="#cb69-495"></a>balclr_5c_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb69-496"><a href="#cb69-496"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-497"><a href="#cb69-497"></a>  yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(home_env_5c, .pred_class) <span class="sc">%&gt;%</span></span>
<span id="cb69-498"><a href="#cb69-498"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">"heatmap"</span>) </span>
<span id="cb69-499"><a href="#cb69-499"></a><span class="in">```</span></span>
<span id="cb69-500"><a href="#cb69-500"></a>Confusion matrix showing the classifier performance on each of the five evolutionary history classes using the hold-out testing data.</span>
<span id="cb69-501"><a href="#cb69-501"></a>:::</span>
<span id="cb69-502"><a href="#cb69-502"></a></span>
<span id="cb69-503"><a href="#cb69-503"></a><span class="fu">#### Probability distributions for the 5 classes</span></span>
<span id="cb69-504"><a href="#cb69-504"></a></span>
<span id="cb69-505"><a href="#cb69-505"></a>Gradient boosting trees give each prediction a probability for every class. The higher the probability the higher the confidence in the prediction. We can visualize the distribution of these prediction probabilities to get some insight as to which classes the model has trouble distinguishing and which are very clearly separated. </span>
<span id="cb69-506"><a href="#cb69-506"></a></span>
<span id="cb69-507"><a href="#cb69-507"></a>::: {#fig-05}</span>
<span id="cb69-510"><a href="#cb69-510"></a><span class="in">```{r}</span></span>
<span id="cb69-511"><a href="#cb69-511"></a>balclr_5c_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb69-512"><a href="#cb69-512"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-513"><a href="#cb69-513"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(</span>
<span id="cb69-514"><a href="#cb69-514"></a>    .pred_anc,</span>
<span id="cb69-515"><a href="#cb69-515"></a>    .pred_bact,</span>
<span id="cb69-516"><a href="#cb69-516"></a>    .pred_bact_pred,</span>
<span id="cb69-517"><a href="#cb69-517"></a>    .pred_bact_pred_strep,</span>
<span id="cb69-518"><a href="#cb69-518"></a>    .pred_bact_strep</span>
<span id="cb69-519"><a href="#cb69-519"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb69-520"><a href="#cb69-520"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb69-521"><a href="#cb69-521"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> home_env_5c), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb69-522"><a href="#cb69-522"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Prediction Probability"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb69-523"><a href="#cb69-523"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>( <span class="sc">~</span> name)</span>
<span id="cb69-524"><a href="#cb69-524"></a><span class="in">```</span></span>
<span id="cb69-525"><a href="#cb69-525"></a>Prediction probability densities (colors) for each observation of the five evolutionary history classes (grid columns) tested with the model.</span>
<span id="cb69-526"><a href="#cb69-526"></a>:::</span>
<span id="cb69-527"><a href="#cb69-527"></a></span>
<span id="cb69-528"><a href="#cb69-528"></a><span class="fu">## 2 classes (ancestral clones vs coevolved history)</span></span>
<span id="cb69-529"><a href="#cb69-529"></a></span>
<span id="cb69-530"><a href="#cb69-530"></a>Based on the above analysis and from inspecting the community composition data it appears that ancestral/clonal community has a distinct response to the measurement conditions compared with all the other evolutionary histories. Here instead of trying to predict 5 different home environment classes we just want to predict whether the bacteria had a coevolutionary history from the YSK experiment or not. However, this introduces an additional challenge because now the classes we will be trying to predict are imbalanced. </span>
<span id="cb69-531"><a href="#cb69-531"></a></span>
<span id="cb69-532"><a href="#cb69-532"></a><span class="fu">### Spliting</span></span>
<span id="cb69-533"><a href="#cb69-533"></a></span>
<span id="cb69-534"><a href="#cb69-534"></a>Done the same as in  @sec-split from the 5-class classification.</span>
<span id="cb69-535"><a href="#cb69-535"></a></span>
<span id="cb69-538"><a href="#cb69-538"></a><span class="in">```{r}</span></span>
<span id="cb69-539"><a href="#cb69-539"></a>balclr_ae <span class="ot">&lt;-</span> balclr_md <span class="sc">%&gt;%</span> </span>
<span id="cb69-540"><a href="#cb69-540"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>home_env_5c, <span class="sc">-</span>home_env_sns, <span class="sc">-</span>home_env_pnp) <span class="sc">%&gt;%</span> </span>
<span id="cb69-541"><a href="#cb69-541"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb69-542"><a href="#cb69-542"></a>         <span class="at">transfer =</span> <span class="fu">factor</span>(transfer),</span>
<span id="cb69-543"><a href="#cb69-543"></a>         <span class="at">measure_env =</span> <span class="fu">factor</span>(measure_env),</span>
<span id="cb69-544"><a href="#cb69-544"></a>         <span class="at">home_env_ae =</span> <span class="fu">factor</span>(home_env_ae))</span>
<span id="cb69-545"><a href="#cb69-545"></a></span>
<span id="cb69-546"><a href="#cb69-546"></a><span class="fu">table</span>(balclr_ae<span class="sc">$</span>home_env_ae)</span>
<span id="cb69-547"><a href="#cb69-547"></a><span class="in">```</span></span>
<span id="cb69-548"><a href="#cb69-548"></a></span>
<span id="cb69-549"><a href="#cb69-549"></a>So in this case the classes from the data are clearly not balanced... We will try and address that in the recipe step using the <span class="in">`themis`</span> package. In particular we use Randomly Over Sampling Examples (ROSE). The ROSE algorithm works by selecting an observation belonging to class k and generates new examples in its neighborhood is determined by some matrix H_k. Smaller values of these arguments have the effect of shrinking the entries of the corresponding smoothing matrix H_k, Shrinking would be a cautious choice if there is a concern that excessively large neighborhoods could lead to blur the boundaries between the regions of the feature space associated with each class.</span>
<span id="cb69-550"><a href="#cb69-550"></a></span>
<span id="cb69-553"><a href="#cb69-553"></a><span class="in">```{r}</span></span>
<span id="cb69-554"><a href="#cb69-554"></a><span class="fu">set.seed</span>(<span class="dv">1467</span>)</span>
<span id="cb69-555"><a href="#cb69-555"></a>balclr_ae_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(balclr_ae, <span class="at">strata =</span> home_env_ae)</span>
<span id="cb69-556"><a href="#cb69-556"></a>balclr_ae_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(balclr_ae_split)</span>
<span id="cb69-557"><a href="#cb69-557"></a>balclr_ae_test  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(balclr_ae_split)</span>
<span id="cb69-558"><a href="#cb69-558"></a><span class="in">```</span></span>
<span id="cb69-559"><a href="#cb69-559"></a></span>
<span id="cb69-562"><a href="#cb69-562"></a><span class="in">```{r}</span></span>
<span id="cb69-563"><a href="#cb69-563"></a><span class="fu">set.seed</span>(<span class="dv">1468</span>)</span>
<span id="cb69-564"><a href="#cb69-564"></a>balclr_ae_folds <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(balclr_ae_train, <span class="at">strata =</span> home_env_ae)</span>
<span id="cb69-565"><a href="#cb69-565"></a><span class="in">```</span></span>
<span id="cb69-566"><a href="#cb69-566"></a></span>
<span id="cb69-567"><a href="#cb69-567"></a><span class="fu">### Recipe</span></span>
<span id="cb69-568"><a href="#cb69-568"></a></span>
<span id="cb69-569"><a href="#cb69-569"></a>Done the same as in @sec-recipe from the 5-class classification.</span>
<span id="cb69-570"><a href="#cb69-570"></a></span>
<span id="cb69-573"><a href="#cb69-573"></a><span class="in">```{r}</span></span>
<span id="cb69-574"><a href="#cb69-574"></a>balclr_ae_rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(home_env_ae <span class="sc">~</span> ., <span class="at">data =</span> balclr_ae_train) <span class="sc">%&gt;%</span> </span>
<span id="cb69-575"><a href="#cb69-575"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(od600, ciliate_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb69-576"><a href="#cb69-576"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb69-577"><a href="#cb69-577"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(od600, ciliate_per_ml)</span>
<span id="cb69-578"><a href="#cb69-578"></a></span>
<span id="cb69-579"><a href="#cb69-579"></a>balclr_ae_rec_rose <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(home_env_ae <span class="sc">~</span> ., <span class="at">data =</span> balclr_ae_train) <span class="sc">%&gt;%</span> </span>
<span id="cb69-580"><a href="#cb69-580"></a>  themis<span class="sc">::</span><span class="fu">step_rose</span>(home_env_ae) <span class="sc">%&gt;%</span> </span>
<span id="cb69-581"><a href="#cb69-581"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(od600, ciliate_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb69-582"><a href="#cb69-582"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb69-583"><a href="#cb69-583"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(od600, ciliate_per_ml)</span>
<span id="cb69-584"><a href="#cb69-584"></a><span class="in">```</span></span>
<span id="cb69-585"><a href="#cb69-585"></a></span>
<span id="cb69-586"><a href="#cb69-586"></a><span class="fu">### Model specifications</span></span>
<span id="cb69-587"><a href="#cb69-587"></a></span>
<span id="cb69-588"><a href="#cb69-588"></a>Using the same model specifications as in @sec-specs from the 5-class classification.</span>
<span id="cb69-589"><a href="#cb69-589"></a></span>
<span id="cb69-590"><a href="#cb69-590"></a><span class="fu">### Create workflow set</span></span>
<span id="cb69-591"><a href="#cb69-591"></a></span>
<span id="cb69-592"><a href="#cb69-592"></a>Same process as in @sec-wf from the 5-class classification.</span>
<span id="cb69-593"><a href="#cb69-593"></a></span>
<span id="cb69-596"><a href="#cb69-596"></a><span class="in">```{r}</span></span>
<span id="cb69-597"><a href="#cb69-597"></a>balclr_ae_wf <span class="ot">&lt;-</span> </span>
<span id="cb69-598"><a href="#cb69-598"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_set</span>(</span>
<span id="cb69-599"><a href="#cb69-599"></a>      <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">balclr_ae =</span> balclr_ae_rec, </span>
<span id="cb69-600"><a href="#cb69-600"></a>                     <span class="at">balclr_ae_rose =</span> balclr_ae_rec_rose), </span>
<span id="cb69-601"><a href="#cb69-601"></a>      <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb69-602"><a href="#cb69-602"></a>        <span class="co">#SVM_radial = svm_r_spec, </span></span>
<span id="cb69-603"><a href="#cb69-603"></a>        <span class="co">#SVM_poly = svm_p_spec, </span></span>
<span id="cb69-604"><a href="#cb69-604"></a>        <span class="co">#CART = cart_spec, </span></span>
<span id="cb69-605"><a href="#cb69-605"></a>        <span class="co">#CART_bagged = bag_cart_spec,</span></span>
<span id="cb69-606"><a href="#cb69-606"></a>        <span class="co">#NNET = nnet_spec,</span></span>
<span id="cb69-607"><a href="#cb69-607"></a>        <span class="at">boosting =</span> xgb_spec,</span>
<span id="cb69-608"><a href="#cb69-608"></a>        <span class="co">#bart = bart_spec, </span></span>
<span id="cb69-609"><a href="#cb69-609"></a>        <span class="co">#fda = fda_spec,</span></span>
<span id="cb69-610"><a href="#cb69-610"></a>        <span class="at">RF =</span> rf_spec</span>
<span id="cb69-611"><a href="#cb69-611"></a>      )</span>
<span id="cb69-612"><a href="#cb69-612"></a>   )</span>
<span id="cb69-613"><a href="#cb69-613"></a><span class="in">```</span></span>
<span id="cb69-614"><a href="#cb69-614"></a></span>
<span id="cb69-615"><a href="#cb69-615"></a><span class="fu">### Tune</span></span>
<span id="cb69-616"><a href="#cb69-616"></a></span>
<span id="cb69-617"><a href="#cb69-617"></a>Same as in @sec-tune from the 5-class classification. Warning this takes some time...</span>
<span id="cb69-620"><a href="#cb69-620"></a><span class="in">```{r}</span></span>
<span id="cb69-621"><a href="#cb69-621"></a><span class="co">#| eval: false</span></span>
<span id="cb69-622"><a href="#cb69-622"></a><span class="co">#| echo: true</span></span>
<span id="cb69-623"><a href="#cb69-623"></a>balclr_ae_grid_results <span class="ot">&lt;-</span></span>
<span id="cb69-624"><a href="#cb69-624"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_map</span>(balclr_ae_wf, </span>
<span id="cb69-625"><a href="#cb69-625"></a>      <span class="at">seed =</span> <span class="dv">1469</span>,</span>
<span id="cb69-626"><a href="#cb69-626"></a>      <span class="at">resamples =</span> balclr_ae_folds,</span>
<span id="cb69-627"><a href="#cb69-627"></a>      <span class="at">grid =</span> <span class="dv">15</span>,</span>
<span id="cb69-628"><a href="#cb69-628"></a>      <span class="at">control =</span> tune<span class="sc">::</span><span class="fu">control_grid</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">parallel_over =</span> <span class="st">"everything"</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb69-629"><a href="#cb69-629"></a>      <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(recall, precision, f_meas, j_index, accuracy, kap, roc_auc, sens, spec),</span>
<span id="cb69-630"><a href="#cb69-630"></a>   )</span>
<span id="cb69-631"><a href="#cb69-631"></a></span>
<span id="cb69-632"><a href="#cb69-632"></a><span class="co"># save this for later</span></span>
<span id="cb69-633"><a href="#cb69-633"></a>readr<span class="sc">::</span><span class="fu">write_rds</span>(balclr_ae_grid_results, here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_ae.rds"</span>))</span>
<span id="cb69-634"><a href="#cb69-634"></a><span class="in">```</span></span>
<span id="cb69-635"><a href="#cb69-635"></a></span>
<span id="cb69-638"><a href="#cb69-638"></a><span class="in">```{r}</span></span>
<span id="cb69-639"><a href="#cb69-639"></a>balclr_ae_grid_results <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_ae.rds"</span>))</span>
<span id="cb69-640"><a href="#cb69-640"></a><span class="in">```</span></span>
<span id="cb69-641"><a href="#cb69-641"></a></span>
<span id="cb69-642"><a href="#cb69-642"></a><span class="fu">### Best tuning parameters and best performing models</span></span>
<span id="cb69-643"><a href="#cb69-643"></a></span>
<span id="cb69-644"><a href="#cb69-644"></a>First look at which of the models performed best. We'll use the J index and the ROC auc as suggested in the <span class="co">[</span><span class="ot">tidymodels unbalanced class tutorial.</span><span class="co">](https://www.tidymodels.org/learn/models/sub-sampling/)</span></span>
<span id="cb69-645"><a href="#cb69-645"></a></span>
<span id="cb69-646"><a href="#cb69-646"></a><span class="ss">- </span>The area under the ROC curve is an overall assessment of performance across all cutoffs. Values near one indicate very good results while values near 0.5 would imply that the model is very poor (i.e. no better than guessing)</span>
<span id="cb69-647"><a href="#cb69-647"></a><span class="ss">- </span>The J index (a.k.a. Youden’s J statistic) is sensitivity + specificity - 1. Values near one are once again best.</span>
<span id="cb69-648"><a href="#cb69-648"></a></span>
<span id="cb69-649"><a href="#cb69-649"></a>If a model is poorly calibrated, the ROC curve value might not show diminished performance. However, the J index would be lower for models with pathological distributions for the class probabilities. The yardstick package will be used to compute these metrics.</span>
<span id="cb69-650"><a href="#cb69-650"></a></span>
<span id="cb69-651"><a href="#cb69-651"></a>J index</span>
<span id="cb69-652"><a href="#cb69-652"></a></span>
<span id="cb69-653"><a href="#cb69-653"></a>::: {#fig-06}</span>
<span id="cb69-656"><a href="#cb69-656"></a><span class="in">```{r}</span></span>
<span id="cb69-657"><a href="#cb69-657"></a><span class="co"># which metric to visualize</span></span>
<span id="cb69-658"><a href="#cb69-658"></a>mymetric <span class="ot">&lt;-</span> <span class="st">"j_index"</span></span>
<span id="cb69-659"><a href="#cb69-659"></a></span>
<span id="cb69-660"><a href="#cb69-660"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(</span>
<span id="cb69-661"><a href="#cb69-661"></a>  balclr_ae_grid_results,</span>
<span id="cb69-662"><a href="#cb69-662"></a>  <span class="at">rank_metric =</span> mymetric,  </span>
<span id="cb69-663"><a href="#cb69-663"></a>  <span class="at">metric =</span> mymetric,       </span>
<span id="cb69-664"><a href="#cb69-664"></a>  <span class="co"># one point per workflow </span></span>
<span id="cb69-665"><a href="#cb69-665"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb69-666"><a href="#cb69-666"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb69-667"><a href="#cb69-667"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb69-668"><a href="#cb69-668"></a><span class="in">```</span></span>
<span id="cb69-669"><a href="#cb69-669"></a>Mean and standard deviation across train-test splits of the <span class="co">[</span><span class="ot">J-index</span><span class="co">](https://en.wikipedia.org/wiki/Youden%27s_J_statistic)</span> for the different models.  boosting = Gradient Boosted Trees Classifier (XGBoost), RF = Random Forest Classifier (Ranger). Rose indicates that synthetic data has been generated using the ROSE algorithm to better balance the classes.</span>
<span id="cb69-670"><a href="#cb69-670"></a>:::</span>
<span id="cb69-671"><a href="#cb69-671"></a></span>
<span id="cb69-672"><a href="#cb69-672"></a>::: {#fig-07}</span>
<span id="cb69-675"><a href="#cb69-675"></a><span class="in">```{r}</span></span>
<span id="cb69-676"><a href="#cb69-676"></a><span class="co"># which metric to visualize</span></span>
<span id="cb69-677"><a href="#cb69-677"></a>mymetric <span class="ot">&lt;-</span> <span class="st">"roc_auc"</span></span>
<span id="cb69-678"><a href="#cb69-678"></a></span>
<span id="cb69-679"><a href="#cb69-679"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(</span>
<span id="cb69-680"><a href="#cb69-680"></a>  balclr_ae_grid_results,</span>
<span id="cb69-681"><a href="#cb69-681"></a>  <span class="at">rank_metric =</span> mymetric,  </span>
<span id="cb69-682"><a href="#cb69-682"></a>  <span class="at">metric =</span> mymetric,       </span>
<span id="cb69-683"><a href="#cb69-683"></a>  <span class="co"># one point per workflow </span></span>
<span id="cb69-684"><a href="#cb69-684"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb69-685"><a href="#cb69-685"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb69-686"><a href="#cb69-686"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb69-687"><a href="#cb69-687"></a><span class="in">```</span></span>
<span id="cb69-688"><a href="#cb69-688"></a>Mean and standard deviation across train-test splits of the areas under the receiver operator curves for the different models.  boosting = Gradient Boosted Trees Classifier (XGBoost), RF = Random Forest Classifier (Ranger). Rose indicates that synthetic data has been generated using the ROSE algorithm to better balance the classes.</span>
<span id="cb69-689"><a href="#cb69-689"></a>:::</span>
<span id="cb69-690"><a href="#cb69-690"></a></span>
<span id="cb69-691"><a href="#cb69-691"></a>It looks like ROSE preprocessing step helped (at least somewhat) with the J-index. Class imbalance sampling methods tend to greatly improve metrics based on the hard class predictions (i.e., the categorical predictions) because the default cutoff tends to be a better balance of sensitivity and specificity.</span>
<span id="cb69-692"><a href="#cb69-692"></a></span>
<span id="cb69-693"><a href="#cb69-693"></a><span class="fu">#### Peformance metrics for best model</span></span>
<span id="cb69-694"><a href="#cb69-694"></a></span>
<span id="cb69-697"><a href="#cb69-697"></a><span class="in">```{r}</span></span>
<span id="cb69-698"><a href="#cb69-698"></a><span class="fu">set.seed</span>(<span class="dv">4671</span>)</span>
<span id="cb69-699"><a href="#cb69-699"></a>balclr_ae_boosting_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_ae_grid_results,</span>
<span id="cb69-700"><a href="#cb69-700"></a>                                                <span class="st">"balclr_ae_rose_boosting"</span>,</span>
<span id="cb69-701"><a href="#cb69-701"></a>                                                <span class="st">"j_index"</span>,</span>
<span id="cb69-702"><a href="#cb69-702"></a>                                                balclr_ae_split)</span>
<span id="cb69-703"><a href="#cb69-703"></a>balclr_ae_rf_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_ae_grid_results,</span>
<span id="cb69-704"><a href="#cb69-704"></a>                                          <span class="st">"balclr_ae_rose_RF"</span>,</span>
<span id="cb69-705"><a href="#cb69-705"></a>                                          <span class="st">"j_index"</span>,</span>
<span id="cb69-706"><a href="#cb69-706"></a>                                          balclr_ae_split)</span>
<span id="cb69-707"><a href="#cb69-707"></a></span>
<span id="cb69-708"><a href="#cb69-708"></a><span class="fu">collect_format</span>(balclr_ae_rf_test_results, <span class="st">"random_forest"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-709"><a href="#cb69-709"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">collect_format</span>(balclr_ae_boosting_test_results, <span class="st">"boosting"</span>), <span class="at">by =</span> <span class="fu">join_by</span>(metric, estimate_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-710"><a href="#cb69-710"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(estimate_type, metric)</span>
<span id="cb69-711"><a href="#cb69-711"></a><span class="in">```</span></span>
<span id="cb69-712"><a href="#cb69-712"></a></span>
<span id="cb69-713"><a href="#cb69-713"></a>Gradient boosting and random forest seems to be doing performing about equally here</span>
<span id="cb69-714"><a href="#cb69-714"></a></span>
<span id="cb69-715"><a href="#cb69-715"></a><span class="fu">#### ROC and PR curves</span></span>
<span id="cb69-716"><a href="#cb69-716"></a></span>
<span id="cb69-717"><a href="#cb69-717"></a>With unbalaced classes like we have here, it is best to look at both the ROC curve and the PR (precision-recall) curve. <span class="co">[</span><span class="ot">See here</span><span class="co">]( https://www.nature.com/articles/nmeth.3945)</span></span>
<span id="cb69-718"><a href="#cb69-718"></a></span>
<span id="cb69-719"><a href="#cb69-719"></a>::: {#fig-08}</span>
<span id="cb69-722"><a href="#cb69-722"></a><span class="in">```{r}</span></span>
<span id="cb69-723"><a href="#cb69-723"></a>balclr_ae_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb69-724"><a href="#cb69-724"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-725"><a href="#cb69-725"></a>  yardstick<span class="sc">::</span><span class="fu">roc_curve</span>(home_env_ae, .pred_anc) <span class="sc">%&gt;%</span> </span>
<span id="cb69-726"><a href="#cb69-726"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb69-727"><a href="#cb69-727"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"FP rate"</span>, <span class="at">y =</span> <span class="st">"TP rate"</span>)</span>
<span id="cb69-728"><a href="#cb69-728"></a><span class="in">```</span></span>
<span id="cb69-729"><a href="#cb69-729"></a>ROC curve for True positive rate (TPR, vertical axis) versus the false positive rate (FPR, horizontal axis) for classifying the evolutionary history as either ancestral/clonal or YSK-derived in the experiment from the hold-out testing data. The dashed 1:1 line is the expected performance of a random classifier. Curves above the 1:1 are better performance than random. Curves below 1:1 are worse performance than random.</span>
<span id="cb69-730"><a href="#cb69-730"></a>:::</span>
<span id="cb69-731"><a href="#cb69-731"></a></span>
<span id="cb69-732"><a href="#cb69-732"></a>::: {#fig-09}</span>
<span id="cb69-735"><a href="#cb69-735"></a><span class="in">```{r}</span></span>
<span id="cb69-736"><a href="#cb69-736"></a>balclr_ae_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb69-737"><a href="#cb69-737"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-738"><a href="#cb69-738"></a>  yardstick<span class="sc">::</span><span class="fu">pr_curve</span>(home_env_ae, .pred_anc) <span class="sc">%&gt;%</span> </span>
<span id="cb69-739"><a href="#cb69-739"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb69-740"><a href="#cb69-740"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Recall"</span>, <span class="at">y =</span> <span class="st">"Precision"</span>)</span>
<span id="cb69-741"><a href="#cb69-741"></a><span class="in">```</span></span>
<span id="cb69-742"><a href="#cb69-742"></a>Precision recall curves for classifying the evolutionary history as either ancestral/clonal or YSK-derived in the experiment from the hold-out testing data. There is a good tuorial for interpretation of these plots on <span class="co">[</span><span class="ot">scikit-learn</span><span class="co">](https://scikit-learn.org/1.5/auto_examples/model_selection/plot_precision_recall.html)</span>. </span>
<span id="cb69-743"><a href="#cb69-743"></a>:::</span>
<span id="cb69-744"><a href="#cb69-744"></a></span>
<span id="cb69-745"><a href="#cb69-745"></a><span class="fu">#### Confusion matrix</span></span>
<span id="cb69-746"><a href="#cb69-746"></a></span>
<span id="cb69-747"><a href="#cb69-747"></a>The model is doing pretty well finding the communiuties with a coevolutionary history, but it is doing less well at finding the ancestral communities. It is getting the ancestral correct 2/3 of the time.</span>
<span id="cb69-748"><a href="#cb69-748"></a></span>
<span id="cb69-749"><a href="#cb69-749"></a>::: {#fig-10}</span>
<span id="cb69-752"><a href="#cb69-752"></a><span class="in">```{r}</span></span>
<span id="cb69-753"><a href="#cb69-753"></a>balclr_ae_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb69-754"><a href="#cb69-754"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-755"><a href="#cb69-755"></a>  yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(home_env_ae, .pred_class) <span class="sc">%&gt;%</span></span>
<span id="cb69-756"><a href="#cb69-756"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">"heatmap"</span>) </span>
<span id="cb69-757"><a href="#cb69-757"></a><span class="in">```</span></span>
<span id="cb69-758"><a href="#cb69-758"></a>Confusion matrix showing the classifier performance on each of the two evolutionary history classes using the hold-out testing data. (anc = ancelstra/clonal, evo = from YSK)</span>
<span id="cb69-759"><a href="#cb69-759"></a>:::</span>
<span id="cb69-760"><a href="#cb69-760"></a></span>
<span id="cb69-761"><a href="#cb69-761"></a><span class="fu">#### Probability distributions for the 2 classes</span></span>
<span id="cb69-762"><a href="#cb69-762"></a></span>
<span id="cb69-763"><a href="#cb69-763"></a>::: {#fig-11}</span>
<span id="cb69-766"><a href="#cb69-766"></a><span class="in">```{r}</span></span>
<span id="cb69-767"><a href="#cb69-767"></a>balclr_ae_boosting_test_results <span class="sc">%&gt;%</span></span>
<span id="cb69-768"><a href="#cb69-768"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-769"><a href="#cb69-769"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb69-770"><a href="#cb69-770"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred_evo, <span class="at">fill =</span> home_env_ae), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb69-771"><a href="#cb69-771"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Prediction Probability"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb69-772"><a href="#cb69-772"></a><span class="in">```</span></span>
<span id="cb69-773"><a href="#cb69-773"></a>Prediction probability densities (colors) for each observation of the two evolutionary history classes tested with the model.</span>
<span id="cb69-774"><a href="#cb69-774"></a>:::</span>
<span id="cb69-775"><a href="#cb69-775"></a></span>
<span id="cb69-776"><a href="#cb69-776"></a><span class="fu">## 2 classes (streptomycin history vs no streptomycin history)</span></span>
<span id="cb69-777"><a href="#cb69-777"></a></span>
<span id="cb69-778"><a href="#cb69-778"></a>Now we will try and predict whether the evolutionary history of the communities included exposure to streptomycin</span>
<span id="cb69-779"><a href="#cb69-779"></a></span>
<span id="cb69-780"><a href="#cb69-780"></a><span class="fu">### Spliting</span></span>
<span id="cb69-781"><a href="#cb69-781"></a></span>
<span id="cb69-782"><a href="#cb69-782"></a>Done the same as in  @sec-split from the 5-class classification.</span>
<span id="cb69-783"><a href="#cb69-783"></a></span>
<span id="cb69-786"><a href="#cb69-786"></a><span class="in">```{r}</span></span>
<span id="cb69-787"><a href="#cb69-787"></a>balclr_sns <span class="ot">&lt;-</span> balclr_md <span class="sc">%&gt;%</span> </span>
<span id="cb69-788"><a href="#cb69-788"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>home_env_5c, <span class="sc">-</span>home_env_ae, <span class="sc">-</span>home_env_pnp) <span class="sc">%&gt;%</span> </span>
<span id="cb69-789"><a href="#cb69-789"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb69-790"><a href="#cb69-790"></a>         <span class="at">transfer =</span> <span class="fu">factor</span>(transfer),</span>
<span id="cb69-791"><a href="#cb69-791"></a>         <span class="at">measure_env =</span> <span class="fu">factor</span>(measure_env),</span>
<span id="cb69-792"><a href="#cb69-792"></a>         <span class="at">home_env_sns =</span> <span class="fu">factor</span>(home_env_sns)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-793"><a href="#cb69-793"></a>  <span class="co"># we omit the ancestral samples to keep it more balanced</span></span>
<span id="cb69-794"><a href="#cb69-794"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb69-795"><a href="#cb69-795"></a></span>
<span id="cb69-796"><a href="#cb69-796"></a><span class="fu">table</span>(balclr_sns<span class="sc">$</span>home_env_sns)</span>
<span id="cb69-797"><a href="#cb69-797"></a><span class="in">```</span></span>
<span id="cb69-798"><a href="#cb69-798"></a></span>
<span id="cb69-799"><a href="#cb69-799"></a></span>
<span id="cb69-802"><a href="#cb69-802"></a><span class="in">```{r}</span></span>
<span id="cb69-803"><a href="#cb69-803"></a><span class="fu">set.seed</span>(<span class="dv">1567</span>)</span>
<span id="cb69-804"><a href="#cb69-804"></a>balclr_sns_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(balclr_sns, <span class="at">strata =</span> home_env_sns)</span>
<span id="cb69-805"><a href="#cb69-805"></a>balclr_sns_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(balclr_sns_split)</span>
<span id="cb69-806"><a href="#cb69-806"></a>balclr_sns_test  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(balclr_sns_split)</span>
<span id="cb69-807"><a href="#cb69-807"></a><span class="in">```</span></span>
<span id="cb69-808"><a href="#cb69-808"></a></span>
<span id="cb69-811"><a href="#cb69-811"></a><span class="in">```{r}</span></span>
<span id="cb69-812"><a href="#cb69-812"></a><span class="fu">set.seed</span>(<span class="dv">1568</span>)</span>
<span id="cb69-813"><a href="#cb69-813"></a>balclr_sns_folds <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(balclr_sns_train, <span class="at">strata =</span> home_env_sns)</span>
<span id="cb69-814"><a href="#cb69-814"></a><span class="in">```</span></span>
<span id="cb69-815"><a href="#cb69-815"></a></span>
<span id="cb69-816"><a href="#cb69-816"></a><span class="fu">### Recipe</span></span>
<span id="cb69-817"><a href="#cb69-817"></a></span>
<span id="cb69-818"><a href="#cb69-818"></a>Done the same as in @sec-recipe from the 5-class classification.</span>
<span id="cb69-819"><a href="#cb69-819"></a></span>
<span id="cb69-822"><a href="#cb69-822"></a><span class="in">```{r}</span></span>
<span id="cb69-823"><a href="#cb69-823"></a>balclr_sns_rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(home_env_sns <span class="sc">~</span> ., <span class="at">data =</span> balclr_sns_train) <span class="sc">%&gt;%</span> </span>
<span id="cb69-824"><a href="#cb69-824"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(od600, ciliate_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb69-825"><a href="#cb69-825"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb69-826"><a href="#cb69-826"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(od600, ciliate_per_ml)</span>
<span id="cb69-827"><a href="#cb69-827"></a><span class="in">```</span></span>
<span id="cb69-828"><a href="#cb69-828"></a></span>
<span id="cb69-829"><a href="#cb69-829"></a><span class="fu">### Model specifications</span></span>
<span id="cb69-830"><a href="#cb69-830"></a></span>
<span id="cb69-831"><a href="#cb69-831"></a>Using the same model specifications as in @sec-specs from the 5-class classification.</span>
<span id="cb69-832"><a href="#cb69-832"></a></span>
<span id="cb69-833"><a href="#cb69-833"></a><span class="fu">### Create workflow set</span></span>
<span id="cb69-834"><a href="#cb69-834"></a></span>
<span id="cb69-835"><a href="#cb69-835"></a>Same process as in @sec-wf from the 5-class classification.</span>
<span id="cb69-836"><a href="#cb69-836"></a></span>
<span id="cb69-839"><a href="#cb69-839"></a><span class="in">```{r}</span></span>
<span id="cb69-840"><a href="#cb69-840"></a><span class="fu">library</span>(discrim)</span>
<span id="cb69-841"><a href="#cb69-841"></a></span>
<span id="cb69-842"><a href="#cb69-842"></a>balclr_sns_wf <span class="ot">&lt;-</span> </span>
<span id="cb69-843"><a href="#cb69-843"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_set</span>(</span>
<span id="cb69-844"><a href="#cb69-844"></a>      <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">balclr_sns =</span> balclr_sns_rec), </span>
<span id="cb69-845"><a href="#cb69-845"></a>      <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb69-846"><a href="#cb69-846"></a>        <span class="co">#SVM_radial = svm_r_spec, </span></span>
<span id="cb69-847"><a href="#cb69-847"></a>        <span class="co">#SVM_poly = svm_p_spec, </span></span>
<span id="cb69-848"><a href="#cb69-848"></a>        <span class="co">#CART = cart_spec, </span></span>
<span id="cb69-849"><a href="#cb69-849"></a>        <span class="co">#CART_bagged = bag_cart_spec,</span></span>
<span id="cb69-850"><a href="#cb69-850"></a>        <span class="co">#NNET = nnet_spec,</span></span>
<span id="cb69-851"><a href="#cb69-851"></a>        <span class="at">boosting =</span> xgb_spec,</span>
<span id="cb69-852"><a href="#cb69-852"></a>        <span class="co">#bart = bart_spec, </span></span>
<span id="cb69-853"><a href="#cb69-853"></a>        <span class="co">#fda = fda_spec,</span></span>
<span id="cb69-854"><a href="#cb69-854"></a>        <span class="at">RF =</span> rf_spec</span>
<span id="cb69-855"><a href="#cb69-855"></a>      )</span>
<span id="cb69-856"><a href="#cb69-856"></a>   )</span>
<span id="cb69-857"><a href="#cb69-857"></a><span class="in">```</span></span>
<span id="cb69-858"><a href="#cb69-858"></a></span>
<span id="cb69-859"><a href="#cb69-859"></a><span class="fu">### Tune</span></span>
<span id="cb69-860"><a href="#cb69-860"></a></span>
<span id="cb69-861"><a href="#cb69-861"></a>Same as in @sec-tune from the 5-class classification. Warning this takes some time...</span>
<span id="cb69-864"><a href="#cb69-864"></a><span class="in">```{r}</span></span>
<span id="cb69-865"><a href="#cb69-865"></a><span class="co">#| eval: false</span></span>
<span id="cb69-866"><a href="#cb69-866"></a><span class="co">#| echo: true</span></span>
<span id="cb69-867"><a href="#cb69-867"></a>balclr_sns_grid_results <span class="ot">&lt;-</span></span>
<span id="cb69-868"><a href="#cb69-868"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_map</span>(balclr_sns_wf, </span>
<span id="cb69-869"><a href="#cb69-869"></a>      <span class="at">seed =</span> <span class="dv">1569</span>,</span>
<span id="cb69-870"><a href="#cb69-870"></a>      <span class="at">resamples =</span> balclr_sns_folds,</span>
<span id="cb69-871"><a href="#cb69-871"></a>      <span class="at">grid =</span> <span class="dv">15</span>,</span>
<span id="cb69-872"><a href="#cb69-872"></a>      <span class="at">control =</span> tune<span class="sc">::</span><span class="fu">control_grid</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">parallel_over =</span> <span class="st">"everything"</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb69-873"><a href="#cb69-873"></a>      <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(recall, precision, f_meas, j_index, accuracy, kap, roc_auc, sens, spec),</span>
<span id="cb69-874"><a href="#cb69-874"></a>   )</span>
<span id="cb69-875"><a href="#cb69-875"></a></span>
<span id="cb69-876"><a href="#cb69-876"></a><span class="co"># save this for later</span></span>
<span id="cb69-877"><a href="#cb69-877"></a>readr<span class="sc">::</span><span class="fu">write_rds</span>(balclr_sns_grid_results, here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_sns.rds"</span>))</span>
<span id="cb69-878"><a href="#cb69-878"></a><span class="in">```</span></span>
<span id="cb69-879"><a href="#cb69-879"></a></span>
<span id="cb69-882"><a href="#cb69-882"></a><span class="in">```{r}</span></span>
<span id="cb69-883"><a href="#cb69-883"></a>balclr_sns_grid_results <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_sns.rds"</span>))</span>
<span id="cb69-884"><a href="#cb69-884"></a><span class="in">```</span></span>
<span id="cb69-885"><a href="#cb69-885"></a></span>
<span id="cb69-886"><a href="#cb69-886"></a><span class="fu">### Best tuning parameters and best performing models</span></span>
<span id="cb69-887"><a href="#cb69-887"></a></span>
<span id="cb69-888"><a href="#cb69-888"></a>First look at which of the models performed best. It appears that based on all metrics the random forest performs the best.</span>
<span id="cb69-889"><a href="#cb69-889"></a></span>
<span id="cb69-890"><a href="#cb69-890"></a>::: {#fig-12}</span>
<span id="cb69-893"><a href="#cb69-893"></a><span class="in">```{r}</span></span>
<span id="cb69-894"><a href="#cb69-894"></a>mymetric <span class="ot">&lt;-</span> <span class="st">"roc_auc"</span></span>
<span id="cb69-895"><a href="#cb69-895"></a></span>
<span id="cb69-896"><a href="#cb69-896"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(</span>
<span id="cb69-897"><a href="#cb69-897"></a>  balclr_sns_grid_results,</span>
<span id="cb69-898"><a href="#cb69-898"></a>  <span class="at">rank_metric =</span> mymetric,  </span>
<span id="cb69-899"><a href="#cb69-899"></a>  <span class="at">metric =</span> mymetric,       </span>
<span id="cb69-900"><a href="#cb69-900"></a>  <span class="co"># one point per workflow </span></span>
<span id="cb69-901"><a href="#cb69-901"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb69-902"><a href="#cb69-902"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb69-903"><a href="#cb69-903"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb69-904"><a href="#cb69-904"></a><span class="in">```</span></span>
<span id="cb69-905"><a href="#cb69-905"></a>Mean and standard deviation across train-test splits of the areas under the receiver operator curves for the different models.  boosting = Gradient Boosted Trees Classifier (XGBoost), RF = Random Forest Classifier (Ranger). Rose indicates that synthetic data has been generated using the ROSE algorithm to better balance the classes.</span>
<span id="cb69-906"><a href="#cb69-906"></a>:::</span>
<span id="cb69-907"><a href="#cb69-907"></a></span>
<span id="cb69-908"><a href="#cb69-908"></a><span class="fu">#### Peformance metrics for best model</span></span>
<span id="cb69-909"><a href="#cb69-909"></a></span>
<span id="cb69-910"><a href="#cb69-910"></a>All performance metrics are almost identical (making same overall predictions) with RF just having higher ROC auc</span>
<span id="cb69-911"><a href="#cb69-911"></a></span>
<span id="cb69-914"><a href="#cb69-914"></a><span class="in">```{r}</span></span>
<span id="cb69-915"><a href="#cb69-915"></a><span class="fu">set.seed</span>(<span class="dv">4671</span>)</span>
<span id="cb69-916"><a href="#cb69-916"></a>balclr_sns_rf_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_sns_grid_results,</span>
<span id="cb69-917"><a href="#cb69-917"></a>                                           <span class="st">"balclr_sns_RF"</span>,</span>
<span id="cb69-918"><a href="#cb69-918"></a>                                           <span class="st">"roc_auc"</span>,</span>
<span id="cb69-919"><a href="#cb69-919"></a>                                           balclr_sns_split)</span>
<span id="cb69-920"><a href="#cb69-920"></a>balclr_sns_boosting_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_sns_grid_results,</span>
<span id="cb69-921"><a href="#cb69-921"></a>                                                 <span class="st">"balclr_sns_boosting"</span>,</span>
<span id="cb69-922"><a href="#cb69-922"></a>                                                 <span class="st">"roc_auc"</span>,</span>
<span id="cb69-923"><a href="#cb69-923"></a>                                                 balclr_sns_split)</span>
<span id="cb69-924"><a href="#cb69-924"></a></span>
<span id="cb69-925"><a href="#cb69-925"></a><span class="fu">collect_format</span>(balclr_sns_rf_test_results, <span class="st">"random_forest"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-926"><a href="#cb69-926"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">collect_format</span>(balclr_sns_boosting_test_results, <span class="st">"boosting"</span>), <span class="at">by =</span> <span class="fu">join_by</span>(metric, estimate_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-927"><a href="#cb69-927"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(estimate_type, metric)</span>
<span id="cb69-928"><a href="#cb69-928"></a><span class="in">```</span></span>
<span id="cb69-929"><a href="#cb69-929"></a></span>
<span id="cb69-930"><a href="#cb69-930"></a><span class="fu">#### ROC and PR curves</span></span>
<span id="cb69-931"><a href="#cb69-931"></a></span>
<span id="cb69-932"><a href="#cb69-932"></a>ROC curves indicate that there is good performance for the evolution environments that either contain streptomycin or do not.</span>
<span id="cb69-933"><a href="#cb69-933"></a></span>
<span id="cb69-934"><a href="#cb69-934"></a>::: {#fig-13}</span>
<span id="cb69-937"><a href="#cb69-937"></a><span class="in">```{r}</span></span>
<span id="cb69-938"><a href="#cb69-938"></a>balclr_sns_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb69-939"><a href="#cb69-939"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-940"><a href="#cb69-940"></a>  yardstick<span class="sc">::</span><span class="fu">roc_curve</span>(home_env_sns, .pred_nostrep) <span class="sc">%&gt;%</span> </span>
<span id="cb69-941"><a href="#cb69-941"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb69-942"><a href="#cb69-942"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"FP rate"</span>, <span class="at">y =</span> <span class="st">"TP rate"</span>)</span>
<span id="cb69-943"><a href="#cb69-943"></a><span class="in">```</span></span>
<span id="cb69-944"><a href="#cb69-944"></a>ROC curve for True positive rate (TPR, vertical axis) versus the false positive rate (FPR, horizontal axis) for classifying the evolutionary history as either exposed to streptomycin or not in the experiment from the hold-out testing data. The dashed 1:1 line is the expected performance of a random classifier. Curves above the 1:1 are better performance than random. Curves below 1:1 are worse performance than random.</span>
<span id="cb69-945"><a href="#cb69-945"></a>:::</span>
<span id="cb69-946"><a href="#cb69-946"></a></span>
<span id="cb69-947"><a href="#cb69-947"></a>::: {#fig-14}</span>
<span id="cb69-950"><a href="#cb69-950"></a><span class="in">```{r}</span></span>
<span id="cb69-951"><a href="#cb69-951"></a>balclr_sns_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb69-952"><a href="#cb69-952"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-953"><a href="#cb69-953"></a>  yardstick<span class="sc">::</span><span class="fu">pr_curve</span>(home_env_sns, .pred_nostrep) <span class="sc">%&gt;%</span> </span>
<span id="cb69-954"><a href="#cb69-954"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb69-955"><a href="#cb69-955"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Recall"</span>, <span class="at">y =</span> <span class="st">"Precision"</span>)</span>
<span id="cb69-956"><a href="#cb69-956"></a><span class="in">```</span></span>
<span id="cb69-957"><a href="#cb69-957"></a>Precision recall curves for classifying the evolutionary history as either exposed to streptomycin or not in the experiment from the hold-out testing data. There is a good tuorial for interpretation of these plots on <span class="co">[</span><span class="ot">scikit-learn</span><span class="co">](https://scikit-learn.org/1.5/auto_examples/model_selection/plot_precision_recall.html)</span>. </span>
<span id="cb69-958"><a href="#cb69-958"></a>:::</span>
<span id="cb69-959"><a href="#cb69-959"></a></span>
<span id="cb69-960"><a href="#cb69-960"></a><span class="fu">#### Confusion matrix</span></span>
<span id="cb69-961"><a href="#cb69-961"></a></span>
<span id="cb69-962"><a href="#cb69-962"></a>::: {#fig-15}</span>
<span id="cb69-965"><a href="#cb69-965"></a><span class="in">```{r}</span></span>
<span id="cb69-966"><a href="#cb69-966"></a>balclr_sns_rf_test_results <span class="sc">%&gt;%</span> </span>
<span id="cb69-967"><a href="#cb69-967"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-968"><a href="#cb69-968"></a>  yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(home_env_sns, .pred_class) <span class="sc">%&gt;%</span></span>
<span id="cb69-969"><a href="#cb69-969"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">"heatmap"</span>) </span>
<span id="cb69-970"><a href="#cb69-970"></a><span class="in">```</span></span>
<span id="cb69-971"><a href="#cb69-971"></a>Confusion matrix showing the classifier performance on each of the two evolutionary history classes (strep exposure or no strep exposure) using the hold-out testing data. (nostrep = bact and bact_pred, strep = bact_strep, bact_pred_strep)</span>
<span id="cb69-972"><a href="#cb69-972"></a>:::</span>
<span id="cb69-973"><a href="#cb69-973"></a></span>
<span id="cb69-974"><a href="#cb69-974"></a><span class="fu">#### Probability distributions for the 2 classes</span></span>
<span id="cb69-975"><a href="#cb69-975"></a></span>
<span id="cb69-976"><a href="#cb69-976"></a>::: {#fig-16}</span>
<span id="cb69-979"><a href="#cb69-979"></a><span class="in">```{r}</span></span>
<span id="cb69-980"><a href="#cb69-980"></a>balclr_sns_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb69-981"><a href="#cb69-981"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-982"><a href="#cb69-982"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb69-983"><a href="#cb69-983"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred_strep, <span class="at">fill =</span> home_env_sns), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb69-984"><a href="#cb69-984"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Prediction Probability"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb69-985"><a href="#cb69-985"></a><span class="in">```</span></span>
<span id="cb69-986"><a href="#cb69-986"></a>Prediction probability densities (colors) for each observation of the two evolutionary history classes tested with the model. (nostrep = bact and bact_pred, strep = bact_strep, bact_pred_strep)</span>
<span id="cb69-987"><a href="#cb69-987"></a>:::</span>
<span id="cb69-988"><a href="#cb69-988"></a></span>
<span id="cb69-989"><a href="#cb69-989"></a><span class="fu">## 2 classes (predation history vs no predation history)</span></span>
<span id="cb69-990"><a href="#cb69-990"></a></span>
<span id="cb69-991"><a href="#cb69-991"></a><span class="fu">### Spliting</span></span>
<span id="cb69-992"><a href="#cb69-992"></a></span>
<span id="cb69-993"><a href="#cb69-993"></a>Done the same as in  @sec-split from the 5-class classification.</span>
<span id="cb69-994"><a href="#cb69-994"></a></span>
<span id="cb69-997"><a href="#cb69-997"></a><span class="in">```{r}</span></span>
<span id="cb69-998"><a href="#cb69-998"></a>balclr_pnp <span class="ot">&lt;-</span> balclr_md <span class="sc">%&gt;%</span> </span>
<span id="cb69-999"><a href="#cb69-999"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>home_env_5c, <span class="sc">-</span>home_env_ae, <span class="sc">-</span>home_env_sns) <span class="sc">%&gt;%</span> </span>
<span id="cb69-1000"><a href="#cb69-1000"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb69-1001"><a href="#cb69-1001"></a>         <span class="at">transfer =</span> <span class="fu">factor</span>(transfer),</span>
<span id="cb69-1002"><a href="#cb69-1002"></a>         <span class="at">measure_env =</span> <span class="fu">factor</span>(measure_env),</span>
<span id="cb69-1003"><a href="#cb69-1003"></a>         <span class="at">home_env_pnp =</span> <span class="fu">factor</span>(home_env_pnp)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-1004"><a href="#cb69-1004"></a>  <span class="co"># we omit the ancestral samples to keep it more balanced</span></span>
<span id="cb69-1005"><a href="#cb69-1005"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb69-1006"><a href="#cb69-1006"></a></span>
<span id="cb69-1007"><a href="#cb69-1007"></a><span class="fu">table</span>(balclr_pnp<span class="sc">$</span>home_env_pnp)</span>
<span id="cb69-1008"><a href="#cb69-1008"></a><span class="in">```</span></span>
<span id="cb69-1009"><a href="#cb69-1009"></a></span>
<span id="cb69-1012"><a href="#cb69-1012"></a><span class="in">```{r}</span></span>
<span id="cb69-1013"><a href="#cb69-1013"></a><span class="fu">set.seed</span>(<span class="dv">1567</span>)</span>
<span id="cb69-1014"><a href="#cb69-1014"></a>balclr_pnp_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(balclr_pnp, <span class="at">strata =</span> home_env_pnp)</span>
<span id="cb69-1015"><a href="#cb69-1015"></a>balclr_pnp_train <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(balclr_pnp_split)</span>
<span id="cb69-1016"><a href="#cb69-1016"></a>balclr_pnp_test  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(balclr_pnp_split)</span>
<span id="cb69-1017"><a href="#cb69-1017"></a><span class="in">```</span></span>
<span id="cb69-1018"><a href="#cb69-1018"></a></span>
<span id="cb69-1021"><a href="#cb69-1021"></a><span class="in">```{r}</span></span>
<span id="cb69-1022"><a href="#cb69-1022"></a><span class="fu">set.seed</span>(<span class="dv">1568</span>)</span>
<span id="cb69-1023"><a href="#cb69-1023"></a>balclr_pnp_folds <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(balclr_pnp_train, <span class="at">strata =</span> home_env_pnp)</span>
<span id="cb69-1024"><a href="#cb69-1024"></a><span class="in">```</span></span>
<span id="cb69-1025"><a href="#cb69-1025"></a></span>
<span id="cb69-1026"><a href="#cb69-1026"></a><span class="fu">### Recipe</span></span>
<span id="cb69-1027"><a href="#cb69-1027"></a></span>
<span id="cb69-1028"><a href="#cb69-1028"></a>Done the same as in @sec-recipe from the 5-class classification.</span>
<span id="cb69-1029"><a href="#cb69-1029"></a></span>
<span id="cb69-1032"><a href="#cb69-1032"></a><span class="in">```{r}</span></span>
<span id="cb69-1033"><a href="#cb69-1033"></a>balclr_pnp_rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(home_env_pnp <span class="sc">~</span> ., <span class="at">data =</span> balclr_pnp_train) <span class="sc">%&gt;%</span> </span>
<span id="cb69-1034"><a href="#cb69-1034"></a>  recipes<span class="sc">::</span><span class="fu">step_normalize</span>(od600, ciliate_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb69-1035"><a href="#cb69-1035"></a>  recipes<span class="sc">::</span><span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb69-1036"><a href="#cb69-1036"></a>  recipes<span class="sc">::</span><span class="fu">step_zv</span>(od600, ciliate_per_ml)</span>
<span id="cb69-1037"><a href="#cb69-1037"></a><span class="in">```</span></span>
<span id="cb69-1038"><a href="#cb69-1038"></a></span>
<span id="cb69-1039"><a href="#cb69-1039"></a><span class="fu">### Model specifications</span></span>
<span id="cb69-1040"><a href="#cb69-1040"></a></span>
<span id="cb69-1041"><a href="#cb69-1041"></a>Using the same model specifications as in @sec-specs from the 5-class classification.</span>
<span id="cb69-1042"><a href="#cb69-1042"></a></span>
<span id="cb69-1043"><a href="#cb69-1043"></a><span class="fu">### Create workflow set</span></span>
<span id="cb69-1044"><a href="#cb69-1044"></a></span>
<span id="cb69-1045"><a href="#cb69-1045"></a>Same process as in @sec-wf from the 5-class classification.</span>
<span id="cb69-1046"><a href="#cb69-1046"></a></span>
<span id="cb69-1049"><a href="#cb69-1049"></a><span class="in">```{r}</span></span>
<span id="cb69-1050"><a href="#cb69-1050"></a>balclr_pnp_wf <span class="ot">&lt;-</span> </span>
<span id="cb69-1051"><a href="#cb69-1051"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_set</span>(</span>
<span id="cb69-1052"><a href="#cb69-1052"></a>      <span class="at">preproc =</span> <span class="fu">list</span>(<span class="at">balclr_pnp =</span> balclr_pnp_rec), </span>
<span id="cb69-1053"><a href="#cb69-1053"></a>      <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb69-1054"><a href="#cb69-1054"></a>        <span class="co">#SVM_radial = svm_r_spec, </span></span>
<span id="cb69-1055"><a href="#cb69-1055"></a>        <span class="co">#SVM_poly = svm_p_spec, </span></span>
<span id="cb69-1056"><a href="#cb69-1056"></a>        <span class="co">#CART = cart_spec, </span></span>
<span id="cb69-1057"><a href="#cb69-1057"></a>        <span class="co">#CART_bagged = bag_cart_spec,</span></span>
<span id="cb69-1058"><a href="#cb69-1058"></a>        <span class="co">#NNET = nnet_spec,</span></span>
<span id="cb69-1059"><a href="#cb69-1059"></a>        <span class="at">boosting =</span> xgb_spec,</span>
<span id="cb69-1060"><a href="#cb69-1060"></a>        <span class="co">#bart = bart_spec, </span></span>
<span id="cb69-1061"><a href="#cb69-1061"></a>        <span class="co">#fda = fda_spec,</span></span>
<span id="cb69-1062"><a href="#cb69-1062"></a>        <span class="at">RF =</span> rf_spec</span>
<span id="cb69-1063"><a href="#cb69-1063"></a>      )</span>
<span id="cb69-1064"><a href="#cb69-1064"></a>   )</span>
<span id="cb69-1065"><a href="#cb69-1065"></a><span class="in">```</span></span>
<span id="cb69-1066"><a href="#cb69-1066"></a></span>
<span id="cb69-1067"><a href="#cb69-1067"></a><span class="fu">### Tune</span></span>
<span id="cb69-1068"><a href="#cb69-1068"></a></span>
<span id="cb69-1069"><a href="#cb69-1069"></a>Same as in @sec-tune from the 5-class classification. Warning this takes some time...</span>
<span id="cb69-1072"><a href="#cb69-1072"></a><span class="in">```{r}</span></span>
<span id="cb69-1073"><a href="#cb69-1073"></a><span class="co">#| eval: false</span></span>
<span id="cb69-1074"><a href="#cb69-1074"></a><span class="co">#| echo: true</span></span>
<span id="cb69-1075"><a href="#cb69-1075"></a>balclr_pnp_grid_results <span class="ot">&lt;-</span></span>
<span id="cb69-1076"><a href="#cb69-1076"></a>   workflowsets<span class="sc">::</span><span class="fu">workflow_map</span>(balclr_pnp_wf, </span>
<span id="cb69-1077"><a href="#cb69-1077"></a>      <span class="at">seed =</span> <span class="dv">1569</span>,</span>
<span id="cb69-1078"><a href="#cb69-1078"></a>      <span class="at">resamples =</span> balclr_pnp_folds,</span>
<span id="cb69-1079"><a href="#cb69-1079"></a>      <span class="at">grid =</span> <span class="dv">25</span>,</span>
<span id="cb69-1080"><a href="#cb69-1080"></a>      <span class="at">control =</span> tune<span class="sc">::</span><span class="fu">control_grid</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">parallel_over =</span> <span class="st">"everything"</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb69-1081"><a href="#cb69-1081"></a>      <span class="at">metrics =</span> yardstick<span class="sc">::</span><span class="fu">metric_set</span>(recall, precision, f_meas, j_index, accuracy, kap, roc_auc, sens, spec),</span>
<span id="cb69-1082"><a href="#cb69-1082"></a>   )</span>
<span id="cb69-1083"><a href="#cb69-1083"></a></span>
<span id="cb69-1084"><a href="#cb69-1084"></a><span class="co"># save this for later</span></span>
<span id="cb69-1085"><a href="#cb69-1085"></a>readr<span class="sc">::</span><span class="fu">write_rds</span>(balclr_pnp_grid_results, here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_pnp.rds"</span>))</span>
<span id="cb69-1086"><a href="#cb69-1086"></a><span class="in">```</span></span>
<span id="cb69-1087"><a href="#cb69-1087"></a></span>
<span id="cb69-1090"><a href="#cb69-1090"></a><span class="in">```{r}</span></span>
<span id="cb69-1091"><a href="#cb69-1091"></a>balclr_pnp_grid_results <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data_stp_ml, <span class="st">"model_tune_pnp.rds"</span>))</span>
<span id="cb69-1092"><a href="#cb69-1092"></a><span class="in">```</span></span>
<span id="cb69-1093"><a href="#cb69-1093"></a></span>
<span id="cb69-1094"><a href="#cb69-1094"></a><span class="fu">### Best tuning parameters and best performing models</span></span>
<span id="cb69-1095"><a href="#cb69-1095"></a></span>
<span id="cb69-1096"><a href="#cb69-1096"></a>First look at which of the models performed best. It appears that based on all metrics the random forest performs the best.</span>
<span id="cb69-1097"><a href="#cb69-1097"></a></span>
<span id="cb69-1098"><a href="#cb69-1098"></a>::: {#fig-17}</span>
<span id="cb69-1101"><a href="#cb69-1101"></a><span class="in">```{r}</span></span>
<span id="cb69-1102"><a href="#cb69-1102"></a>mymetric <span class="ot">&lt;-</span> <span class="st">"roc_auc"</span></span>
<span id="cb69-1103"><a href="#cb69-1103"></a></span>
<span id="cb69-1104"><a href="#cb69-1104"></a>tune<span class="sc">::</span><span class="fu">autoplot</span>(</span>
<span id="cb69-1105"><a href="#cb69-1105"></a>  balclr_pnp_grid_results,</span>
<span id="cb69-1106"><a href="#cb69-1106"></a>  <span class="at">rank_metric =</span> mymetric,  </span>
<span id="cb69-1107"><a href="#cb69-1107"></a>  <span class="at">metric =</span> mymetric,       </span>
<span id="cb69-1108"><a href="#cb69-1108"></a>  <span class="co"># one point per workflow </span></span>
<span id="cb69-1109"><a href="#cb69-1109"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb69-1110"><a href="#cb69-1110"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb69-1111"><a href="#cb69-1111"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb69-1112"><a href="#cb69-1112"></a><span class="in">```</span></span>
<span id="cb69-1113"><a href="#cb69-1113"></a>Mean and standard deviation across train-test splits of the areas under the receiver operator curves for the different models.  boosting = Gradient Boosted Trees Classifier (XGBoost), RF = Random Forest Classifier (Ranger). </span>
<span id="cb69-1114"><a href="#cb69-1114"></a>:::</span>
<span id="cb69-1115"><a href="#cb69-1115"></a></span>
<span id="cb69-1116"><a href="#cb69-1116"></a><span class="fu">#### Peformance metrics for best model</span></span>
<span id="cb69-1117"><a href="#cb69-1117"></a></span>
<span id="cb69-1118"><a href="#cb69-1118"></a>Clearly here random forest is doing better</span>
<span id="cb69-1121"><a href="#cb69-1121"></a><span class="in">```{r}</span></span>
<span id="cb69-1122"><a href="#cb69-1122"></a><span class="fu">set.seed</span>(<span class="dv">87605</span>)</span>
<span id="cb69-1123"><a href="#cb69-1123"></a>balclr_pnp_boosting_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_pnp_grid_results,</span>
<span id="cb69-1124"><a href="#cb69-1124"></a>                                                 <span class="st">"balclr_pnp_boosting"</span>,</span>
<span id="cb69-1125"><a href="#cb69-1125"></a>                                                 <span class="st">"j_index"</span>,</span>
<span id="cb69-1126"><a href="#cb69-1126"></a>                                                 balclr_pnp_split)</span>
<span id="cb69-1127"><a href="#cb69-1127"></a></span>
<span id="cb69-1128"><a href="#cb69-1128"></a>balclr_pnp_rf_test_results <span class="ot">&lt;-</span> <span class="fu">getmymetrics</span>(balclr_pnp_grid_results,</span>
<span id="cb69-1129"><a href="#cb69-1129"></a>                                           <span class="st">"balclr_pnp_RF"</span>,</span>
<span id="cb69-1130"><a href="#cb69-1130"></a>                                           <span class="st">"j_index"</span>,</span>
<span id="cb69-1131"><a href="#cb69-1131"></a>                                           balclr_pnp_split)</span>
<span id="cb69-1132"><a href="#cb69-1132"></a></span>
<span id="cb69-1133"><a href="#cb69-1133"></a><span class="fu">collect_format</span>(balclr_pnp_rf_test_results, <span class="st">"random_forest"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-1134"><a href="#cb69-1134"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">collect_format</span>(balclr_pnp_boosting_test_results, <span class="st">"boosting"</span>), <span class="at">by =</span> <span class="fu">join_by</span>(metric, estimate_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-1135"><a href="#cb69-1135"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(estimate_type, metric)</span>
<span id="cb69-1136"><a href="#cb69-1136"></a><span class="in">```</span></span>
<span id="cb69-1137"><a href="#cb69-1137"></a></span>
<span id="cb69-1138"><a href="#cb69-1138"></a><span class="fu">#### ROC and PR curves</span></span>
<span id="cb69-1139"><a href="#cb69-1139"></a></span>
<span id="cb69-1140"><a href="#cb69-1140"></a>ROC curves indicate that there is good performance for the evolution environments that either contain streptomycin or do not.</span>
<span id="cb69-1141"><a href="#cb69-1141"></a></span>
<span id="cb69-1142"><a href="#cb69-1142"></a>::: {#fig-18}</span>
<span id="cb69-1145"><a href="#cb69-1145"></a><span class="in">```{r}</span></span>
<span id="cb69-1146"><a href="#cb69-1146"></a>balclr_pnp_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb69-1147"><a href="#cb69-1147"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-1148"><a href="#cb69-1148"></a>  yardstick<span class="sc">::</span><span class="fu">roc_curve</span>(home_env_pnp, .pred_nopred) <span class="sc">%&gt;%</span></span>
<span id="cb69-1149"><a href="#cb69-1149"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb69-1150"><a href="#cb69-1150"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"FP rate"</span>, <span class="at">y =</span> <span class="st">"TP rate"</span>)</span>
<span id="cb69-1151"><a href="#cb69-1151"></a><span class="in">```</span></span>
<span id="cb69-1152"><a href="#cb69-1152"></a>ROC curve for True positive rate (TPR, vertical axis) versus the false positive rate (FPR, horizontal axis) for classifying the evolutionary history as either exposed to predator or not in the experiment from the hold-out testing data. The dashed 1:1 line is the expected performance of a random classifier. Curves above the 1:1 are better performance than random. Curves below 1:1 are worse performance than random.</span>
<span id="cb69-1153"><a href="#cb69-1153"></a>:::</span>
<span id="cb69-1154"><a href="#cb69-1154"></a></span>
<span id="cb69-1155"><a href="#cb69-1155"></a>::: {#fig-19}</span>
<span id="cb69-1158"><a href="#cb69-1158"></a><span class="in">```{r}</span></span>
<span id="cb69-1159"><a href="#cb69-1159"></a>balclr_pnp_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb69-1160"><a href="#cb69-1160"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-1161"><a href="#cb69-1161"></a>  yardstick<span class="sc">::</span><span class="fu">pr_curve</span>(home_env_pnp, .pred_nopred) <span class="sc">%&gt;%</span></span>
<span id="cb69-1162"><a href="#cb69-1162"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb69-1163"><a href="#cb69-1163"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Recall"</span>, <span class="at">y =</span> <span class="st">"Precision"</span>)</span>
<span id="cb69-1164"><a href="#cb69-1164"></a><span class="in">```</span></span>
<span id="cb69-1165"><a href="#cb69-1165"></a>Precision recall curves for classifying the YSK evolutionary history as either exposed to predator or not in the experiment from the hold-out testing data. There is a good tutorial for interpretation of these plots on <span class="co">[</span><span class="ot">scikit-learn</span><span class="co">](https://scikit-learn.org/1.5/auto_examples/model_selection/plot_precision_recall.html)</span>. </span>
<span id="cb69-1166"><a href="#cb69-1166"></a>:::</span>
<span id="cb69-1167"><a href="#cb69-1167"></a></span>
<span id="cb69-1168"><a href="#cb69-1168"></a><span class="fu">#### Confusion matrix</span></span>
<span id="cb69-1169"><a href="#cb69-1169"></a></span>
<span id="cb69-1170"><a href="#cb69-1170"></a>::: {#fig-20}</span>
<span id="cb69-1173"><a href="#cb69-1173"></a><span class="in">```{r}</span></span>
<span id="cb69-1174"><a href="#cb69-1174"></a>balclr_pnp_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb69-1175"><a href="#cb69-1175"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-1176"><a href="#cb69-1176"></a>  yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(home_env_pnp, .pred_class) <span class="sc">%&gt;%</span></span>
<span id="cb69-1177"><a href="#cb69-1177"></a>  tune<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">"heatmap"</span>)</span>
<span id="cb69-1178"><a href="#cb69-1178"></a><span class="in">```</span></span>
<span id="cb69-1179"><a href="#cb69-1179"></a>Confusion matrix showing the classifier performance on each of the two evolutionary history classes (predator exposure or no predator exposure) using the hold-out testing data. (nospred = bact and bact_strep, pred = bact_pred, bact_pred_strep)</span>
<span id="cb69-1180"><a href="#cb69-1180"></a>:::</span>
<span id="cb69-1181"><a href="#cb69-1181"></a></span>
<span id="cb69-1182"><a href="#cb69-1182"></a><span class="fu">#### Probability distributions for the 2 classes</span></span>
<span id="cb69-1183"><a href="#cb69-1183"></a></span>
<span id="cb69-1184"><a href="#cb69-1184"></a>::: {#fig-21}</span>
<span id="cb69-1187"><a href="#cb69-1187"></a><span class="in">```{r}</span></span>
<span id="cb69-1188"><a href="#cb69-1188"></a>balclr_pnp_rf_test_results <span class="sc">%&gt;%</span></span>
<span id="cb69-1189"><a href="#cb69-1189"></a>  tune<span class="sc">::</span><span class="fu">collect_predictions</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-1190"><a href="#cb69-1190"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb69-1191"><a href="#cb69-1191"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred_pred, <span class="at">fill =</span> home_env_pnp), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb69-1192"><a href="#cb69-1192"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Prediction Probability"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb69-1193"><a href="#cb69-1193"></a><span class="in">```</span></span>
<span id="cb69-1194"><a href="#cb69-1194"></a>Prediction probability densities (colors) for each observation of the two evolutionary history classes tested with the model. (nopred = bact and bact_strep, pred = bact_pred, bact_pred_strep)</span>
<span id="cb69-1195"><a href="#cb69-1195"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>