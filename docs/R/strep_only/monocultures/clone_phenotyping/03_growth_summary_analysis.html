<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shane Hogle">
<meta name="dcterms.date" content="2025-03-25">

<title>Analysis of growth summary data â€“ hambiEvoVEnv</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap-1f23bf93a17969024013c136d185e5ce.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../R/strep_only/monocultures/clone_phenotyping/01_growth_curve_qc.html">Clones workflow</a></li><li class="breadcrumb-item"><a href="../../../../R/strep_only/monocultures/clone_phenotyping/03_growth_summary_analysis.html">3) Analysis and plot</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../../">hambiEvoVEnv</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Community densities workflow</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/communities/cell_density/01_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1) Process and plot densities</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Community composition workflow</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/communities/amplicon_sp_counts/01_format_rbec_tab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1) Amplicon data wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/communities/amplicon_sp_counts/02_composition_plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2) Community composition barplot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/communities/amplicon_sp_counts/03_ordination_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3) Community ordination</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/communities/amplicon_sp_counts/04_diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4) Community diversity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/communities/amplicon_sp_counts/05_JSD_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5) Community JSD divergences</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Clones workflow</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/monocultures/clone_phenotyping/01_growth_curve_qc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1) Inspect/Smooth curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/monocultures/clone_phenotyping/02_growthrate_auc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2) Summarize curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../R/strep_only/monocultures/clone_phenotyping/03_growth_summary_analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">3) Analysis and plot</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup"><span class="header-section-number">1</span> Setup</a></li>
  <li><a href="#read-data" id="toc-read-data" class="nav-link" data-scroll-target="#read-data"><span class="header-section-number">2</span> Read data</a></li>
  <li><a href="#formatting" id="toc-formatting" class="nav-link" data-scroll-target="#formatting"><span class="header-section-number">3</span> Formatting</a></li>
  <li><a href="#compare-auc" id="toc-compare-auc" class="nav-link" data-scroll-target="#compare-auc"><span class="header-section-number">4</span> Compare AUC</a>
  <ul class="collapse">
  <li><a href="#plot-raw-data" id="toc-plot-raw-data" class="nav-link" data-scroll-target="#plot-raw-data"><span class="header-section-number">4.1</span> Plot raw data</a></li>
  <li><a href="#lmm-fit" id="toc-lmm-fit" class="nav-link" data-scroll-target="#lmm-fit"><span class="header-section-number">4.2</span> LMM fit</a>
  <ul class="collapse">
  <li><a href="#posterior-predictive-check" id="toc-posterior-predictive-check" class="nav-link" data-scroll-target="#posterior-predictive-check"><span class="header-section-number">4.2.1</span> Posterior predictive check</a></li>
  <li><a href="#convergence-check" id="toc-convergence-check" class="nav-link" data-scroll-target="#convergence-check"><span class="header-section-number">4.2.2</span> Convergence check</a></li>
  <li><a href="#model-parameters" id="toc-model-parameters" class="nav-link" data-scroll-target="#model-parameters"><span class="header-section-number">4.2.3</span> Model parameters</a></li>
  <li><a href="#model-contrasts" id="toc-model-contrasts" class="nav-link" data-scroll-target="#model-contrasts"><span class="header-section-number">4.2.4</span> Model Contrasts</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#compare-strep-sensitivity-of-resistant-clones" id="toc-compare-strep-sensitivity-of-resistant-clones" class="nav-link" data-scroll-target="#compare-strep-sensitivity-of-resistant-clones"><span class="header-section-number">5</span> Compare strep sensitivity of resistant clones</a>
  <ul class="collapse">
  <li><a href="#plot-strep-sensitivity" id="toc-plot-strep-sensitivity" class="nav-link" data-scroll-target="#plot-strep-sensitivity"><span class="header-section-number">5.1</span> Plot strep sensitivity</a></li>
  <li><a href="#sensitivity-of-intrinisically-resistant-clones" id="toc-sensitivity-of-intrinisically-resistant-clones" class="nav-link" data-scroll-target="#sensitivity-of-intrinisically-resistant-clones"><span class="header-section-number">5.2</span> Sensitivity of intrinisically resistant clones</a>
  <ul class="collapse">
  <li><a href="#lmm-fit-1" id="toc-lmm-fit-1" class="nav-link" data-scroll-target="#lmm-fit-1"><span class="header-section-number">5.2.1</span> LMM Fit</a></li>
  <li><a href="#posterior-predictive-check-1" id="toc-posterior-predictive-check-1" class="nav-link" data-scroll-target="#posterior-predictive-check-1"><span class="header-section-number">5.2.2</span> Posterior predictive check</a></li>
  <li><a href="#convergence-check-1" id="toc-convergence-check-1" class="nav-link" data-scroll-target="#convergence-check-1"><span class="header-section-number">5.2.3</span> Convergence check</a></li>
  <li><a href="#model-parameters-1" id="toc-model-parameters-1" class="nav-link" data-scroll-target="#model-parameters-1"><span class="header-section-number">5.2.4</span> Model parameters</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#final-combined-plot-of-auc-and-s" id="toc-final-combined-plot-of-auc-and-s" class="nav-link" data-scroll-target="#final-combined-plot-of-auc-and-s"><span class="header-section-number">6</span> Final combined plot of AUC and S</a>
  <ul class="collapse">
  <li><a href="#export" id="toc-export" class="nav-link" data-scroll-target="#export"><span class="header-section-number">6.1</span> Export</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../R/strep_only/monocultures/clone_phenotyping/01_growth_curve_qc.html">Clones workflow</a></li><li class="breadcrumb-item"><a href="../../../../R/strep_only/monocultures/clone_phenotyping/03_growth_summary_analysis.html">3) Analysis and plot</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Analysis of growth summary data</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">From the STR clones workflow</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shane Hogle </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 25, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    Plots AUC for different experimental measurement/home combinations. In this part of the experiment 32 clones were randomly isolated from endpoint the long-term evolution pre-experiment (background or streptomycin). Then each clone was grown either in 20% R2A with or without streptomycin for 48 hours in the log-phase microbial growth reader. In this way streptomycin sensitivity was measured for every clone from every evolutionary history of the pre-experiment. Here we are trying to ask whether the community-averaged streptomycin sensitivity differed between the evolutionary treatments. I am not sure yet why this question is relavantâ€¦
  </div>
</div>


</header>


<section id="setup" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setup</h1>
<p>Load required packages</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(fs)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(easystats)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils_generic.R"</span>))</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a>data_raw <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_data_raw"</span>, <span class="st">"monocultures"</span>, <span class="st">"20230112_clone_phenotyping"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="read-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Read data</h1>
<p>Experiment information (e.g., which wells correspond to which clones from which condition)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>mddf <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(</span>
<span id="cb2-2"><a href="#cb2-2"></a>  here<span class="sc">::</span><span class="fu">here</span>(data_raw, <span class="st">"metadata.tsv"</span>),</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="at">col_types =</span> <span class="fu">list</span>(</span>
<span id="cb2-4"><a href="#cb2-4"></a>    <span class="at">plate =</span> <span class="fu">col_character</span>(),</span>
<span id="cb2-5"><a href="#cb2-5"></a>    <span class="at">well =</span> <span class="fu">col_character</span>(),</span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="at">clone_id =</span> <span class="fu">col_double</span>(),</span>
<span id="cb2-7"><a href="#cb2-7"></a>    <span class="at">experiment_treatment =</span> <span class="fu">col_character</span>(),</span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="at">LTCSE_treatment =</span> <span class="fu">col_character</span>(),</span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="at">replicate =</span> <span class="fu">col_character</span>(),</span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="at">lagtime =</span> <span class="fu">col_time</span>(<span class="at">format =</span> <span class="st">"%T"</span>),</span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="at">max_growth_death_rate =</span> <span class="fu">col_double</span>(),</span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="at">time_to_stationary =</span> <span class="fu">col_time</span>(<span class="at">format =</span> <span class="st">"%T"</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a>  )</span>
<span id="cb2-14"><a href="#cb2-14"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>  <span class="fu">filter</span>(measure_env <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"bact"</span>, <span class="st">"bact_strep"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-16"><a href="#cb2-16"></a>  <span class="fu">filter</span>(evolution_env <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"anc"</span>, <span class="st">"bact"</span>, <span class="st">"bact_strep"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-17"><a href="#cb2-17"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-18"><a href="#cb2-18"></a>    <span class="at">measure_env_short =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-19"><a href="#cb2-19"></a>      measure_env <span class="sc">==</span> <span class="st">"bact"</span> <span class="sc">~</span> <span class="st">"Meas: B"</span>,</span>
<span id="cb2-20"><a href="#cb2-20"></a>      measure_env <span class="sc">==</span> <span class="st">"bact_strep"</span> <span class="sc">~</span> <span class="st">"Meas: BS"</span></span>
<span id="cb2-21"><a href="#cb2-21"></a>    )</span>
<span id="cb2-22"><a href="#cb2-22"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="at">home_env_short =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-25"><a href="#cb2-25"></a>      evolution_env <span class="sc">==</span> <span class="st">"anc"</span> <span class="sc">~</span> <span class="st">"Home: Anc"</span>,</span>
<span id="cb2-26"><a href="#cb2-26"></a>      evolution_env <span class="sc">==</span> <span class="st">"bact"</span> <span class="sc">~</span> <span class="st">"Home: B"</span>,</span>
<span id="cb2-27"><a href="#cb2-27"></a>      evolution_env <span class="sc">==</span> <span class="st">"bact_strep"</span> <span class="sc">~</span> <span class="st">"Home: BS"</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>    )</span>
<span id="cb2-29"><a href="#cb2-29"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-31"><a href="#cb2-31"></a>    <span class="at">measure_env_short =</span> <span class="fu">factor</span>(</span>
<span id="cb2-32"><a href="#cb2-32"></a>      measure_env_short,</span>
<span id="cb2-33"><a href="#cb2-33"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Meas: B"</span>, <span class="st">"Meas: BS"</span>)</span>
<span id="cb2-34"><a href="#cb2-34"></a>    ),</span>
<span id="cb2-35"><a href="#cb2-35"></a>    <span class="at">home_env_short =</span> <span class="fu">factor</span>(</span>
<span id="cb2-36"><a href="#cb2-36"></a>      home_env_short,</span>
<span id="cb2-37"><a href="#cb2-37"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Home: Anc"</span>, <span class="st">"Home: B"</span>, <span class="st">"Home: BS"</span>)</span>
<span id="cb2-38"><a href="#cb2-38"></a>    ),</span>
<span id="cb2-39"><a href="#cb2-39"></a>    <span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb2-40"><a href="#cb2-40"></a>    <span class="at">clone_id =</span> <span class="fu">factor</span>(clone_id)</span>
<span id="cb2-41"><a href="#cb2-41"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Blacklist (i.e., samples that have been manually inspected and should be excluded due to strange features)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>blacklist <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_cl, <span class="st">"blacklist.tsv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Growth summary data</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>auc_grates <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_cl, <span class="st">"auc_mumax_results.tsv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="formatting" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Formatting</h1>
<p>Anti join black list to growth curves to remove the bad growth curves and join to experiment metadata</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>auc_gr_md <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(auc_grates, mddf, <span class="at">by =</span> <span class="fu">join_by</span>(plate, well)) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">anti_join</span>(blacklist, <span class="at">by =</span> <span class="fu">join_by</span>(plate, well))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Subset, pivot, and calculate difference between bacteria only and bacteria + streptomycin. In the variables it is called fitness although that is kind of a misnomer. What it actually measures is the excess growth of each clone without streptomycin relative to growth of that same clone with streptomycin.</p>
</section>
<section id="compare-auc" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Compare AUC</h1>
<section id="plot-raw-data" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="plot-raw-data"><span class="header-section-number">4.1</span> Plot raw data</h2>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>p01 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(auc_gr_md, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">interaction</span>(measure_env, evolution_env), <span class="at">y =</span> auc)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width=</span><span class="fl">0.35</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.35</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Measure env:Evol hist"</span>, <span class="at">y =</span> <span class="st">"Area under growth curve (AUC, unitless)"</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a>p01</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_growth_summary_analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Area under the growth curve for 32 randomly isolated clones from six replicates of each evolutionary history (background/<code>bact</code>, streptomcyin/<code>bact_strep</code>) grown either with or without streptomycin (<code>bact</code> or <code>bact_strep</code>, respectively). The horizontal axis shows the interaction of evolutionary history and measurement environment (e.g., the first column shows background evolved bacteria grown without streptomycin).
</figcaption>
</figure>
</div>
<p>A couple features to noteâ€¦ The difference in AUC with or without streptomycin appears small for streptomycin evolved clones (<code>bact_strep:bact</code> vs <code>bact_strep:bact_strep</code>). Clones from the streptomycin evolved community do not obviously appear to have suffered some kind of cost of resistance when growing without streptomycin. However, the differences in AUC with/without streptomycin are quite large for clones isolated from the background-evolved communities (<code>bact:bact</code> vs <code>bact:bact_strep</code>). Thus, many streptomycin sensitive clones appear to have been isolated from background community.</p>
</section>
<section id="lmm-fit" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="lmm-fit"><span class="header-section-number">4.2</span> LMM fit</h2>
<p>This models auc as a function of evolution history the measurement condition and the interaction between the two. We used replicate with clone_id nested within replicate as random effects (clones were measured more than once). We are using <code>brms</code> here so the traditional frequentist p-value doesnâ€™t apply. Instead we think about the proportion of the posterior that has a consistent direction (e.g., over/under 0).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">set.seed</span>(<span class="dv">37814</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>brmmod <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(auc <span class="sc">~</span> evolution_env<span class="sc">*</span>measure_env <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>replicate<span class="sc">/</span>clone_id), <span class="at">data =</span> auc_gr_md)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="posterior-predictive-check" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="posterior-predictive-check"><span class="header-section-number">4.2.1</span> Posterior predictive check</h3>
<p>doesnâ€™t suggest anything amiss</p>
<div id="fig-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_growth_summary_analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Density overlay posterior predictive check from 50 posterior draws. Vertical = density distribution of posterior (yrep) compared to observed data (y), horizontal = AUC values
</figcaption>
</figure>
</div>
</section>
<section id="convergence-check" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="convergence-check"><span class="header-section-number">4.2.2</span> Convergence check</h3>
<p>All chains appear to have converged</p>
<div id="fig-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_growth_summary_analysis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Left: histogram of estimated model parameters. Right: traces of MCMC chains
</figcaption>
</figure>
</div>
</section>
<section id="model-parameters" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="model-parameters"><span class="header-section-number">4.2.3</span> Model parameters</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(brmmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Parameter"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Component"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Median"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["pd"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Rhat"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["ESS"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"b_Intercept","2":"conditional","3":"16.347767","4":"0.95","5":"15.6624280","6":"17.0361129","7":"1.00000","8":"1.001470","9":"2441.185"},{"1":"b_evolution_envbact_strep","2":"conditional","3":"0.103931","4":"0.95","5":"-0.5584808","6":"0.7950806","7":"0.61225","8":"0.999702","9":"3907.085"},{"1":"b_measure_envbact_strep","2":"conditional","3":"-6.925203","4":"0.95","5":"-7.6181014","6":"-6.2717883","7":"1.00000","8":"1.000203","9":"3678.240"},{"1":"b_evolution_envbact_strep:measure_envbact_strep","2":"conditional","3":"6.910187","4":"0.95","5":"5.9909485","6":"7.8562160","7":"1.00000","8":"1.000089","9":"3719.713"},{"1":"sigma","2":"sigma","3":"3.186930","4":"0.95","5":"3.0296116","6":"3.3613441","7":"1.00000","8":"1.000360","9":"5383.545"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="model-contrasts" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="model-contrasts"><span class="header-section-number">4.2.4</span> Model Contrasts</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>modelbased<span class="sc">::</span><span class="fu">estimate_contrasts</span>(brmmod, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"evolution_env"</span>, <span class="st">"measure_env"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Level1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Level2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Difference"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["pd"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["ROPE_Percentage"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"bact bact","2":"bact_strep bact","3":"-0.10393101","4":"-0.7950806","5":"0.5584808","6":"0.61225","7":"0.2257895"},{"1":"bact bact","2":"bact bact_strep","3":"6.92520336","4":"6.2717883","5":"7.6181014","6":"1.00000","7":"0.0000000"},{"1":"bact bact","2":"bact_strep bact_strep","3":"-0.08874128","4":"-0.7572488","5":"0.5689561","6":"0.60200","7":"0.2307895"},{"1":"bact_strep bact","2":"bact bact_strep","3":"7.04048268","4":"6.3754619","5":"7.6991849","6":"1.00000","7":"0.0000000"},{"1":"bact_strep bact","2":"bact_strep bact_strep","3":"0.01602348","4":"-0.6397886","5":"0.6622274","6":"0.51975","7":"0.2360526"},{"1":"bact bact_strep","2":"bact_strep bact_strep","3":"-7.01184021","4":"-7.6683284","5":"-6.3884808","6":"1.00000","7":"0.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>What the contrast analysis shows is what was apparent from looking at <a href="#fig-01" class="quarto-xref">Figure&nbsp;1</a>. Basically, clones from the streptomycin evolved communities donâ€™t have significant growth differences with or without streptomycin, while clones from the background evolved communities do. This is pretty unsurprising I think.</p>
</section>
</section>
</section>
<section id="compare-strep-sensitivity-of-resistant-clones" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Compare strep sensitivity of resistant clones</h1>
<p>In <a href="#fig-01" class="quarto-xref">Figure&nbsp;1</a> it is clear that there are many clones from the background evolutionary history with poor growth in the streptomycin conditions (i.e., high streptomycin sensitivity). Since each clone was phenotyped in both measurement environments we can calculate a streptomycin â€˜growth sensitivityâ€™ as</p>
<p><span class="math display">\[
S_{i,j} = A_{i,j} - A_{i,j}^{STR}
\]</span> Where <span class="math inline">\(S_{i,j}\)</span> is the sensitivity of clone <span class="math inline">\(i\)</span> from microcosm <span class="math inline">\(j\)</span> to streptomycin, <span class="math inline">\(A_{i,j}\)</span> is the AUC for clone <span class="math inline">\(i\)</span> from microcosm <span class="math inline">\(j\)</span> growth <em>without</em> streptomycin and <span class="math inline">\(A_{i,j}^{STR}\)</span> is the AUC for clone <span class="math inline">\(i\)</span> from microcosm <span class="math inline">\(j\)</span> growth <em>with</em> streptomycin.</p>
<p>When <span class="math inline">\(S_{i,j} \gt 0\)</span> then the clone has more growth in the absence of streptomycin. If there is a clear growth differences between streptomycin and no-streptomycin conditions we should expect <span class="math inline">\(S_{i,j} \gt 0\)</span>. Alternatively, if a clone grows equally well with or without streptomycin then we could expect <span class="math inline">\(S_{i,j} \approx 0\)</span>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>auc_gr_md_subset <span class="ot">&lt;-</span> auc_gr_md <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb10-3"><a href="#cb10-3"></a>    auc,</span>
<span id="cb10-4"><a href="#cb10-4"></a>    measure_env,</span>
<span id="cb10-5"><a href="#cb10-5"></a>    evolution_env,</span>
<span id="cb10-6"><a href="#cb10-6"></a>    replicate,</span>
<span id="cb10-7"><a href="#cb10-7"></a>    clone_id</span>
<span id="cb10-8"><a href="#cb10-8"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">"evolution_env"</span>, <span class="st">"replicate"</span>, <span class="st">"clone_id"</span>), </span>
<span id="cb10-10"><a href="#cb10-10"></a>              <span class="at">names_from =</span> measure_env, <span class="at">values_from =</span> auc) <span class="sc">%&gt;%</span> </span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="fu">mutate</span>(<span class="at">fitness =</span> bact <span class="sc">-</span> bact_strep) <span class="sc">%&gt;%</span> </span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="fu">mutate</span>(<span class="at">flag =</span> <span class="fu">if_else</span>(fitness <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here we plot sensitivity for the two community evolutionary histories. Most clones from the streptomycin evolved community have an excess growth <span class="math inline">\(\approx 0\)</span> (<a href="#fig-01" class="quarto-xref">Figure&nbsp;1</a>). This indicates that the overwhelming majority of isolated clones were streptomycin resistant and growth under both conditions was similar. Many clones from the background evolved community have <em>high</em> growth excesses (values &gt; 10, <a href="#fig-01" class="quarto-xref">Figure&nbsp;1</a>). This indicates that many streptomycin sensitive clones were isolated from the background evolved community. However, there are also many clones with growth excess <span class="math inline">\(\approx 0\)</span> which indicates that innately streptomycin resistant clones were also isolated from the background evolved community.</p>
<section id="plot-strep-sensitivity" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="plot-strep-sensitivity"><span class="header-section-number">5.1</span> Plot strep sensitivity</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>pexg <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">drop_na</span>(auc_gr_md_subset) <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> evolution_env, <span class="at">y =</span> fitness)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="at">data =</span> <span class="fu">filter</span>(auc_gr_md_subset, fitness <span class="sc">&lt;</span> <span class="dv">5</span>), <span class="at">outliers =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width=</span><span class="fl">0.35</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.35</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Home environment"</span>, <span class="at">y =</span> <span class="st">"STR sensitivity"</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  ggforce<span class="sc">::</span><span class="fu">facet_zoom</span>(<span class="at">y =</span> flag <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fig-04" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_growth_summary_analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Community streptomycin sensitivity from different evolutionary histories of the pre-experiment.
</figcaption>
</figure>
</div>
</section>
<section id="sensitivity-of-intrinisically-resistant-clones" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sensitivity-of-intrinisically-resistant-clones"><span class="header-section-number">5.2</span> Sensitivity of intrinisically resistant clones</h2>
<p>Note that above we observed clones from both evolution treatments that were intrinsically resistant to streptomycin. One question is whether the resistant clones from the background evolved community have a higher streptomycin sensitivity compared to resistant clones from the streptomycin evolved community. I would predict that clones from the background community that were already quite streptomycin resistant have a higher (<span class="math inline">\(S\)</span>) sensitivity than those from the streptomycin evolved community because clones from the strep community would have had time to adapt/evolve to streptomycin.</p>
<p>We can test this prediction using a linear model for (<span class="math inline">\(S\)</span>) sensitivity as a function of the evolution environment. First we filter to only include intrinsically resistant clones (operationally defined as those with sensitivity less than 5). Then we fit the model but with zero intercept so that we compare each group to 0 instead of using one group as the intercept.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>auc_gr_md_subset_filt <span class="ot">&lt;-</span> auc_gr_md_subset <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">filter</span>(flag <span class="sc">==</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">mutate</span>(<span class="at">evolution_env =</span> <span class="fu">factor</span>(evolution_env, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"bact"</span>, <span class="st">"bact_strep"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="lmm-fit-1" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="lmm-fit-1"><span class="header-section-number">5.2.1</span> LMM Fit</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">set.seed</span>(<span class="dv">8435</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>brmmod0 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(fitness <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> evolution_env <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>replicate), <span class="at">data =</span> auc_gr_md_subset_filt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="posterior-predictive-check-1" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="posterior-predictive-check-1"><span class="header-section-number">5.2.2</span> Posterior predictive check</h3>
<p>doesnâ€™t suggest anything amiss</p>
<div id="fig-05" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_growth_summary_analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Density overlay posterior predictive check from 50 posterior draws. Vertical = density distribution of posterior (yrep) compared to observed data (y), horizontal = AUC values
</figcaption>
</figure>
</div>
</section>
<section id="convergence-check-1" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="convergence-check-1"><span class="header-section-number">5.2.3</span> Convergence check</h3>
<p>All chains appear to have converged</p>
<div id="fig-06" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_growth_summary_analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Left: histogram of estimated model parameters. Right: traces of MCMC chains
</figcaption>
</figure>
</div>
</section>
<section id="model-parameters-1" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="model-parameters-1"><span class="header-section-number">5.2.4</span> Model parameters</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(brmmod0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Parameter"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Component"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Median"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["pd"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Rhat"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["ESS"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"b_evolution_envbact","2":"conditional","3":"0.42972049","4":"0.95","5":"-0.0840117","6":"0.8822032","7":"0.95525","8":"1.0042806","9":"968.0686"},{"1":"b_evolution_envbact_strep","2":"conditional","3":"-0.05835509","4":"0.95","5":"-0.5229517","6":"0.3758729","7":"0.61950","8":"1.0036629","9":"862.6028"},{"1":"sigma","2":"sigma","3":"1.13615256","4":"0.95","5":"1.0427040","6":"1.2372894","7":"1.00000","8":"0.9992136","9":"2900.8839"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>So the results from the zero intercept model show that resistant clones from the background evolutionary history have a median Streptomycin sensitivity of 0.43 with a probability of direction (pd) of 95.5% while clones from the streptomycin evolutionary history communities have a mean sensitivity of -0.06 with a pd of about 62%. Sensitivity from the streptomycin history is statistically indistinguishable from zero, which makes sense and is consistent with what we saw in <a href="#fig-04" class="quarto-xref">Figure&nbsp;4</a>.</p>
<p>However, it seems that resistant clones from the background community have a small but significantly higher sensitivity to streptomycin. Overall I donâ€™t think this is too surprising that naturally resistant clones isolated from the evolution conditions with streptomycin are less sensitive to stretomycin than those that were evolving without it.</p>
</section>
</section>
</section>
<section id="final-combined-plot-of-auc-and-s" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Final combined plot of AUC and S</h1>
<div id="fig-07" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_growth_summary_analysis_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol type="A">
<li>Area under the growth curve for 32 randomly isolated clones from six replicates of each evolutionary history (background/<code>bact</code>, streptomcyin/<code>bact_strep</code>) grown either with or without streptomycin (<code>bact</code> or <code>bact_strep</code>, respectively). The horizontal axis shows the interaction of measurement environment with evolutionary history (e.g., the first column shows the no-streptomycin measurement for background evolved bacteria). Community streptomycin sensitivity from different evolutionary histories of the pre-experiment. For each clone phenotyped with or without streptomcyin the streptomycin sensitivity is defined as <span class="math inline">\(S_{i,j} = A_{i,j} - A_{i,j}^{STR}\)</span> where <span class="math inline">\(S_{i,j}\)</span> is the sensitivity of clone <span class="math inline">\(i\)</span> from microcosm <span class="math inline">\(j\)</span> to streptomycin, <span class="math inline">\(A_{i,j}\)</span> is the AUC for clone <span class="math inline">\(i\)</span> from microcosm <span class="math inline">\(j\)</span> growth <em>without</em> streptomycin and <span class="math inline">\(A_{i,j}^{STR}\)</span> is the AUC for clone <span class="math inline">\(i\)</span> from microcosm <span class="math inline">\(j\)</span> growth <em>with</em> streptomycin.</li>
</ol>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7
</figcaption>
</figure>
</div>
<section id="export" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="export"><span class="header-section-number">6.1</span> Export</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb15-2"><a href="#cb15-2"></a>  here<span class="sc">::</span><span class="fu">here</span>(figs, <span class="st">"monoculture_clone_phenotyping_auc.svg"</span>),</span>
<span id="cb15-3"><a href="#cb15-3"></a>  pf,</span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="at">height =</span> <span class="dv">7</span>,</span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="at">device =</span> <span class="st">"svg"</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>)</span>
<span id="cb15-9"><a href="#cb15-9"></a></span>
<span id="cb15-10"><a href="#cb15-10"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb15-11"><a href="#cb15-11"></a>  here<span class="sc">::</span><span class="fu">here</span>(figs, <span class="st">"monoculture_clone_phenotyping_auc.png"</span>),</span>
<span id="cb15-12"><a href="#cb15-12"></a>  pf,</span>
<span id="cb15-13"><a href="#cb15-13"></a>  <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb15-14"><a href="#cb15-14"></a>  <span class="at">height =</span> <span class="dv">7</span>,</span>
<span id="cb15-15"><a href="#cb15-15"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb15-16"><a href="#cb15-16"></a>  <span class="at">device =</span> <span class="st">"png"</span></span>
<span id="cb15-17"><a href="#cb15-17"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb16" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">---</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="an">title:</span><span class="co"> "Analysis of growth summary data"</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="an">subtitle:</span><span class="co"> "From the STR clones workflow"</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="an">author:</span><span class="co"> "Shane Hogle"</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="an">abstract:</span><span class="co"> "Plots AUC for different experimental measurement/home combinations. In this part of the experiment 32 clones were randomly isolated from endpoint the long-term evolution pre-experiment (background or streptomycin). Then each clone was grown either in 20% R2A with or without streptomycin for 48 hours in the log-phase microbial growth reader. In this way streptomycin sensitivity was measured for every clone from every evolutionary history of the pre-experiment. Here we are trying to ask whether the community-averaged streptomycin sensitivity differed between the evolutionary treatments. I am not sure yet why this question is relavant..."</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">---</span></span>
<span id="cb16-8"><a href="#cb16-8"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="fu"># Setup</span></span>
<span id="cb16-10"><a href="#cb16-10"></a></span>
<span id="cb16-11"><a href="#cb16-11"></a>Load required packages</span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="in">```{r}</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">#| output: false</span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co">#| warning: false</span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="co">#| error: false</span></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="fu">library</span>(here)</span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="fu">library</span>(stringr)</span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="fu">library</span>(fs)</span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="fu">library</span>(easystats)</span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="fu">library</span>(brms)</span>
<span id="cb16-27"><a href="#cb16-27"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils_generic.R"</span>))</span>
<span id="cb16-28"><a href="#cb16-28"></a></span>
<span id="cb16-29"><a href="#cb16-29"></a>data_raw <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_data_raw"</span>, <span class="st">"monocultures"</span>, <span class="st">"20230112_clone_phenotyping"</span>)</span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="in">```</span></span>
<span id="cb16-31"><a href="#cb16-31"></a></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="fu"># Read data</span></span>
<span id="cb16-33"><a href="#cb16-33"></a></span>
<span id="cb16-34"><a href="#cb16-34"></a>Experiment information (e.g., which wells correspond to which clones from which condition)</span>
<span id="cb16-35"><a href="#cb16-35"></a></span>
<span id="cb16-38"><a href="#cb16-38"></a><span class="in">```{r}</span></span>
<span id="cb16-39"><a href="#cb16-39"></a><span class="co">#| output: false</span></span>
<span id="cb16-40"><a href="#cb16-40"></a><span class="co">#| warning: false</span></span>
<span id="cb16-41"><a href="#cb16-41"></a><span class="co">#| error: false</span></span>
<span id="cb16-42"><a href="#cb16-42"></a>mddf <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(</span>
<span id="cb16-43"><a href="#cb16-43"></a>  here<span class="sc">::</span><span class="fu">here</span>(data_raw, <span class="st">"metadata.tsv"</span>),</span>
<span id="cb16-44"><a href="#cb16-44"></a>  <span class="at">col_types =</span> <span class="fu">list</span>(</span>
<span id="cb16-45"><a href="#cb16-45"></a>    <span class="at">plate =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-46"><a href="#cb16-46"></a>    <span class="at">well =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-47"><a href="#cb16-47"></a>    <span class="at">clone_id =</span> <span class="fu">col_double</span>(),</span>
<span id="cb16-48"><a href="#cb16-48"></a>    <span class="at">experiment_treatment =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-49"><a href="#cb16-49"></a>    <span class="at">LTCSE_treatment =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-50"><a href="#cb16-50"></a>    <span class="at">replicate =</span> <span class="fu">col_character</span>(),</span>
<span id="cb16-51"><a href="#cb16-51"></a>    <span class="at">lagtime =</span> <span class="fu">col_time</span>(<span class="at">format =</span> <span class="st">"%T"</span>),</span>
<span id="cb16-52"><a href="#cb16-52"></a>    <span class="at">max_growth_death_rate =</span> <span class="fu">col_double</span>(),</span>
<span id="cb16-53"><a href="#cb16-53"></a>    <span class="at">time_to_stationary =</span> <span class="fu">col_time</span>(<span class="at">format =</span> <span class="st">"%T"</span>)</span>
<span id="cb16-54"><a href="#cb16-54"></a>  )</span>
<span id="cb16-55"><a href="#cb16-55"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb16-56"><a href="#cb16-56"></a>  <span class="fu">filter</span>(measure_env <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"bact"</span>, <span class="st">"bact_strep"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-57"><a href="#cb16-57"></a>  <span class="fu">filter</span>(evolution_env <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"anc"</span>, <span class="st">"bact"</span>, <span class="st">"bact_strep"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-58"><a href="#cb16-58"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-59"><a href="#cb16-59"></a>    <span class="at">measure_env_short =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-60"><a href="#cb16-60"></a>      measure_env <span class="sc">==</span> <span class="st">"bact"</span> <span class="sc">~</span> <span class="st">"Meas: B"</span>,</span>
<span id="cb16-61"><a href="#cb16-61"></a>      measure_env <span class="sc">==</span> <span class="st">"bact_strep"</span> <span class="sc">~</span> <span class="st">"Meas: BS"</span></span>
<span id="cb16-62"><a href="#cb16-62"></a>    )</span>
<span id="cb16-63"><a href="#cb16-63"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-64"><a href="#cb16-64"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-65"><a href="#cb16-65"></a>    <span class="at">home_env_short =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-66"><a href="#cb16-66"></a>      evolution_env <span class="sc">==</span> <span class="st">"anc"</span> <span class="sc">~</span> <span class="st">"Home: Anc"</span>,</span>
<span id="cb16-67"><a href="#cb16-67"></a>      evolution_env <span class="sc">==</span> <span class="st">"bact"</span> <span class="sc">~</span> <span class="st">"Home: B"</span>,</span>
<span id="cb16-68"><a href="#cb16-68"></a>      evolution_env <span class="sc">==</span> <span class="st">"bact_strep"</span> <span class="sc">~</span> <span class="st">"Home: BS"</span></span>
<span id="cb16-69"><a href="#cb16-69"></a>    )</span>
<span id="cb16-70"><a href="#cb16-70"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-71"><a href="#cb16-71"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-72"><a href="#cb16-72"></a>    <span class="at">measure_env_short =</span> <span class="fu">factor</span>(</span>
<span id="cb16-73"><a href="#cb16-73"></a>      measure_env_short,</span>
<span id="cb16-74"><a href="#cb16-74"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Meas: B"</span>, <span class="st">"Meas: BS"</span>)</span>
<span id="cb16-75"><a href="#cb16-75"></a>    ),</span>
<span id="cb16-76"><a href="#cb16-76"></a>    <span class="at">home_env_short =</span> <span class="fu">factor</span>(</span>
<span id="cb16-77"><a href="#cb16-77"></a>      home_env_short,</span>
<span id="cb16-78"><a href="#cb16-78"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Home: Anc"</span>, <span class="st">"Home: B"</span>, <span class="st">"Home: BS"</span>)</span>
<span id="cb16-79"><a href="#cb16-79"></a>    ),</span>
<span id="cb16-80"><a href="#cb16-80"></a>    <span class="at">replicate =</span> <span class="fu">factor</span>(replicate),</span>
<span id="cb16-81"><a href="#cb16-81"></a>    <span class="at">clone_id =</span> <span class="fu">factor</span>(clone_id)</span>
<span id="cb16-82"><a href="#cb16-82"></a>  )</span>
<span id="cb16-83"><a href="#cb16-83"></a><span class="in">```</span></span>
<span id="cb16-84"><a href="#cb16-84"></a></span>
<span id="cb16-85"><a href="#cb16-85"></a>Blacklist (i.e., samples that have been manually inspected and should be excluded due to strange features)</span>
<span id="cb16-86"><a href="#cb16-86"></a></span>
<span id="cb16-89"><a href="#cb16-89"></a><span class="in">```{r}</span></span>
<span id="cb16-90"><a href="#cb16-90"></a><span class="co">#| output: false</span></span>
<span id="cb16-91"><a href="#cb16-91"></a><span class="co">#| warning: false</span></span>
<span id="cb16-92"><a href="#cb16-92"></a><span class="co">#| error: false</span></span>
<span id="cb16-93"><a href="#cb16-93"></a>blacklist <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_cl, <span class="st">"blacklist.tsv"</span>))</span>
<span id="cb16-94"><a href="#cb16-94"></a><span class="in">```</span></span>
<span id="cb16-95"><a href="#cb16-95"></a></span>
<span id="cb16-96"><a href="#cb16-96"></a>Growth summary data </span>
<span id="cb16-97"><a href="#cb16-97"></a></span>
<span id="cb16-100"><a href="#cb16-100"></a><span class="in">```{r}</span></span>
<span id="cb16-101"><a href="#cb16-101"></a><span class="co">#| output: false</span></span>
<span id="cb16-102"><a href="#cb16-102"></a><span class="co">#| warning: false</span></span>
<span id="cb16-103"><a href="#cb16-103"></a><span class="co">#| error: false</span></span>
<span id="cb16-104"><a href="#cb16-104"></a>auc_grates <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_cl, <span class="st">"auc_mumax_results.tsv"</span>))</span>
<span id="cb16-105"><a href="#cb16-105"></a><span class="in">```</span></span>
<span id="cb16-106"><a href="#cb16-106"></a></span>
<span id="cb16-107"><a href="#cb16-107"></a><span class="fu"># Formatting</span></span>
<span id="cb16-108"><a href="#cb16-108"></a></span>
<span id="cb16-109"><a href="#cb16-109"></a>Anti join black list to growth curves to remove the bad growth curves and join to experiment metadata</span>
<span id="cb16-110"><a href="#cb16-110"></a></span>
<span id="cb16-113"><a href="#cb16-113"></a><span class="in">```{r}</span></span>
<span id="cb16-114"><a href="#cb16-114"></a>auc_gr_md <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(auc_grates, mddf, <span class="at">by =</span> <span class="fu">join_by</span>(plate, well)) <span class="sc">%&gt;%</span></span>
<span id="cb16-115"><a href="#cb16-115"></a>  <span class="fu">anti_join</span>(blacklist, <span class="at">by =</span> <span class="fu">join_by</span>(plate, well))</span>
<span id="cb16-116"><a href="#cb16-116"></a><span class="in">```</span></span>
<span id="cb16-117"><a href="#cb16-117"></a></span>
<span id="cb16-118"><a href="#cb16-118"></a>Subset, pivot, and calculate difference between bacteria only and bacteria + streptomycin. In the variables it is called fitness although that is kind of a misnomer. What it actually measures is the excess growth of each clone without streptomycin relative to growth of that same clone with streptomycin.</span>
<span id="cb16-119"><a href="#cb16-119"></a></span>
<span id="cb16-120"><a href="#cb16-120"></a><span class="fu"># Compare AUC</span></span>
<span id="cb16-121"><a href="#cb16-121"></a></span>
<span id="cb16-122"><a href="#cb16-122"></a><span class="fu">## Plot raw data</span></span>
<span id="cb16-123"><a href="#cb16-123"></a></span>
<span id="cb16-124"><a href="#cb16-124"></a>::: {#fig-01}</span>
<span id="cb16-127"><a href="#cb16-127"></a><span class="in">```{r}</span></span>
<span id="cb16-128"><a href="#cb16-128"></a><span class="co">#| fig.width: 7</span></span>
<span id="cb16-129"><a href="#cb16-129"></a><span class="co">#| fig.height: 4</span></span>
<span id="cb16-130"><a href="#cb16-130"></a>p01 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(auc_gr_md, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">interaction</span>(measure_env, evolution_env), <span class="at">y =</span> auc)) <span class="sc">+</span></span>
<span id="cb16-131"><a href="#cb16-131"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width=</span><span class="fl">0.35</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.35</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb16-132"><a href="#cb16-132"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Measure env:Evol hist"</span>, <span class="at">y =</span> <span class="st">"Area under growth curve (AUC, unitless)"</span>) <span class="sc">+</span></span>
<span id="cb16-133"><a href="#cb16-133"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb16-134"><a href="#cb16-134"></a></span>
<span id="cb16-135"><a href="#cb16-135"></a>p01</span>
<span id="cb16-136"><a href="#cb16-136"></a><span class="in">```</span></span>
<span id="cb16-137"><a href="#cb16-137"></a>Area under the growth curve for 32 randomly isolated clones from six replicates of each evolutionary history (background/<span class="in">`bact`</span>, streptomcyin/<span class="in">`bact_strep`</span>) grown either with or without streptomycin (<span class="in">`bact`</span> or <span class="in">`bact_strep`</span>, respectively). The horizontal axis shows the interaction of evolutionary history and measurement environment (e.g., the first column shows background evolved bacteria grown without streptomycin).</span>
<span id="cb16-138"><a href="#cb16-138"></a>:::</span>
<span id="cb16-139"><a href="#cb16-139"></a></span>
<span id="cb16-140"><a href="#cb16-140"></a>A couple features to note... The difference in AUC with or without streptomycin appears small for streptomycin evolved clones (<span class="in">`bact_strep:bact`</span> vs <span class="in">`bact_strep:bact_strep`</span>). Clones from the streptomycin evolved community do not obviously appear to have suffered some kind of cost of resistance when growing without streptomycin. However, the differences in AUC with/without streptomycin are quite large for clones isolated from the background-evolved communities (<span class="in">`bact:bact`</span> vs <span class="in">`bact:bact_strep`</span>). Thus, many streptomycin sensitive clones appear to have been isolated from background community. </span>
<span id="cb16-141"><a href="#cb16-141"></a></span>
<span id="cb16-142"><a href="#cb16-142"></a><span class="fu">## LMM fit</span></span>
<span id="cb16-143"><a href="#cb16-143"></a></span>
<span id="cb16-144"><a href="#cb16-144"></a>This models auc as a function of evolution history the measurement condition and the interaction between the two. We used replicate with clone_id nested within replicate as random effects (clones were measured more than once). We are using <span class="in">`brms`</span> here so the traditional frequentist p-value doesn't apply. Instead we think about the proportion of the posterior that has a consistent direction (e.g., over/under 0).</span>
<span id="cb16-145"><a href="#cb16-145"></a></span>
<span id="cb16-148"><a href="#cb16-148"></a><span class="in">```{r}</span></span>
<span id="cb16-149"><a href="#cb16-149"></a><span class="co">#| eval: false</span></span>
<span id="cb16-150"><a href="#cb16-150"></a><span class="fu">set.seed</span>(<span class="dv">37814</span>)</span>
<span id="cb16-151"><a href="#cb16-151"></a>brmmod <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(auc <span class="sc">~</span> evolution_env<span class="sc">*</span>measure_env <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>replicate<span class="sc">/</span>clone_id), <span class="at">data =</span> auc_gr_md)</span>
<span id="cb16-152"><a href="#cb16-152"></a><span class="in">```</span></span>
<span id="cb16-153"><a href="#cb16-153"></a></span>
<span id="cb16-156"><a href="#cb16-156"></a><span class="in">```{r}</span></span>
<span id="cb16-157"><a href="#cb16-157"></a><span class="co">#| include: false</span></span>
<span id="cb16-158"><a href="#cb16-158"></a><span class="co">#| eval: false</span></span>
<span id="cb16-159"><a href="#cb16-159"></a><span class="fu">write_rds</span>(brmmod, here<span class="sc">::</span><span class="fu">here</span>(data_cl, <span class="st">"brmmod"</span>))</span>
<span id="cb16-160"><a href="#cb16-160"></a><span class="in">```</span></span>
<span id="cb16-161"><a href="#cb16-161"></a></span>
<span id="cb16-164"><a href="#cb16-164"></a><span class="in">```{r}</span></span>
<span id="cb16-165"><a href="#cb16-165"></a><span class="co">#| echo: false</span></span>
<span id="cb16-166"><a href="#cb16-166"></a><span class="co">#| warning: false</span></span>
<span id="cb16-167"><a href="#cb16-167"></a><span class="co">#| eval: true</span></span>
<span id="cb16-168"><a href="#cb16-168"></a>brmmod <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data_cl, <span class="st">"brmmod"</span>))</span>
<span id="cb16-169"><a href="#cb16-169"></a><span class="in">```</span></span>
<span id="cb16-170"><a href="#cb16-170"></a></span>
<span id="cb16-171"><a href="#cb16-171"></a></span>
<span id="cb16-172"><a href="#cb16-172"></a><span class="fu">### Posterior predictive check </span></span>
<span id="cb16-173"><a href="#cb16-173"></a></span>
<span id="cb16-174"><a href="#cb16-174"></a>doesn't suggest anything amiss</span>
<span id="cb16-175"><a href="#cb16-175"></a></span>
<span id="cb16-176"><a href="#cb16-176"></a>::: {#fig-02}</span>
<span id="cb16-179"><a href="#cb16-179"></a><span class="in">```{r}</span></span>
<span id="cb16-180"><a href="#cb16-180"></a><span class="co">#| fig.width: 7</span></span>
<span id="cb16-181"><a href="#cb16-181"></a><span class="co">#| fig.height: 4</span></span>
<span id="cb16-182"><a href="#cb16-182"></a><span class="co">#| echo: false</span></span>
<span id="cb16-183"><a href="#cb16-183"></a><span class="co">#| warning: false</span></span>
<span id="cb16-184"><a href="#cb16-184"></a>brms<span class="sc">::</span><span class="fu">pp_check</span>(brmmod, <span class="at">type =</span> <span class="st">"dens_overlay"</span>, <span class="at">ndraws =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb16-185"><a href="#cb16-185"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"AUC"</span>)</span>
<span id="cb16-186"><a href="#cb16-186"></a><span class="in">```</span></span>
<span id="cb16-187"><a href="#cb16-187"></a>Density overlay posterior predictive check from 50 posterior draws. Vertical = density distribution of posterior (yrep) compared to observed data (y), horizontal = AUC values</span>
<span id="cb16-188"><a href="#cb16-188"></a>:::</span>
<span id="cb16-189"><a href="#cb16-189"></a></span>
<span id="cb16-190"><a href="#cb16-190"></a><span class="fu">### Convergence check</span></span>
<span id="cb16-191"><a href="#cb16-191"></a></span>
<span id="cb16-192"><a href="#cb16-192"></a>All chains appear to have converged</span>
<span id="cb16-193"><a href="#cb16-193"></a></span>
<span id="cb16-194"><a href="#cb16-194"></a>::: {#fig-03}</span>
<span id="cb16-197"><a href="#cb16-197"></a><span class="in">```{r}</span></span>
<span id="cb16-198"><a href="#cb16-198"></a><span class="co">#| fig.width: 7</span></span>
<span id="cb16-199"><a href="#cb16-199"></a><span class="co">#| fig.height: 9</span></span>
<span id="cb16-200"><a href="#cb16-200"></a><span class="co">#| echo: false</span></span>
<span id="cb16-201"><a href="#cb16-201"></a><span class="co">#| warning: false</span></span>
<span id="cb16-202"><a href="#cb16-202"></a><span class="fu">plot</span>(brmmod, <span class="at">nvariables =</span> <span class="dv">7</span>, <span class="at">plot =</span> T)</span>
<span id="cb16-203"><a href="#cb16-203"></a><span class="in">```</span></span>
<span id="cb16-204"><a href="#cb16-204"></a>Left: histogram of estimated model parameters. Right: traces of MCMC chains</span>
<span id="cb16-205"><a href="#cb16-205"></a>:::</span>
<span id="cb16-206"><a href="#cb16-206"></a></span>
<span id="cb16-207"><a href="#cb16-207"></a></span>
<span id="cb16-208"><a href="#cb16-208"></a><span class="fu">### Model parameters</span></span>
<span id="cb16-209"><a href="#cb16-209"></a></span>
<span id="cb16-212"><a href="#cb16-212"></a><span class="in">```{r}</span></span>
<span id="cb16-213"><a href="#cb16-213"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(brmmod)</span>
<span id="cb16-214"><a href="#cb16-214"></a><span class="in">```</span></span>
<span id="cb16-215"><a href="#cb16-215"></a></span>
<span id="cb16-216"><a href="#cb16-216"></a><span class="fu">### Model Contrasts</span></span>
<span id="cb16-217"><a href="#cb16-217"></a></span>
<span id="cb16-220"><a href="#cb16-220"></a><span class="in">```{r}</span></span>
<span id="cb16-221"><a href="#cb16-221"></a>modelbased<span class="sc">::</span><span class="fu">estimate_contrasts</span>(brmmod, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"evolution_env"</span>, <span class="st">"measure_env"</span>))</span>
<span id="cb16-222"><a href="#cb16-222"></a><span class="in">```</span></span>
<span id="cb16-223"><a href="#cb16-223"></a></span>
<span id="cb16-224"><a href="#cb16-224"></a>What the contrast analysis shows is what was apparent from looking at @fig-01. Basically, clones from the streptomycin evolved communities don't have significant growth differences with or without streptomycin, while clones from the background evolved communities do. This is pretty unsurprising I think.</span>
<span id="cb16-225"><a href="#cb16-225"></a></span>
<span id="cb16-226"><a href="#cb16-226"></a><span class="fu"># Compare strep sensitivity of resistant clones</span></span>
<span id="cb16-227"><a href="#cb16-227"></a></span>
<span id="cb16-228"><a href="#cb16-228"></a>In @fig-01 it is clear that there are many clones from the background evolutionary history with poor growth in the streptomycin conditions (i.e., high streptomycin sensitivity). Since each clone was phenotyped in both measurement environments we can calculate a streptomycin 'growth sensitivity' as</span>
<span id="cb16-229"><a href="#cb16-229"></a></span>
<span id="cb16-230"><a href="#cb16-230"></a>$$</span>
<span id="cb16-231"><a href="#cb16-231"></a>S_{i,j} = A_{i,j} - A_{i,j}^{STR}</span>
<span id="cb16-232"><a href="#cb16-232"></a>$$</span>
<span id="cb16-233"><a href="#cb16-233"></a>Where $S_{i,j}$ is the sensitivity of clone $i$ from microcosm $j$ to streptomycin, $A_{i,j}$ is the AUC for clone $i$ from microcosm $j$ growth *without* streptomycin and $A_{i,j}^{STR}$ is the AUC for clone $i$ from microcosm $j$ growth *with* streptomycin.</span>
<span id="cb16-234"><a href="#cb16-234"></a></span>
<span id="cb16-235"><a href="#cb16-235"></a>When $S_{i,j} \gt 0$ then the clone has more growth in the absence of streptomycin. If there is a clear growth differences between streptomycin and no-streptomycin conditions we should expect $S_{i,j} \gt 0$. Alternatively, if a clone grows equally well with or without streptomycin then we could expect $S_{i,j} \approx 0$.</span>
<span id="cb16-236"><a href="#cb16-236"></a></span>
<span id="cb16-239"><a href="#cb16-239"></a><span class="in">```{r}</span></span>
<span id="cb16-240"><a href="#cb16-240"></a>auc_gr_md_subset <span class="ot">&lt;-</span> auc_gr_md <span class="sc">%&gt;%</span></span>
<span id="cb16-241"><a href="#cb16-241"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb16-242"><a href="#cb16-242"></a>    auc,</span>
<span id="cb16-243"><a href="#cb16-243"></a>    measure_env,</span>
<span id="cb16-244"><a href="#cb16-244"></a>    evolution_env,</span>
<span id="cb16-245"><a href="#cb16-245"></a>    replicate,</span>
<span id="cb16-246"><a href="#cb16-246"></a>    clone_id</span>
<span id="cb16-247"><a href="#cb16-247"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb16-248"><a href="#cb16-248"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">"evolution_env"</span>, <span class="st">"replicate"</span>, <span class="st">"clone_id"</span>), </span>
<span id="cb16-249"><a href="#cb16-249"></a>              <span class="at">names_from =</span> measure_env, <span class="at">values_from =</span> auc) <span class="sc">%&gt;%</span> </span>
<span id="cb16-250"><a href="#cb16-250"></a>  <span class="fu">mutate</span>(<span class="at">fitness =</span> bact <span class="sc">-</span> bact_strep) <span class="sc">%&gt;%</span> </span>
<span id="cb16-251"><a href="#cb16-251"></a>  <span class="fu">mutate</span>(<span class="at">flag =</span> <span class="fu">if_else</span>(fitness <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb16-252"><a href="#cb16-252"></a><span class="in">```</span></span>
<span id="cb16-253"><a href="#cb16-253"></a></span>
<span id="cb16-254"><a href="#cb16-254"></a>Here we plot sensitivity for the two community evolutionary histories. Most clones from the streptomycin evolved community have an excess growth $\approx 0$ (@fig-01). This indicates that the overwhelming majority of isolated clones were streptomycin resistant and growth under both conditions was similar. Many clones from the background evolved community have *high* growth excesses (values &gt; 10, @fig-01). This indicates that many streptomycin sensitive clones were isolated from the background evolved community. However, there are also many clones with growth excess $\approx 0$ which indicates that innately streptomycin resistant clones were also isolated from the background evolved community.</span>
<span id="cb16-255"><a href="#cb16-255"></a></span>
<span id="cb16-256"><a href="#cb16-256"></a><span class="fu">## Plot strep sensitivity</span></span>
<span id="cb16-257"><a href="#cb16-257"></a></span>
<span id="cb16-260"><a href="#cb16-260"></a><span class="in">```{r}</span></span>
<span id="cb16-261"><a href="#cb16-261"></a>pexg <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">drop_na</span>(auc_gr_md_subset) <span class="sc">%&gt;%</span> </span>
<span id="cb16-262"><a href="#cb16-262"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> evolution_env, <span class="at">y =</span> fitness)) <span class="sc">+</span></span>
<span id="cb16-263"><a href="#cb16-263"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="at">data =</span> <span class="fu">filter</span>(auc_gr_md_subset, fitness <span class="sc">&lt;</span> <span class="dv">5</span>), <span class="at">outliers =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb16-264"><a href="#cb16-264"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width=</span><span class="fl">0.35</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.35</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb16-265"><a href="#cb16-265"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Home environment"</span>, <span class="at">y =</span> <span class="st">"STR sensitivity"</span>) <span class="sc">+</span></span>
<span id="cb16-266"><a href="#cb16-266"></a>  ggforce<span class="sc">::</span><span class="fu">facet_zoom</span>(<span class="at">y =</span> flag <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb16-267"><a href="#cb16-267"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb16-268"><a href="#cb16-268"></a><span class="in">```</span></span>
<span id="cb16-269"><a href="#cb16-269"></a></span>
<span id="cb16-270"><a href="#cb16-270"></a>::: {#fig-04}</span>
<span id="cb16-273"><a href="#cb16-273"></a><span class="in">```{r}</span></span>
<span id="cb16-274"><a href="#cb16-274"></a><span class="co">#| fig.width: 7</span></span>
<span id="cb16-275"><a href="#cb16-275"></a><span class="co">#| fig.height: 4</span></span>
<span id="cb16-276"><a href="#cb16-276"></a><span class="co">#| echo: false</span></span>
<span id="cb16-277"><a href="#cb16-277"></a><span class="co">#| warning: false</span></span>
<span id="cb16-278"><a href="#cb16-278"></a>pexg</span>
<span id="cb16-279"><a href="#cb16-279"></a><span class="in">```</span></span>
<span id="cb16-280"><a href="#cb16-280"></a>Community streptomycin sensitivity from different evolutionary histories of the pre-experiment.</span>
<span id="cb16-281"><a href="#cb16-281"></a>:::</span>
<span id="cb16-282"><a href="#cb16-282"></a></span>
<span id="cb16-283"><a href="#cb16-283"></a><span class="fu">## Sensitivity of intrinisically resistant clones</span></span>
<span id="cb16-284"><a href="#cb16-284"></a></span>
<span id="cb16-285"><a href="#cb16-285"></a>Note that above we observed clones from both evolution treatments that were intrinsically resistant to streptomycin. One question is whether the resistant clones from the background evolved community have a higher streptomycin sensitivity compared to resistant clones from the streptomycin evolved community. I would predict that clones from the background community that were already quite streptomycin resistant have a higher ($S$) sensitivity than those from the streptomycin evolved community because clones from the strep community would have had time to adapt/evolve to streptomycin. </span>
<span id="cb16-286"><a href="#cb16-286"></a></span>
<span id="cb16-287"><a href="#cb16-287"></a>We can test this prediction using a linear model for ($S$) sensitivity as a function of the evolution environment. First we filter to only include intrinsically resistant clones (operationally defined as those with sensitivity less than 5). Then we fit the model but with zero intercept so that we compare each group to 0 instead of using one group as the intercept.</span>
<span id="cb16-288"><a href="#cb16-288"></a></span>
<span id="cb16-291"><a href="#cb16-291"></a><span class="in">```{r}</span></span>
<span id="cb16-292"><a href="#cb16-292"></a>auc_gr_md_subset_filt <span class="ot">&lt;-</span> auc_gr_md_subset <span class="sc">%&gt;%</span> </span>
<span id="cb16-293"><a href="#cb16-293"></a>  <span class="fu">filter</span>(flag <span class="sc">==</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb16-294"><a href="#cb16-294"></a>  <span class="fu">mutate</span>(<span class="at">evolution_env =</span> <span class="fu">factor</span>(evolution_env, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"bact"</span>, <span class="st">"bact_strep"</span>)))</span>
<span id="cb16-295"><a href="#cb16-295"></a><span class="in">```</span></span>
<span id="cb16-296"><a href="#cb16-296"></a></span>
<span id="cb16-297"><a href="#cb16-297"></a><span class="fu">### LMM Fit</span></span>
<span id="cb16-298"><a href="#cb16-298"></a></span>
<span id="cb16-301"><a href="#cb16-301"></a><span class="in">```{r}</span></span>
<span id="cb16-302"><a href="#cb16-302"></a><span class="co">#| eval: false</span></span>
<span id="cb16-303"><a href="#cb16-303"></a><span class="fu">set.seed</span>(<span class="dv">8435</span>)</span>
<span id="cb16-304"><a href="#cb16-304"></a>brmmod0 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(fitness <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> evolution_env <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>replicate), <span class="at">data =</span> auc_gr_md_subset_filt)</span>
<span id="cb16-305"><a href="#cb16-305"></a><span class="in">```</span></span>
<span id="cb16-306"><a href="#cb16-306"></a></span>
<span id="cb16-309"><a href="#cb16-309"></a><span class="in">```{r}</span></span>
<span id="cb16-310"><a href="#cb16-310"></a><span class="co">#| eval: false</span></span>
<span id="cb16-311"><a href="#cb16-311"></a><span class="co">#| include: false</span></span>
<span id="cb16-312"><a href="#cb16-312"></a><span class="fu">write_rds</span>(brmmod0, here<span class="sc">::</span><span class="fu">here</span>(data_cl, <span class="st">"brmmod0"</span>))</span>
<span id="cb16-313"><a href="#cb16-313"></a><span class="in">```</span></span>
<span id="cb16-314"><a href="#cb16-314"></a></span>
<span id="cb16-317"><a href="#cb16-317"></a><span class="in">```{r}</span></span>
<span id="cb16-318"><a href="#cb16-318"></a><span class="co">#| echo: false</span></span>
<span id="cb16-319"><a href="#cb16-319"></a><span class="co">#| warning: false</span></span>
<span id="cb16-320"><a href="#cb16-320"></a><span class="co">#| eval: true</span></span>
<span id="cb16-321"><a href="#cb16-321"></a>brmmod0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data_cl, <span class="st">"brmmod0"</span>))</span>
<span id="cb16-322"><a href="#cb16-322"></a><span class="in">```</span></span>
<span id="cb16-323"><a href="#cb16-323"></a></span>
<span id="cb16-324"><a href="#cb16-324"></a><span class="fu">### Posterior predictive check </span></span>
<span id="cb16-325"><a href="#cb16-325"></a></span>
<span id="cb16-326"><a href="#cb16-326"></a>doesn't suggest anything amiss</span>
<span id="cb16-327"><a href="#cb16-327"></a></span>
<span id="cb16-328"><a href="#cb16-328"></a>::: {#fig-05}</span>
<span id="cb16-331"><a href="#cb16-331"></a><span class="in">```{r}</span></span>
<span id="cb16-332"><a href="#cb16-332"></a><span class="co">#| fig.width: 7</span></span>
<span id="cb16-333"><a href="#cb16-333"></a><span class="co">#| fig.height: 4</span></span>
<span id="cb16-334"><a href="#cb16-334"></a><span class="co">#| echo: false</span></span>
<span id="cb16-335"><a href="#cb16-335"></a><span class="co">#| warning: false</span></span>
<span id="cb16-336"><a href="#cb16-336"></a>brms<span class="sc">::</span><span class="fu">pp_check</span>(brmmod0, <span class="at">type =</span> <span class="st">"dens_overlay"</span>, <span class="at">ndraws =</span> <span class="dv">50</span>)</span>
<span id="cb16-337"><a href="#cb16-337"></a><span class="in">```</span></span>
<span id="cb16-338"><a href="#cb16-338"></a>Density overlay posterior predictive check from 50 posterior draws. Vertical = density distribution of posterior (yrep) compared to observed data (y), horizontal = AUC values</span>
<span id="cb16-339"><a href="#cb16-339"></a>:::</span>
<span id="cb16-340"><a href="#cb16-340"></a></span>
<span id="cb16-341"><a href="#cb16-341"></a><span class="fu">### Convergence check</span></span>
<span id="cb16-342"><a href="#cb16-342"></a></span>
<span id="cb16-343"><a href="#cb16-343"></a>All chains appear to have converged</span>
<span id="cb16-344"><a href="#cb16-344"></a></span>
<span id="cb16-345"><a href="#cb16-345"></a>::: {#fig-06}</span>
<span id="cb16-348"><a href="#cb16-348"></a><span class="in">```{r}</span></span>
<span id="cb16-349"><a href="#cb16-349"></a><span class="co">#| fig.width: 7</span></span>
<span id="cb16-350"><a href="#cb16-350"></a><span class="co">#| fig.height: 7</span></span>
<span id="cb16-351"><a href="#cb16-351"></a><span class="co">#| echo: false</span></span>
<span id="cb16-352"><a href="#cb16-352"></a><span class="co">#| warning: false</span></span>
<span id="cb16-353"><a href="#cb16-353"></a><span class="fu">plot</span>(brmmod0, <span class="at">nvariables =</span> <span class="dv">7</span>, <span class="at">plot =</span> T)</span>
<span id="cb16-354"><a href="#cb16-354"></a><span class="in">```</span></span>
<span id="cb16-355"><a href="#cb16-355"></a>Left: histogram of estimated model parameters. Right: traces of MCMC chains</span>
<span id="cb16-356"><a href="#cb16-356"></a>:::</span>
<span id="cb16-357"><a href="#cb16-357"></a></span>
<span id="cb16-358"><a href="#cb16-358"></a><span class="fu">### Model parameters</span></span>
<span id="cb16-359"><a href="#cb16-359"></a></span>
<span id="cb16-362"><a href="#cb16-362"></a><span class="in">```{r}</span></span>
<span id="cb16-363"><a href="#cb16-363"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(brmmod0)</span>
<span id="cb16-364"><a href="#cb16-364"></a><span class="in">```</span></span>
<span id="cb16-365"><a href="#cb16-365"></a></span>
<span id="cb16-366"><a href="#cb16-366"></a>So the results from the zero intercept model show that resistant clones from the background evolutionary history have a median Streptomycin sensitivity of 0.43 with a probability of direction (pd) of 95.5% while clones from the streptomycin evolutionary history communities have a mean sensitivity of -0.06 with a pd of about 62%. Sensitivity from the streptomycin history is statistically indistinguishable from zero, which makes sense and is consistent with what we saw in @fig-04. </span>
<span id="cb16-367"><a href="#cb16-367"></a></span>
<span id="cb16-368"><a href="#cb16-368"></a>However, it seems that resistant clones from the background community have a small but significantly higher sensitivity to streptomycin. Overall I don't think this is too surprising that naturally resistant clones isolated from the evolution conditions with streptomycin are less sensitive to stretomycin than those that were evolving without it. </span>
<span id="cb16-369"><a href="#cb16-369"></a></span>
<span id="cb16-370"><a href="#cb16-370"></a></span>
<span id="cb16-371"><a href="#cb16-371"></a><span class="fu"># Final combined plot of AUC and S</span></span>
<span id="cb16-372"><a href="#cb16-372"></a></span>
<span id="cb16-373"><a href="#cb16-373"></a>::: {#fig-07}</span>
<span id="cb16-376"><a href="#cb16-376"></a><span class="in">```{r}</span></span>
<span id="cb16-377"><a href="#cb16-377"></a><span class="co">#| fig.width: 7</span></span>
<span id="cb16-378"><a href="#cb16-378"></a><span class="co">#| fig.height: 7</span></span>
<span id="cb16-379"><a href="#cb16-379"></a><span class="co">#| echo: false</span></span>
<span id="cb16-380"><a href="#cb16-380"></a><span class="co">#| warning: false</span></span>
<span id="cb16-381"><a href="#cb16-381"></a>pf <span class="ot">&lt;-</span> p01 <span class="sc">/</span> pexg <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb16-382"><a href="#cb16-382"></a>pf</span>
<span id="cb16-383"><a href="#cb16-383"></a><span class="in">```</span></span>
<span id="cb16-384"><a href="#cb16-384"></a>A) Area under the growth curve for 32 randomly isolated clones from six replicates of each evolutionary history (background/<span class="in">`bact`</span>, streptomcyin/<span class="in">`bact_strep`</span>) grown either with or without streptomycin (<span class="in">`bact`</span> or <span class="in">`bact_strep`</span>, respectively). The horizontal axis shows the interaction of measurement environment with evolutionary history (e.g., the first column shows the no-streptomycin measurement for background evolved bacteria). Community streptomycin sensitivity from different evolutionary histories of the pre-experiment. For each clone phenotyped with or without streptomcyin the streptomycin sensitivity is defined as $S_{i,j} = A_{i,j} - A_{i,j}^{STR}$ where $S_{i,j}$ is the sensitivity of clone $i$ from microcosm $j$ to streptomycin, $A_{i,j}$ is the AUC for clone $i$ from microcosm $j$ growth *without* streptomycin and $A_{i,j}^{STR}$ is the AUC for clone $i$ from microcosm $j$ growth *with* streptomycin.</span>
<span id="cb16-385"><a href="#cb16-385"></a>:::</span>
<span id="cb16-386"><a href="#cb16-386"></a></span>
<span id="cb16-387"><a href="#cb16-387"></a><span class="fu">## Export</span></span>
<span id="cb16-390"><a href="#cb16-390"></a><span class="in">```{r}</span></span>
<span id="cb16-391"><a href="#cb16-391"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb16-392"><a href="#cb16-392"></a>  here<span class="sc">::</span><span class="fu">here</span>(figs, <span class="st">"monoculture_clone_phenotyping_auc.svg"</span>),</span>
<span id="cb16-393"><a href="#cb16-393"></a>  pf,</span>
<span id="cb16-394"><a href="#cb16-394"></a>  <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb16-395"><a href="#cb16-395"></a>  <span class="at">height =</span> <span class="dv">7</span>,</span>
<span id="cb16-396"><a href="#cb16-396"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb16-397"><a href="#cb16-397"></a>  <span class="at">device =</span> <span class="st">"svg"</span></span>
<span id="cb16-398"><a href="#cb16-398"></a>)</span>
<span id="cb16-399"><a href="#cb16-399"></a></span>
<span id="cb16-400"><a href="#cb16-400"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb16-401"><a href="#cb16-401"></a>  here<span class="sc">::</span><span class="fu">here</span>(figs, <span class="st">"monoculture_clone_phenotyping_auc.png"</span>),</span>
<span id="cb16-402"><a href="#cb16-402"></a>  pf,</span>
<span id="cb16-403"><a href="#cb16-403"></a>  <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb16-404"><a href="#cb16-404"></a>  <span class="at">height =</span> <span class="dv">7</span>,</span>
<span id="cb16-405"><a href="#cb16-405"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb16-406"><a href="#cb16-406"></a>  <span class="at">device =</span> <span class="st">"png"</span></span>
<span id="cb16-407"><a href="#cb16-407"></a>)</span>
<span id="cb16-408"><a href="#cb16-408"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>